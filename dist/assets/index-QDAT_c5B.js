import{r as L,c as u,o as d,a as F,b as e,d as $e,e as ae,f as O,w as ye,g as V,v as Z,T as we,h as J,i as E,n as he,j as D,k as S,t as m,F as G,l as z,m as ke,p as de,q as Q,u as I,s as xe,x as Le,y as Oe,z as Ee}from"./vue-Bjm4aiDv.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))g(c);new MutationObserver(c=>{for(const o of c)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&g(i)}).observe(document,{childList:!0,subtree:!0});function n(c){const o={};return c.integrity&&(o.integrity=c.integrity),c.referrerPolicy&&(o.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?o.credentials="include":c.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function g(c){if(c.ep)return;c.ep=!0;const o=n(c);fetch(c.href,o)}})();let C=null,H=null;const pe=L(!1),te=L(""),oe=L({count:0}),Ce="food-database-cache",Ve=1,fe="database-data";function Se(){async function t(){if(H)return H;try{return H=await(await new Promise((p,y)=>{if(window.sqlite3InitModule){p(window.sqlite3InitModule);return}const w=document.createElement("script");w.type="module",w.textContent=`
                    import sqlite3InitModule from '/sqlite-wasm/sqlite3.mjs';
                    window.sqlite3InitModule = sqlite3InitModule;
                    window.dispatchEvent(new Event('sqlite3-loaded'));
                `,window.addEventListener("sqlite3-loaded",()=>{p(window.sqlite3InitModule)},{once:!0}),w.onerror=y,document.head.appendChild(w)}))({print:console.log,printErr:console.error,locateFile:p=>`/sqlite-wasm/${p}`}),console.log("SQLite wasm initialized:",H.version.libVersion),H}catch(l){throw console.error("Failed to initialize SQLite:",l),l}}async function s(){return new Promise((l,p)=>{const y=indexedDB.open(Ce,Ve);y.onerror=()=>p(y.error),y.onsuccess=()=>l(y.result),y.onupgradeneeded=w=>{const _=w.target.result;_.objectStoreNames.contains("databases")||_.createObjectStore("databases")}})}async function n(){try{const l=await s();return new Promise((p,y)=>{const f=l.transaction(["databases"],"readonly").objectStore("databases").get(fe);f.onerror=()=>y(f.error),f.onsuccess=()=>p(f.result)})}catch(l){return console.error("Error getting cached database:",l),null}}async function g(l){try{const p=await s();return new Promise((y,w)=>{const B=p.transaction(["databases"],"readwrite").objectStore("databases").put(l,fe);B.onerror=()=>w(B.error),B.onsuccess=()=>y(!0)})}catch(p){return console.error("Error caching database:",p),!1}}async function c(){try{const l=await s();return new Promise((p,y)=>{const f=l.transaction(["databases"],"readwrite").objectStore("databases").delete(fe);f.onerror=()=>y(f.error),f.onsuccess=()=>p(!0)})}catch(l){return console.error("Error clearing cache:",l),!1}}async function o(){pe.value=!0,te.value="Initializing database...";try{await t(),te.value="Checking cache...";const l=await n();let p;if(l)console.log("Loading database from cache"),te.value="Loading from cache...",p=new Uint8Array(l);else{console.log("Downloading database from server"),te.value="Downloading database...";const f=await fetch("/data.sqlite");if(!f.ok)throw new Error(`Failed to fetch database: ${f.statusText}`);const B=await f.arrayBuffer();p=new Uint8Array(B),te.value="Caching database...",await g(B),console.log("Database cached successfully")}te.value="Loading database...",C&&(C.close(),C=null),C=new H.oo1.DB(":memory:");const y=H.wasm.alloc(p.length),w=1024*1024;for(let f=0;f<p.length;f+=w){const B=Math.min(f+w,p.length),k=p.slice(f,B);H.wasm.heap8().set(k,y+f)}const _=H.capi.sqlite3_deserialize(C.pointer,"main",y,p.length,p.length,H.capi.SQLITE_DESERIALIZE_FREEONCLOSE|H.capi.SQLITE_DESERIALIZE_RESIZEABLE);if(_!==0)throw H.wasm.dealloc(y),new Error(`Failed to deserialize database: ${H.capi.sqlite3_errstr(_)}`);return console.log("Database loaded successfully"),await i(),!0}catch(l){throw console.error("Error loading database:",l),l}finally{pe.value=!1,te.value=""}}async function i(){if(!C){oe.value={count:0};return}try{const l=C.exec({sql:"SELECT COUNT(*) as count FROM food",returnValue:"resultRows",rowMode:"object"});l&&l.length>0&&(oe.value={count:l[0].count})}catch(l){console.error("Error updating stats:",l),oe.value={count:0}}}async function r(l,p=1,y=21,w=null){if(!C)return{products:[],totalCount:0,totalPages:0};try{const _=(p-1)*y,f={};let B="FROM food f";const k=[];if(l.search&&l.search.trim()&&(B=`
                    FROM food_fts fts
                    JOIN food f ON f.id = fts.rowid
                `,k.push("food_fts MATCH :search"),f[":search"]=l.search.trim()+"*"),l.brands&&l.brands.length>0){const j=l.brands.map(x=>typeof x=="object"?x.id:x).map((x,W)=>{const N=`:brand${W}`;return f[N]=x,N}).join(",");k.push(`f.id IN (
                    SELECT food_id FROM brand_food
                    WHERE brand_id IN (${j})
                )`)}if(l.categories&&l.categories.length>0){const j=l.categories.map(x=>typeof x=="object"?x.id:x).map((x,W)=>{const N=`:category${W}`;return f[N]=x,N}).join(",");k.push(`f.id IN (
                    SELECT food_id FROM category_food
                    WHERE category_id IN (${j})
                )`)}if(l.stores&&l.stores.length>0){const j=l.stores.map(x=>typeof x=="object"?x.id:x).map((x,W)=>{const N=`:store${W}`;return f[N]=x,N}).join(",");k.push(`f.id IN (
                    SELECT food_id FROM store_food
                    WHERE store_id IN (${j})
                )`)}l.proteinMin!==void 0&&l.proteinMin!==null&&l.proteinMin!==""&&(k.push("f.protein >= :proteinMin"),f[":proteinMin"]=Number(l.proteinMin)),l.proteinMax!==void 0&&l.proteinMax!==null&&l.proteinMax!==""&&(k.push("f.protein <= :proteinMax"),f[":proteinMax"]=Number(l.proteinMax)),l.fatMin!==void 0&&l.fatMin!==null&&l.fatMin!==""&&(k.push("f.fat >= :fatMin"),f[":fatMin"]=Number(l.fatMin)),l.fatMax!==void 0&&l.fatMax!==null&&l.fatMax!==""&&(k.push("f.fat <= :fatMax"),f[":fatMax"]=Number(l.fatMax)),l.carbsMin!==void 0&&l.carbsMin!==null&&l.carbsMin!==""&&(k.push("f.carbs >= :carbsMin"),f[":carbsMin"]=Number(l.carbsMin)),l.carbsMax!==void 0&&l.carbsMax!==null&&l.carbsMax!==""&&(k.push("f.carbs <= :carbsMax"),f[":carbsMax"]=Number(l.carbsMax)),l.energyMin!==void 0&&l.energyMin!==null&&l.energyMin!==""&&(k.push("f.energy >= :energyMin"),f[":energyMin"]=Number(l.energyMin)),l.energyMax!==void 0&&l.energyMax!==null&&l.energyMax!==""&&(k.push("f.energy <= :energyMax"),f[":energyMax"]=Number(l.energyMax));const T=k.length>0?`WHERE ${k.join(" AND ")}`:"",U=`
                SELECT COUNT(*) as count
                ${B}
                ${T}
            `,A=C.exec({sql:U,bind:f,returnValue:"resultRows",rowMode:"object"}),Y=A&&A.length>0?A[0].count:0;let ee;w&&Array.isArray(w)&&w.length>0?ee=`ORDER BY ${w.map(j=>{const x=j.direction.toUpperCase();return`f.${j.field} ${x} NULLS LAST`}).join(", ")}`:l.search&&l.search.trim()?ee="ORDER BY fts.rank":ee="ORDER BY f.name";const X=`
                SELECT
                    f.id,
                    f.name,
                    f.url,
                    f.image_url,
                    f.brands,
                    f.categories,
                    f.stores,
                    f.fat,
                    f.protein,
                    f.carbs,
                    f.energy,
                    f.protein_fat_index
                ${B}
                ${T}
                ${ee}
                LIMIT :limit OFFSET :offset
            `;return{products:C.exec({sql:X,bind:{...f,":limit":y,":offset":_},returnValue:"resultRows",rowMode:"object"})||[],totalCount:Y,totalPages:Math.ceil(Y/y)}}catch(_){return console.error("Error querying products:",_),{products:[],totalCount:0,totalPages:0}}}async function v(l=""){if(!C)return[];try{let p,y={};l&&l.trim()?(p=`
                    SELECT rowid as id, brand
                    FROM brands_fts
                    WHERE brand MATCH :search
                    ORDER BY rank
                    LIMIT 100
                `,y[":search"]=l.trim()+"*"):p=`
                    SELECT id, brand
                    FROM brands
                    ORDER BY brand ASC
                    LIMIT 100
                `;const w=C.exec({sql:p,bind:y,returnValue:"resultRows",rowMode:"object"});return w?w.filter(_=>_.brand):[]}catch(p){return console.error("Error getting unique brands:",p),[]}}async function P(l=""){if(!C)return[];try{let p,y={};l&&l.trim()?(p=`
                    SELECT rowid as id, category
                    FROM categories_fts
                    WHERE category MATCH :search
                    ORDER BY rank
                    LIMIT 100
                `,y[":search"]=l.trim()+"*"):p=`
                    SELECT id, category
                    FROM categories
                    ORDER BY category ASC
                    LIMIT 100
                `;const w=C.exec({sql:p,bind:y,returnValue:"resultRows",rowMode:"object"});return w?w.filter(_=>_.category):[]}catch(p){return console.error("Error getting unique categories:",p),[]}}async function q(l=""){if(!C)return[];try{let p,y={};l&&l.trim()?(p=`
                    SELECT rowid as id, store
                    FROM stores_fts
                    WHERE store MATCH :search
                    ORDER BY rank
                    LIMIT 100
                `,y[":search"]=l.trim()+"*"):p=`
                    SELECT id, store
                    FROM stores
                    ORDER BY store ASC
                `;const w=C.exec({sql:p,bind:y,returnValue:"resultRows",rowMode:"object"});return w?w.filter(_=>_.store):[]}catch(p){return console.error("Error getting unique stores:",p),[]}}async function se(){return C!==null&&oe.value.count>0}async function K(){return C&&(C.close(),C=null,oe.value={count:0}),await c(),console.log("Database and cache cleared"),!0}return{loading:pe,loadingMessage:te,dbStats:oe,loadData:o,clearDatabase:K,clearDatabaseCache:c,updateStats:i,queryProducts:r,getUniqueBrands:v,getUniqueCategories:P,getUniqueStores:q,hasData:se}}function ge(t){return t===0?!1:Array.isArray(t)&&t.length===0?!0:!t}function Be(t){return(...s)=>!t(...s)}function Te(t,s){return t===void 0&&(t="undefined"),t===null&&(t="null"),t===!1&&(t="false"),t.toString().toLowerCase().indexOf(s.trim())!==-1}function De(t){return t.filter(s=>!s.$isLabel)}function me(t,s){return n=>n.reduce((g,c)=>c[t]&&c[t].length?(g.push({$groupLabel:c[s],$isLabel:!0}),g.concat(c[t])):g,[])}const _e=(...t)=>s=>t.reduce((n,g)=>g(n),s);var Fe={data(){return{search:"",isOpen:!1,preferredOpenDirection:"below",optimizedHeight:this.maxHeight}},props:{internalSearch:{type:Boolean,default:!0},options:{type:Array,required:!0},multiple:{type:Boolean,default:!1},trackBy:{type:String},label:{type:String},searchable:{type:Boolean,default:!0},clearOnSelect:{type:Boolean,default:!0},hideSelected:{type:Boolean,default:!1},placeholder:{type:String,default:"Select option"},allowEmpty:{type:Boolean,default:!0},resetAfter:{type:Boolean,default:!1},closeOnSelect:{type:Boolean,default:!0},customLabel:{type:Function,default(t,s){return ge(t)?"":s?t[s]:t}},taggable:{type:Boolean,default:!1},tagPlaceholder:{type:String,default:"Press enter to create a tag"},tagPosition:{type:String,default:"top"},max:{type:[Number,Boolean],default:!1},id:{default:null},optionsLimit:{type:Number,default:1e3},groupValues:{type:String},groupLabel:{type:String},groupSelect:{type:Boolean,default:!1},blockKeys:{type:Array,default(){return[]}},preserveSearch:{type:Boolean,default:!1},preselectFirst:{type:Boolean,default:!1},preventAutofocus:{type:Boolean,default:!1},filteringSortFunc:{type:Function,default:null}},mounted(){!this.multiple&&this.max&&console.warn("[Vue-Multiselect warn]: Max prop should not be used when prop Multiple equals false."),this.preselectFirst&&!this.internalValue.length&&this.options.length&&this.select(this.filteredOptions[0])},computed:{internalValue(){return this.modelValue||this.modelValue===0?Array.isArray(this.modelValue)?this.modelValue:[this.modelValue]:[]},filteredOptions(){const t=this.search||"",s=t.toLowerCase().trim();let n=this.options.concat();return this.internalSearch?n=this.groupValues?this.filterAndFlat(n,s,this.label):this.filterOptions(n,s,this.label,this.customLabel):n=this.groupValues?me(this.groupValues,this.groupLabel)(n):n,n=this.hideSelected?n.filter(Be(this.isSelected)):n,this.taggable&&s.length&&!this.isExistingOption(s)&&(this.tagPosition==="bottom"?n.push({isTag:!0,label:t}):n.unshift({isTag:!0,label:t})),n.slice(0,this.optionsLimit)},valueKeys(){return this.trackBy?this.internalValue.map(t=>t[this.trackBy]):this.internalValue},optionKeys(){return(this.groupValues?this.flatAndStrip(this.options):this.options).map(s=>this.customLabel(s,this.label).toString().toLowerCase())},currentOptionLabel(){return this.multiple?this.searchable?"":this.placeholder:this.internalValue.length?this.getOptionLabel(this.internalValue[0]):this.searchable?"":this.placeholder}},watch:{internalValue:{handler(){this.resetAfter&&this.internalValue.length&&(this.search="",this.$emit("update:modelValue",this.multiple?[]:null))},deep:!0},search(){this.$emit("search-change",this.search)}},emits:["open","search-change","close","select","update:modelValue","remove","tag"],methods:{getValue(){return this.multiple?this.internalValue:this.internalValue.length===0?null:this.internalValue[0]},filterAndFlat(t,s,n){return _e(this.filterGroups(s,n,this.groupValues,this.groupLabel,this.customLabel),me(this.groupValues,this.groupLabel))(t)},flatAndStrip(t){return _e(me(this.groupValues,this.groupLabel),De)(t)},updateSearch(t){this.search=t},isExistingOption(t){return this.options?this.optionKeys.indexOf(t)>-1:!1},isSelected(t){const s=this.trackBy?t[this.trackBy]:t;return this.valueKeys.indexOf(s)>-1},isOptionDisabled(t){return!!t.$isDisabled},getOptionLabel(t){if(ge(t))return"";if(t.isTag)return t.label;if(t.$isLabel)return t.$groupLabel;const s=this.customLabel(t,this.label);return ge(s)?"":s},select(t,s){if(t.$isLabel&&this.groupSelect){this.selectGroup(t);return}if(!(this.blockKeys.indexOf(s)!==-1||this.disabled||t.$isDisabled||t.$isLabel)&&!(this.max&&this.multiple&&this.internalValue.length===this.max)&&!(s==="Tab"&&!this.pointerDirty)){if(t.isTag)this.$emit("tag",t.label,this.id),this.search="",this.closeOnSelect&&!this.multiple&&this.deactivate();else{if(this.isSelected(t)){s!=="Tab"&&this.removeElement(t);return}this.multiple?this.$emit("update:modelValue",this.internalValue.concat([t])):this.$emit("update:modelValue",t),this.$emit("select",t,this.id),this.clearOnSelect&&(this.search="")}this.closeOnSelect&&this.deactivate()}},selectGroup(t){const s=this.options.find(n=>n[this.groupLabel]===t.$groupLabel);if(s){if(this.wholeGroupSelected(s)){this.$emit("remove",s[this.groupValues],this.id);const n=this.trackBy?s[this.groupValues].map(c=>c[this.trackBy]):s[this.groupValues],g=this.internalValue.filter(c=>n.indexOf(this.trackBy?c[this.trackBy]:c)===-1);this.$emit("update:modelValue",g)}else{const n=s[this.groupValues].filter(g=>!(this.isOptionDisabled(g)||this.isSelected(g)));this.max&&n.splice(this.max-this.internalValue.length),this.$emit("select",n,this.id),this.$emit("update:modelValue",this.internalValue.concat(n))}this.closeOnSelect&&this.deactivate()}},wholeGroupSelected(t){return t[this.groupValues].every(s=>this.isSelected(s)||this.isOptionDisabled(s))},wholeGroupDisabled(t){return t[this.groupValues].every(this.isOptionDisabled)},removeElement(t,s=!0){if(this.disabled||t.$isDisabled)return;if(!this.allowEmpty&&this.internalValue.length<=1){this.deactivate();return}const n=typeof t=="object"?this.valueKeys.indexOf(t[this.trackBy]):this.valueKeys.indexOf(t);if(this.multiple){const g=this.internalValue.slice(0,n).concat(this.internalValue.slice(n+1));this.$emit("update:modelValue",g)}else this.$emit("update:modelValue",null);this.$emit("remove",t,this.id),this.closeOnSelect&&s&&this.deactivate()},removeLastElement(){this.blockKeys.indexOf("Delete")===-1&&this.search.length===0&&Array.isArray(this.internalValue)&&this.internalValue.length&&this.removeElement(this.internalValue[this.internalValue.length-1],!1)},activate(){this.isOpen||this.disabled||(this.adjustPosition(),this.groupValues&&this.pointer===0&&this.filteredOptions.length&&(this.pointer=1),this.isOpen=!0,this.searchable?(this.preserveSearch||(this.search=""),this.preventAutofocus||this.$nextTick(()=>this.$refs.search&&this.$refs.search.focus())):this.preventAutofocus||typeof this.$el<"u"&&this.$el.focus(),this.$emit("open",this.id))},deactivate(){this.isOpen&&(this.isOpen=!1,this.searchable?this.$refs.search!==null&&typeof this.$refs.search<"u"&&this.$refs.search.blur():typeof this.$el<"u"&&this.$el.blur(),this.preserveSearch||(this.search=""),this.$emit("close",this.getValue(),this.id))},toggle(){this.isOpen?this.deactivate():this.activate()},adjustPosition(){if(typeof window>"u")return;const t=this.$el.getBoundingClientRect().top,s=window.innerHeight-this.$el.getBoundingClientRect().bottom;s>this.maxHeight||s>t||this.openDirection==="below"||this.openDirection==="bottom"?(this.preferredOpenDirection="below",this.optimizedHeight=Math.min(s-40,this.maxHeight)):(this.preferredOpenDirection="above",this.optimizedHeight=Math.min(t-40,this.maxHeight))},filterOptions(t,s,n,g){return s?t.filter(c=>Te(g(c,n),s)).sort((c,o)=>typeof this.filteringSortFunc=="function"?this.filteringSortFunc(c,o):g(c,n).length-g(o,n).length):t},filterGroups(t,s,n,g,c){return o=>o.map(i=>{if(!i[n])return console.warn("Options passed to vue-multiselect do not contain groups, despite the config."),[];const r=this.filterOptions(i[n],t,s,c);return r.length?{[g]:i[g],[n]:r}:[]})}}},Pe={data(){return{pointer:0,pointerDirty:!1}},props:{showPointer:{type:Boolean,default:!0},optionHeight:{type:Number,default:40}},computed:{pointerPosition(){return this.pointer*this.optionHeight},visibleElements(){return this.optimizedHeight/this.optionHeight}},watch:{filteredOptions(){this.pointerAdjust()},isOpen(){this.pointerDirty=!1},pointer(){this.$refs.search&&this.$refs.search.setAttribute("aria-activedescendant",this.id+"-"+this.pointer.toString())}},methods:{optionHighlight(t,s){return{"multiselect__option--highlight":t===this.pointer&&this.showPointer,"multiselect__option--selected":this.isSelected(s)}},groupHighlight(t,s){if(!this.groupSelect)return["multiselect__option--disabled",{"multiselect__option--group":s.$isLabel}];const n=this.options.find(g=>g[this.groupLabel]===s.$groupLabel);return n&&!this.wholeGroupDisabled(n)?["multiselect__option--group",{"multiselect__option--highlight":t===this.pointer&&this.showPointer},{"multiselect__option--group-selected":this.wholeGroupSelected(n)}]:"multiselect__option--disabled"},addPointerElement({key:t}="Enter"){this.filteredOptions.length>0&&this.select(this.filteredOptions[this.pointer],t),this.pointerReset()},pointerForward(){var t;this.pointer<this.filteredOptions.length-1&&(this.pointer++,((t=this.$refs.list)==null?void 0:t.scrollTop)<=this.pointerPosition-(this.visibleElements-1)*this.optionHeight&&(this.$refs.list.scrollTop=this.pointerPosition-(this.visibleElements-1)*this.optionHeight),this.filteredOptions[this.pointer]&&this.filteredOptions[this.pointer].$isLabel&&!this.groupSelect&&this.pointerForward()),this.pointerDirty=!0},pointerBackward(){var t;this.pointer>0?(this.pointer--,((t=this.$refs.list)==null?void 0:t.scrollTop)>=this.pointerPosition&&(this.$refs.list.scrollTop=this.pointerPosition),this.filteredOptions[this.pointer]&&this.filteredOptions[this.pointer].$isLabel&&!this.groupSelect&&this.pointerBackward()):this.filteredOptions[this.pointer]&&this.filteredOptions[0].$isLabel&&!this.groupSelect&&this.pointerForward(),this.pointerDirty=!0},pointerReset(){this.closeOnSelect&&(this.pointer=0,this.$refs.list&&(this.$refs.list.scrollTop=0))},pointerAdjust(){this.pointer>=this.filteredOptions.length-1&&(this.pointer=this.filteredOptions.length?this.filteredOptions.length-1:0),this.filteredOptions.length>0&&this.filteredOptions[this.pointer].$isLabel&&!this.groupSelect&&this.pointerForward()},pointerSet(t){this.pointer=t,this.pointerDirty=!0}}},ue={name:"vue-multiselect",mixins:[Fe,Pe],compatConfig:{MODE:3,ATTR_ENUMERATED_COERCION:!1},props:{name:{type:String,default:""},modelValue:{type:null,default(){return[]}},selectLabel:{type:String,default:"Press enter to select"},selectGroupLabel:{type:String,default:"Press enter to select group"},selectedLabel:{type:String,default:"Selected"},deselectLabel:{type:String,default:"Press enter to remove"},deselectGroupLabel:{type:String,default:"Press enter to deselect group"},showLabels:{type:Boolean,default:!0},limit:{type:Number,default:99999},maxHeight:{type:Number,default:300},limitText:{type:Function,default:t=>`and ${t} more`},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},spellcheck:{type:Boolean,default:!1},openDirection:{type:String,default:""},showNoOptions:{type:Boolean,default:!0},showNoResults:{type:Boolean,default:!0},tabindex:{type:Number,default:0},required:{type:Boolean,default:!1},useTeleport:{type:Boolean,default:!1},contentWrapperClass:{type:[String,Array,Object],default:""}},data(){return{dropdownStyles:{},ready:!1}},computed:{hasOptionGroup(){return this.groupValues&&this.groupLabel&&this.groupSelect},isSingleLabelVisible(){return(this.singleValue||this.singleValue===0)&&(!this.isOpen||!this.searchable)&&!this.visibleValues.length},isPlaceholderVisible(){return!this.internalValue.length&&(!this.searchable||!this.isOpen)},visibleValues(){return this.multiple?this.internalValue.slice(0,this.limit):[]},singleValue(){return this.internalValue[0]},deselectLabelText(){return this.showLabels?this.deselectLabel:""},deselectGroupLabelText(){return this.showLabels?this.deselectGroupLabel:""},selectLabelText(){return this.showLabels?this.selectLabel:""},selectGroupLabelText(){return this.showLabels?this.selectGroupLabel:""},selectedLabelText(){return this.showLabels?this.selectedLabel:""},inputStyle(){return this.searchable||this.multiple&&this.modelValue&&this.modelValue.length?this.isOpen?{width:"100%"}:{width:"0",position:"absolute",padding:"0"}:""},contentStyle(){return this.options.length?{display:"inline-block"}:{display:"block"}},isAbove(){return this.openDirection==="above"||this.openDirection==="top"?!0:this.openDirection==="below"||this.openDirection==="bottom"?!1:this.preferredOpenDirection==="above"},showSearchInput(){return this.searchable&&(this.hasSingleSelectedSlot&&(this.visibleSingleValue||this.visibleSingleValue===0)?this.isOpen:!0)},isRequired(){return this.required===!1?!1:this.internalValue.length<=0}},watch:{isOpen(t){t&&(this.useTeleport?(this.ready=!1,this.$nextTick(()=>{const s=this.$el.getBoundingClientRect();this.dropdownStyles={position:"absolute",top:`${s.bottom+window.scrollY}px`,left:`${s.left+window.scrollX}px`,width:`${s.width}px`,zIndex:9999},this.ready=!0})):this.ready=!0)}}};const Ae=["tabindex","aria-expanded","aria-owns","aria-activedescendant"],Re={ref:"tags",class:"multiselect__tags"},Ie={class:"multiselect__tags-wrap"},qe=["textContent"],Ne=["onKeydown","onMousedown"],He=["textContent"],je={class:"multiselect__spinner"},Ue=["name","id","spellcheck","placeholder","required","value","disabled","tabindex","aria-label","aria-controls"],Ge=["id","aria-multiselectable"],ze={key:0},Ke={class:"multiselect__option"},Ye=["aria-selected","id","role"],We=["onClick","onMouseenter","data-select","data-selected","data-deselect"],Je=["data-select","data-deselect","onMouseenter","onMousedown"],Ze={class:"multiselect__option"},Xe={class:"multiselect__option"};function Qe(t,s,n,g,c,o){return d(),u("div",{tabindex:t.searchable?-1:n.tabindex,class:D([{"multiselect--active":t.isOpen,"multiselect--disabled":n.disabled,"multiselect--above":o.isAbove,"multiselect--has-options-group":o.hasOptionGroup},"multiselect"]),onFocus:s[14]||(s[14]=i=>t.activate()),onBlur:s[15]||(s[15]=i=>t.searchable?!1:t.deactivate()),onKeydown:[s[16]||(s[16]=J(E(i=>t.pointerForward(),["self","prevent"]),["down"])),s[17]||(s[17]=J(E(i=>t.pointerBackward(),["self","prevent"]),["up"])),s[18]||(s[18]=J(E(i=>t.addPointerElement(i),["stop","self"]),["enter","tab"]))],onKeyup:s[19]||(s[19]=J(i=>t.deactivate(),["esc"])),role:"combobox","aria-expanded":t.isOpen,"aria-owns":"listbox-"+t.id,"aria-activedescendant":t.isOpen&&t.pointer!==null?t.id+"-"+t.pointer:null},[F(t.$slots,"caret",{toggle:t.toggle},()=>[e("div",{onMousedown:s[0]||(s[0]=E(i=>t.toggle(),["prevent","stop"])),class:"multiselect__select"},null,32)]),F(t.$slots,"clear",{search:t.search}),e("div",Re,[F(t.$slots,"selection",{search:t.search,remove:t.removeElement,values:o.visibleValues,isOpen:t.isOpen},()=>[V(e("div",Ie,[(d(!0),u(G,null,z(o.visibleValues,(i,r)=>F(t.$slots,"tag",{option:i,search:t.search,remove:t.removeElement},()=>[(d(),u("span",{class:"multiselect__tag",key:r,onMousedown:s[1]||(s[1]=E(()=>{},["prevent"]))},[e("span",{textContent:m(t.getOptionLabel(i))},null,8,qe),e("i",{tabindex:"1",onKeydown:J(E(v=>t.removeElement(i),["prevent"]),["enter"]),onMousedown:E(v=>t.removeElement(i),["prevent"]),class:"multiselect__tag-icon"},null,40,Ne)],32))])),256))],512),[[Z,o.visibleValues.length>0]]),t.internalValue&&t.internalValue.length>n.limit?F(t.$slots,"limit",{key:0},()=>[e("strong",{class:"multiselect__strong",textContent:m(n.limitText(t.internalValue.length-n.limit))},null,8,He)]):O("v-if",!0)]),ae(we,{name:"multiselect__loading"},{default:ye(()=>[F(t.$slots,"loading",{},()=>[V(e("div",je,null,512),[[Z,n.loading]])])]),_:3}),t.searchable?(d(),u("input",{key:0,ref:"search",name:n.name,id:t.id,type:"text",autocomplete:"off",spellcheck:n.spellcheck,placeholder:t.placeholder,required:o.isRequired,style:he(o.inputStyle),value:t.search,disabled:n.disabled,tabindex:n.tabindex,"aria-label":n.name+"-searchbox",onInput:s[2]||(s[2]=i=>t.updateSearch(i.target.value)),onFocus:s[3]||(s[3]=E(i=>t.activate(),["prevent"])),onBlur:s[4]||(s[4]=E(i=>t.deactivate(),["prevent"])),onKeyup:s[5]||(s[5]=J(i=>t.deactivate(),["esc"])),onKeydown:[s[6]||(s[6]=J(E(i=>t.pointerForward(),["prevent"]),["down"])),s[7]||(s[7]=J(E(i=>t.pointerBackward(),["prevent"]),["up"])),s[8]||(s[8]=J(E(i=>t.addPointerElement(i),["prevent","stop","self"]),["enter"])),s[9]||(s[9]=J(E(i=>t.removeLastElement(),["stop"]),["delete"]))],class:"multiselect__input","aria-controls":"listbox-"+t.id},null,44,Ue)):O("v-if",!0),o.isSingleLabelVisible?(d(),u("span",{key:1,class:"multiselect__single",onMousedown:s[10]||(s[10]=E((...i)=>t.toggle&&t.toggle(...i),["prevent"]))},[F(t.$slots,"singleLabel",{option:o.singleValue},()=>[S(m(t.currentOptionLabel),1)])],32)):O("v-if",!0),o.isPlaceholderVisible?(d(),u("span",{key:2,class:"multiselect__placeholder",onMousedown:s[11]||(s[11]=E((...i)=>t.toggle&&t.toggle(...i),["prevent"]))},[F(t.$slots,"placeholder",{},()=>[S(m(t.placeholder),1)])],32)):O("v-if",!0)],512),(d(),$e(ke,{to:"body",disabled:!n.useTeleport},[ae(we,{name:"multiselect"},{default:ye(()=>[t.isOpen&&c.ready?(d(),u("div",{key:0,class:D(["multiselect__content-wrapper",n.contentWrapperClass]),onFocus:s[12]||(s[12]=(...i)=>t.activate&&t.activate(...i)),tabindex:"-1",onMousedown:s[13]||(s[13]=E(()=>{},["prevent"])),style:he([c.dropdownStyles,{maxHeight:t.optimizedHeight+"px"}]),ref:"list"},[e("ul",{class:"multiselect__content",style:he(o.contentStyle),role:"listbox",id:"listbox-"+t.id,"aria-multiselectable":t.multiple},[F(t.$slots,"beforeList"),t.multiple&&t.max===t.internalValue.length?(d(),u("li",ze,[e("span",Ke,[F(t.$slots,"maxElements",{},()=>[S("Maximum of "+m(t.max)+" options selected. First remove a selected option to select another.",1)])])])):O("v-if",!0),!t.max||t.internalValue.length<t.max?(d(!0),u(G,{key:1},z(t.filteredOptions,(i,r)=>(d(),u("li",{class:"multiselect__element",key:r,"aria-selected":t.isSelected(i),id:t.id+"-"+r,role:i&&(i.$isLabel||i.$isDisabled)?null:"option"},[i&&(i.$isLabel||i.$isDisabled)?O("v-if",!0):(d(),u("span",{key:0,class:D([t.optionHighlight(r,i),"multiselect__option"]),onClick:E(v=>t.select(i),["stop"]),onMouseenter:E(v=>t.pointerSet(r),["self"]),"data-select":i&&i.isTag?t.tagPlaceholder:o.selectLabelText,"data-selected":o.selectedLabelText,"data-deselect":o.deselectLabelText},[F(t.$slots,"option",{option:i,search:t.search,index:r},()=>[e("span",null,m(t.getOptionLabel(i)),1)])],42,We)),i&&(i.$isLabel||i.$isDisabled)?(d(),u("span",{key:1,"data-select":t.groupSelect&&o.selectGroupLabelText,"data-deselect":t.groupSelect&&o.deselectGroupLabelText,class:D([t.groupHighlight(r,i),"multiselect__option"]),onMouseenter:E(v=>t.groupSelect&&t.pointerSet(r),["self"]),onMousedown:E(v=>t.selectGroup(i),["prevent"])},[F(t.$slots,"option",{option:i,search:t.search,index:r},()=>[e("span",null,m(t.getOptionLabel(i)),1)])],42,Je)):O("v-if",!0)],8,Ye))),128)):O("v-if",!0),V(e("li",null,[e("span",Ze,[F(t.$slots,"noResult",{search:t.search},()=>[s[20]||(s[20]=S("No elements found. Consider changing the search query."))])])],512),[[Z,n.showNoResults&&t.filteredOptions.length===0&&t.search&&!n.loading]]),V(e("li",null,[e("span",Xe,[F(t.$slots,"noOptions",{},()=>[s[21]||(s[21]=S("List is empty."))])])],512),[[Z,n.showNoOptions&&(t.options.length===0||o.hasOptionGroup===!0&&t.filteredOptions.length===0)&&!t.search&&!n.loading]]),F(t.$slots,"afterList")],12,Ge)],38)):O("v-if",!0)]),_:3})],8,["disabled"]))],42,Ae)}ue.render=Qe;const et=["Aldi","Edeka","Lidl","Rewe","Netto"],ve=(t,s)=>{const n=t.__vccOpts||t;for(const[g,c]of s)n[g]=c;return n},tt={class:"filter-bar"},st={class:"mb-3"},it={class:"filter-section mb-3"},lt={class:"filter-section-body"},at={class:"d-flex flex-wrap gap-2"},nt=["onClick"],ot={class:"filter-section mb-3"},rt={class:"filter-section-body"},dt={class:"mb-3"},ut={class:"row g-2"},ct={class:"col-6"},ht={class:"col-6"},pt={class:"mb-3"},ft={class:"row g-2"},gt={class:"col-6"},mt={class:"col-6"},bt={class:"mb-3"},vt={class:"row g-2"},yt={class:"col-6"},wt={class:"col-6"},_t={class:"mb-0"},$t={class:"row g-2"},St={class:"col-6"},Mt={class:"col-6"},kt={class:"filter-section mb-3"},xt={key:0,class:"badge bg-primary ms-1"},Lt={class:"filter-section-body"},Ot={class:"filter-section mb-3"},Et={key:0,class:"badge bg-primary ms-1"},Ct={class:"filter-section-body"},Vt={class:"filter-section mb-3"},Bt={key:0,class:"badge bg-primary ms-1"},Tt={class:"filter-section-body"},Dt={class:"mt-2"},Ft={class:"d-flex flex-wrap gap-1"},Pt=["onClick"],At={class:"filter-section"},Rt={class:"filter-section-body"},It={class:"d-flex gap-2"},qt=["value"],Nt=["disabled","title"],Ht={key:0,class:"text-muted mt-1 d-block"},jt={__name:"FilterBar",props:{filters:{type:Object,required:!0},availableBrands:{type:Array,default:()=>[]},availableCategories:{type:Array,default:()=>[]},availableStores:{type:Array,default:()=>[]},sort:{type:Array,default:()=>[]}},emits:["update:filters","update:sort","reset"],setup(t,{emit:s}){const n=t,g=s,{getUniqueBrands:c,getUniqueCategories:o,getUniqueStores:i}=Se(),r=L({search:"",brands:[],categories:[],stores:[],proteinMin:"",proteinMax:"",fatMin:"",fatMax:"",carbsMin:"",carbsMax:"",energyMin:"",energyMax:"",...n.filters}),v=L({quickFilters:!1,nutrition:!1,brands:!1,categories:!1,stores:!1,sorting:!1}),P=L(""),q=L("desc");n.sort&&n.sort.length>0&&(P.value=n.sort[0].field,q.value=n.sort[0].direction);const se=L([...n.availableBrands]),K=L([...n.availableCategories]),l=L([...n.availableStores]),p=L(!1),y=L(!1),w=L(!1),_=[{key:"protein",label:"Protein",icon:"ti ti-meat"},{key:"fat",label:"Fat",icon:"ti ti-droplet"},{key:"carbs",label:"Carbs",icon:"ti ti-grain"},{key:"energy",label:"Energy",icon:"ti ti-flame"},{key:"protein_fat_index",label:"P/F Index",icon:"ti ti-chart-line"}],f=[{label:"High Protein",icon:"ti ti-meat",filters:{proteinMin:20}},{label:"Low Fat",icon:"ti ti-droplet-off",filters:{fatMax:5}},{label:"Low Carb",icon:"ti ti-leaf",filters:{carbsMax:10}},{label:"Low Cal",icon:"ti ti-flame-off",filters:{energyMax:100}}],B=et;let k=null;function T(){clearTimeout(k),k=setTimeout(()=>{A()},300)}de(()=>n.filters,b=>{r.value={search:"",brands:[],categories:[],stores:[],proteinMin:"",proteinMax:"",fatMin:"",fatMax:"",carbsMin:"",carbsMax:"",energyMin:"",energyMax:"",...b}},{deep:!0}),de(()=>n.sort,b=>{b&&b.length>0?(P.value=b[0].field,q.value=b[0].direction):(P.value="",q.value="desc")},{deep:!0}),de(()=>n.availableBrands,b=>{se.value=[...b]}),de(()=>n.availableCategories,b=>{K.value=[...b]}),de(()=>n.availableStores,b=>{l.value=[...b]});function U(b){v.value[b]=!v.value[b]}function A(){g("update:filters",{...r.value})}function Y(){P.value?g("update:sort",[{field:P.value,direction:q.value}]):g("update:sort",[])}function ee(){q.value=q.value==="asc"?"desc":"asc",Y()}function X(b){const a=_.find(h=>h.key===b);return a?a.label:b}function ne(b){for(const[a,h]of Object.entries(b.filters))if(r.value[a]!==h&&r.value[a]!==String(h))return!1;return!0}function ie(b){if(ne(b))for(const a of Object.keys(b.filters))r.value[a]="";else for(const[a,h]of Object.entries(b.filters))r.value[a]=h;A()}function j(b){return!r.value.stores||r.value.stores.length===0?!1:r.value.stores.some(a=>{const h=typeof a=="object"?a.store:a;return h&&h.toLowerCase().includes(b.toLowerCase())})}function x(b){const a=l.value.filter(R=>R.store&&R.store.toLowerCase().includes(b.toLowerCase()));if(a.length===0)return;if(r.value.stores.some(R=>{const le=typeof R=="object"?R.store:R;return le&&le.toLowerCase().includes(b.toLowerCase())}))r.value.stores=r.value.stores.filter(R=>{const le=typeof R=="object"?R.store:R;return!(le&&le.toLowerCase().includes(b.toLowerCase()))});else{const R=new Set(r.value.stores.map(re=>typeof re=="object"?re.id:re)),le=a.filter(re=>!R.has(re.id));r.value.stores=[...r.value.stores,...le]}A()}let W=null,N=null,M=null;async function $(b){clearTimeout(W),W=setTimeout(async()=>{p.value=!0;try{se.value=await c(b)}catch(a){console.error("Error searching brands:",a)}finally{p.value=!1}},300)}async function ce(b){clearTimeout(N),N=setTimeout(async()=>{y.value=!0;try{K.value=await o(b)}catch(a){console.error("Error searching categories:",a)}finally{y.value=!1}},300)}async function Me(b){clearTimeout(M),M=setTimeout(async()=>{w.value=!0;try{l.value=await i(b)}catch(a){console.error("Error searching stores:",a)}finally{w.value=!1}},300)}return(b,a)=>(d(),u("div",tt,[e("div",st,[a[19]||(a[19]=e("label",{class:"form-label"},[e("i",{class:"ti ti-search me-1"}),S(" Search ")],-1)),V(e("input",{"onUpdate:modelValue":a[0]||(a[0]=h=>r.value.search=h),type:"text",class:"form-control",placeholder:"Search by name...",onInput:T},null,544),[[Q,r.value.search]])]),e("div",it,[e("div",{class:"filter-section-header",onClick:a[1]||(a[1]=h=>U("quickFilters"))},[a[20]||(a[20]=e("span",null,[e("i",{class:"ti ti-bolt me-1"}),S(" Quick Filters ")],-1)),e("i",{class:D(v.value.quickFilters?"ti ti-chevron-down":"ti ti-chevron-up")},null,2)]),V(e("div",lt,[e("div",at,[(d(),u(G,null,z(f,h=>e("button",{key:h.label,class:D(["btn btn-sm",ne(h)?"btn-primary":"btn-outline-secondary"]),onClick:R=>ie(h)},[e("i",{class:D([h.icon,"me-1"])},null,2),S(" "+m(h.label),1)],10,nt)),64))])],512),[[Z,!v.value.quickFilters]])]),e("div",ot,[e("div",{class:"filter-section-header",onClick:a[2]||(a[2]=h=>U("nutrition"))},[a[21]||(a[21]=e("span",null,[e("i",{class:"ti ti-chart-bar me-1"}),S(" Nutrition Ranges ")],-1)),e("i",{class:D(v.value.nutrition?"ti ti-chevron-down":"ti ti-chevron-up")},null,2)]),V(e("div",rt,[e("div",dt,[a[22]||(a[22]=e("label",{class:"form-label small text-muted mb-1"},[e("i",{class:"ti ti-meat me-1"}),S("Protein (g) ")],-1)),e("div",ut,[e("div",ct,[V(e("input",{"onUpdate:modelValue":a[3]||(a[3]=h=>r.value.proteinMin=h),type:"number",class:"form-control form-control-sm",placeholder:"Min",min:"0",onInput:T},null,544),[[Q,r.value.proteinMin]])]),e("div",ht,[V(e("input",{"onUpdate:modelValue":a[4]||(a[4]=h=>r.value.proteinMax=h),type:"number",class:"form-control form-control-sm",placeholder:"Max",min:"0",onInput:T},null,544),[[Q,r.value.proteinMax]])])])]),e("div",pt,[a[23]||(a[23]=e("label",{class:"form-label small text-muted mb-1"},[e("i",{class:"ti ti-droplet me-1"}),S("Fat (g) ")],-1)),e("div",ft,[e("div",gt,[V(e("input",{"onUpdate:modelValue":a[5]||(a[5]=h=>r.value.fatMin=h),type:"number",class:"form-control form-control-sm",placeholder:"Min",min:"0",onInput:T},null,544),[[Q,r.value.fatMin]])]),e("div",mt,[V(e("input",{"onUpdate:modelValue":a[6]||(a[6]=h=>r.value.fatMax=h),type:"number",class:"form-control form-control-sm",placeholder:"Max",min:"0",onInput:T},null,544),[[Q,r.value.fatMax]])])])]),e("div",bt,[a[24]||(a[24]=e("label",{class:"form-label small text-muted mb-1"},[e("i",{class:"ti ti-grain me-1"}),S("Carbs (g) ")],-1)),e("div",vt,[e("div",yt,[V(e("input",{"onUpdate:modelValue":a[7]||(a[7]=h=>r.value.carbsMin=h),type:"number",class:"form-control form-control-sm",placeholder:"Min",min:"0",onInput:T},null,544),[[Q,r.value.carbsMin]])]),e("div",wt,[V(e("input",{"onUpdate:modelValue":a[8]||(a[8]=h=>r.value.carbsMax=h),type:"number",class:"form-control form-control-sm",placeholder:"Max",min:"0",onInput:T},null,544),[[Q,r.value.carbsMax]])])])]),e("div",_t,[a[25]||(a[25]=e("label",{class:"form-label small text-muted mb-1"},[e("i",{class:"ti ti-flame me-1"}),S("Energy (kcal) ")],-1)),e("div",$t,[e("div",St,[V(e("input",{"onUpdate:modelValue":a[9]||(a[9]=h=>r.value.energyMin=h),type:"number",class:"form-control form-control-sm",placeholder:"Min",min:"0",onInput:T},null,544),[[Q,r.value.energyMin]])]),e("div",Mt,[V(e("input",{"onUpdate:modelValue":a[10]||(a[10]=h=>r.value.energyMax=h),type:"number",class:"form-control form-control-sm",placeholder:"Max",min:"0",onInput:T},null,544),[[Q,r.value.energyMax]])])])])],512),[[Z,!v.value.nutrition]])]),e("div",kt,[e("div",{class:"filter-section-header",onClick:a[11]||(a[11]=h=>U("brands"))},[e("span",null,[a[26]||(a[26]=e("i",{class:"ti ti-tag me-1"},null,-1)),a[27]||(a[27]=S(" Brands ",-1)),r.value.brands.length?(d(),u("span",xt,m(r.value.brands.length),1)):O("",!0)]),e("i",{class:D(v.value.brands?"ti ti-chevron-down":"ti ti-chevron-up")},null,2)]),V(e("div",Lt,[ae(I(ue),{modelValue:r.value.brands,"onUpdate:modelValue":[a[12]||(a[12]=h=>r.value.brands=h),A],options:se.value,multiple:!0,searchable:!0,loading:p.value,"close-on-select":!1,"clear-on-select":!1,"internal-search":!1,label:"brand","track-by":"id",placeholder:"Select brands...",onSearchChange:$},null,8,["modelValue","options","loading"])],512),[[Z,!v.value.brands]])]),e("div",Ot,[e("div",{class:"filter-section-header",onClick:a[13]||(a[13]=h=>U("categories"))},[e("span",null,[a[28]||(a[28]=e("i",{class:"ti ti-category me-1"},null,-1)),a[29]||(a[29]=S(" Categories ",-1)),r.value.categories.length?(d(),u("span",Et,m(r.value.categories.length),1)):O("",!0)]),e("i",{class:D(v.value.categories?"ti ti-chevron-down":"ti ti-chevron-up")},null,2)]),V(e("div",Ct,[ae(I(ue),{modelValue:r.value.categories,"onUpdate:modelValue":[a[14]||(a[14]=h=>r.value.categories=h),A],options:K.value,multiple:!0,searchable:!0,loading:y.value,"close-on-select":!1,"clear-on-select":!1,"internal-search":!1,label:"category","track-by":"id",placeholder:"Select categories...",onSearchChange:ce},null,8,["modelValue","options","loading"])],512),[[Z,!v.value.categories]])]),e("div",Vt,[e("div",{class:"filter-section-header",onClick:a[15]||(a[15]=h=>U("stores"))},[e("span",null,[a[30]||(a[30]=e("i",{class:"ti ti-building-store me-1"},null,-1)),a[31]||(a[31]=S(" Stores ",-1)),r.value.stores.length?(d(),u("span",Bt,m(r.value.stores.length),1)):O("",!0)]),e("i",{class:D(v.value.stores?"ti ti-chevron-down":"ti ti-chevron-up")},null,2)]),V(e("div",Tt,[ae(I(ue),{modelValue:r.value.stores,"onUpdate:modelValue":[a[16]||(a[16]=h=>r.value.stores=h),A],options:l.value,multiple:!0,searchable:!0,loading:w.value,"close-on-select":!1,"clear-on-select":!1,"internal-search":!1,label:"store","track-by":"id",placeholder:"Select stores...",onSearchChange:Me},null,8,["modelValue","options","loading"]),e("div",Dt,[a[32]||(a[32]=e("small",{class:"text-muted d-block mb-1"},"Quick Select",-1)),e("div",Ft,[(d(!0),u(G,null,z(I(B),h=>(d(),u("button",{key:h,class:D(["btn btn-sm",j(h)?"btn-primary":"btn-outline-secondary"]),onClick:R=>x(h)},m(h),11,Pt))),128))])])],512),[[Z,!v.value.stores]])]),e("div",At,[e("div",{class:"filter-section-header",onClick:a[17]||(a[17]=h=>U("sorting"))},[a[33]||(a[33]=e("span",null,[e("i",{class:"ti ti-arrows-sort me-1"}),S(" Sort ")],-1)),e("i",{class:D(v.value.sorting?"ti ti-chevron-down":"ti ti-chevron-up")},null,2)]),V(e("div",Rt,[e("div",It,[V(e("select",{"onUpdate:modelValue":a[18]||(a[18]=h=>P.value=h),class:"form-select",onChange:Y},[a[34]||(a[34]=e("option",{value:""},"Default (Name)",-1)),(d(),u(G,null,z(_,h=>e("option",{key:h.key,value:h.key},m(h.label),9,qt)),64))],544),[[xe,P.value]]),e("button",{class:"btn btn-outline-secondary",disabled:!P.value,onClick:ee,title:q.value==="asc"?"Ascending":"Descending"},[e("i",{class:D(q.value==="asc"?"ti ti-sort-ascending":"ti ti-sort-descending")},null,2)],8,Nt)]),P.value?(d(),u("small",Ht,m(X(P.value))+": "+m(q.value==="asc"?"Low to High":"High to Low"),1)):O("",!0)],512),[[Z,!v.value.sorting]])])]))}},Ut=ve(jt,[["__scopeId","data-v-5609de09"]]),Gt={class:"loading-overlay"},zt={__name:"LoadingState",props:{message:{type:String,default:"Loading..."}},setup(t){return(s,n)=>(d(),u("div",Gt,[n[0]||(n[0]=e("div",{class:"spinner"},null,-1)),e("p",null,m(t.message),1)]))}},Kt=ve(zt,[["__scopeId","data-v-f716d3f9"]]),Yt={class:"product-cards-list"},Wt={key:0,class:"empty"},Jt={key:1,class:"table-responsive"},Zt={class:"table table-hover table-vcenter"},Xt={class:"list-image-container"},Qt={key:0,class:"image-wrapper"},es=["data-id"],ts=["src","alt","onLoad","onError"],ss={key:1,class:"list-placeholder"},is={class:"product-name-cell"},ls={class:"product-name"},as={key:0,class:"product-badges mt-1"},ns={class:"text-end"},os={key:0,class:"text-body"},rs={key:1,class:"text-muted"},ds={class:"text-end"},us={key:0,class:"text-body"},cs={key:1,class:"text-muted"},hs={class:"text-end"},ps={key:0,class:"text-body"},fs={key:1,class:"text-muted"},gs={class:"text-end"},ms={key:0,class:"text-body"},bs={key:1,class:"text-muted"},vs={class:"text-end"},ys={key:0,class:"text-body"},ws={key:1,class:"text-muted"},_s=["href"],$s={key:2,class:"row row-cards"},Ss={class:"card"},Ms={class:"card-img-top img-responsive img-responsive-21x9 card-img-top-custom"},ks={key:0,class:"image-wrapper-grid"},xs=["data-id"],Ls=["src","alt","onLoad","onError"],Os={key:1,class:"placeholder-icon"},Es={class:"card-body"},Cs={class:"d-flex align-items-center mb-3"},Vs={class:"flex-fill"},Bs=["href"],Ts={class:"card-title mb-1"},Ds={class:"row g-2 mb-3"},Fs={class:"col-6"},Ps={class:"d-flex flex-column"},As={key:0,class:"text-body values"},Rs={key:1,class:"text-muted"},Is={class:"col-6"},qs={class:"d-flex flex-column"},Ns={key:0,class:"text-body values"},Hs={key:1,class:"text-muted"},js={class:"col-4"},Us={class:"d-flex flex-column"},Gs={key:0,class:"text-body values"},zs={key:1,class:"text-muted"},Ks={class:"col-4"},Ys={class:"d-flex flex-column"},Ws={key:0,class:"text-body values"},Js={key:1,class:"text-muted"},Zs={class:"col-4"},Xs={class:"d-flex flex-column"},Qs={key:0,class:"text-body values"},ei={key:1,class:"text-muted"},ti={class:"mb-0"},si={key:0,class:"mb-2"},ii={class:"d-flex flex-wrap gap-1"},li={key:1,class:"mb-2"},ai={class:"d-flex flex-wrap gap-1"},ni={key:2},oi={class:"d-flex flex-wrap gap-1"},ri={key:0,class:"card-footer"},di=["href"],ui={__name:"ProductCardsList",props:{products:{type:Array,default:()=>[]},viewMode:{type:String,default:"grid",validator:t=>["grid","list"].includes(t)}},setup(t){function s(c,o){const i=document.querySelector(`[data-id="${o}"]`);i&&(i.style.display="none")}function n(c,o){const i=document.querySelector(`[data-id="${o}"]`);i&&(i.style.display="none"),c.target.style.display="none";const r=c.target.closest(".image-wrapper-grid")||c.target.closest(".image-wrapper");if(r){const v=document.createElement("div");v.className="placeholder-icon",v.innerHTML='<i class="ti ti-photo-off"></i>',r.appendChild(v)}}function g(c){if(!c)return[];if(Array.isArray(c))return c.map(o=>String(o).trim()).filter(Boolean).slice(0,3);if(typeof c=="string"){try{const o=JSON.parse(c);if(Array.isArray(o))return o.map(i=>String(i).trim()).filter(Boolean).slice(0,3)}catch{}return c.split(",").map(o=>o.trim()).filter(Boolean).slice(0,3)}return[]}return(c,o)=>(d(),u("div",Yt,[t.products.length===0?(d(),u("div",Wt,[...o[0]||(o[0]=[e("div",{class:"empty-icon"},[e("i",{class:"ti ti-package-off",style:{"font-size":"4rem"}})],-1),e("p",{class:"empty-title"},"No products found",-1),e("p",{class:"empty-subtitle text-muted"},"Try adjusting your filters",-1)])])):t.viewMode==="list"?(d(),u("div",Jt,[e("table",Zt,[o[4]||(o[4]=e("thead",null,[e("tr",null,[e("th",{style:{width:"50px"}}),e("th",null,"Name"),e("th",{class:"text-end",style:{width:"90px"}},"Protein"),e("th",{class:"text-end",style:{width:"90px"}},"Fat"),e("th",{class:"text-end",style:{width:"90px"}},"Carbs"),e("th",{class:"text-end",style:{width:"90px"}},"Energy"),e("th",{class:"text-end",style:{width:"90px"}},"P/F Index"),e("th",{style:{width:"60px"}})])],-1)),e("tbody",null,[(d(!0),u(G,null,z(t.products,i=>(d(),u("tr",{key:i.id},[e("td",null,[e("div",Xt,[i.image_url?(d(),u("div",Qt,[e("div",{class:"image-spinner","data-id":"list-spinner-"+i.id},[...o[1]||(o[1]=[e("span",{class:"spinner-border spinner-border-sm"},null,-1)])],8,es),e("img",{src:i.image_url,alt:i.name,loading:"lazy",crossorigin:"anonymous",class:"list-image",onLoad:r=>s(r,"list-spinner-"+i.id),onError:r=>n(r,"list-spinner-"+i.id)},null,40,ts)])):(d(),u("div",ss,[...o[2]||(o[2]=[e("i",{class:"ti ti-photo-off"},null,-1)])]))])]),e("td",null,[e("div",is,[e("span",ls,m(i.name||"Unknown Product"),1),i.brands?(d(),u("div",as,[(d(!0),u(G,null,z(g(i.brands).slice(0,2),(r,v)=>(d(),u("span",{key:v,class:"badge bg-blue-lt me-1"},m(r),1))),128))])):O("",!0)])]),e("td",ns,[i.protein?(d(),u("strong",os,m(i.protein)+"g",1)):(d(),u("span",rs,"-"))]),e("td",ds,[i.fat?(d(),u("strong",us,m(i.fat)+"g",1)):(d(),u("span",cs,"-"))]),e("td",hs,[i.carbs?(d(),u("strong",ps,m(i.carbs)+"g",1)):(d(),u("span",fs,"-"))]),e("td",gs,[i.energy?(d(),u("strong",ms,m(Math.round(i.energy)),1)):(d(),u("span",bs,"-"))]),e("td",vs,[i.protein_fat_index?(d(),u("strong",ys,m(Number(i.protein_fat_index).toFixed(2)),1)):(d(),u("span",ws,"-"))]),e("td",null,[i.url?(d(),u("a",{key:0,href:i.url,target:"_blank",rel:"noopener noreferrer",class:"btn btn-sm btn-ghost-primary"},[...o[3]||(o[3]=[e("i",{class:"ti ti-external-link"},null,-1)])],8,_s)):O("",!0)])]))),128))])])])):(d(),u("div",$s,[(d(!0),u(G,null,z(t.products,i=>(d(),u("div",{key:i.id,class:"col-12 col-md-6 col-lg-4"},[e("div",Ss,[e("div",Ms,[i.image_url?(d(),u("div",ks,[e("div",{class:"image-spinner-grid","data-id":"grid-spinner-"+i.id},[...o[5]||(o[5]=[e("span",{class:"spinner-border text-primary"},null,-1)])],8,xs),e("img",{src:i.image_url,alt:i.name,loading:"lazy",crossorigin:"anonymous",class:"product-image",onLoad:r=>s(r,"grid-spinner-"+i.id),onError:r=>n(r,"grid-spinner-"+i.id)},null,40,Ls)])):(d(),u("div",Os,[...o[6]||(o[6]=[e("i",{class:"ti ti-photo-off"},null,-1)])]))]),e("div",Es,[e("div",Cs,[e("div",Vs,[e("a",{href:i.url||"#",target:"_blank",rel:"noopener noreferrer",class:"text-reset text-decoration-none"},[e("h3",Ts,m(i.name||"Unknown Product"),1)],8,Bs)])]),e("div",Ds,[e("div",Fs,[e("div",Ps,[o[7]||(o[7]=e("small",{class:"text-muted mb-1"},[e("i",{class:"ti ti-flame me-1"}),S("Energy ")],-1)),i.energy?(d(),u("strong",As,m(Math.round(i.energy))+" kcal ",1)):(d(),u("span",Rs,"-"))])]),e("div",Is,[e("div",qs,[o[8]||(o[8]=e("small",{class:"text-muted mb-1"},[e("i",{class:"ti ti-chart-line me-1"}),S("P/F Index ")],-1)),i.protein_fat_index?(d(),u("strong",Ns,m(Number(i.protein_fat_index).toFixed(2)),1)):(d(),u("span",Hs,"-"))])]),e("div",js,[e("div",Us,[o[9]||(o[9]=e("small",{class:"text-muted mb-1"},"Fat",-1)),i.fat?(d(),u("strong",Gs,m(i.fat)+" g",1)):(d(),u("span",zs,"-"))])]),e("div",Ks,[e("div",Ys,[o[10]||(o[10]=e("small",{class:"text-muted mb-1"},"Carbs",-1)),i.carbs?(d(),u("strong",Ws,m(i.carbs)+" g",1)):(d(),u("span",Js,"-"))])]),e("div",Zs,[e("div",Xs,[o[11]||(o[11]=e("small",{class:"text-muted mb-1"},"Protein",-1)),i.protein?(d(),u("strong",Qs,m(i.protein)+" g",1)):(d(),u("span",ei,"-"))])])]),e("div",ti,[i.brands?(d(),u("div",si,[o[12]||(o[12]=e("small",{class:"text-muted d-block mb-1"},[e("i",{class:"ti ti-tag me-1"}),S("Brands ")],-1)),e("div",ii,[(d(!0),u(G,null,z(g(i.brands),(r,v)=>(d(),u("span",{key:v,class:"badge bg-blue-lt"},m(r),1))),128))])])):O("",!0),i.categories?(d(),u("div",li,[o[13]||(o[13]=e("small",{class:"text-muted d-block mb-1"},[e("i",{class:"ti ti-category me-1"}),S("Categories ")],-1)),e("div",ai,[(d(!0),u(G,null,z(g(i.categories),(r,v)=>(d(),u("span",{key:v,class:"badge bg-green-lt"},m(r),1))),128))])])):O("",!0),i.stores?(d(),u("div",ni,[o[14]||(o[14]=e("small",{class:"text-muted d-block mb-1"},[e("i",{class:"ti ti-building-store me-1"}),S("Stores ")],-1)),e("div",oi,[(d(!0),u(G,null,z(g(i.stores),(r,v)=>(d(),u("span",{key:v,class:"badge bg-orange-lt"},m(r),1))),128))])])):O("",!0)])]),i.url?(d(),u("div",ri,[e("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",class:"btn btn-outline-primary w-100"},[...o[15]||(o[15]=[e("i",{class:"ti ti-external-link me-1"},null,-1),S(" View ",-1)])],8,di)])):O("",!0)])]))),128))]))]))}},ci=ve(ui,[["__scopeId","data-v-560d3234"]]),hi={id:"app"},pi={class:"navbar navbar-expand-md navbar-light d-print-none"},fi={class:"container-xl"},gi={class:"navbar-nav flex-row order-md-last"},mi={class:"d-flex align-items-center"},bi={class:"col-auto ms-auto d-print-none"},vi={class:"btn-list"},yi=["disabled"],wi={key:0,class:"ti ti-download"},_i={key:1,class:"spinner-border spinner-border-sm me-2"},$i=["disabled"],Si={class:"page-wrapper"},Mi={class:"page-body"},ki={class:"container-xl"},xi={class:"row"},Li={class:"col-lg-3 mb-3"},Oi={class:"card sticky-top",style:{top:"1rem"}},Ei={class:"card-body"},Ci={class:"row row-cards mt-3"},Vi={class:"col-12"},Bi={class:"card"},Ti={class:"card-body"},Di={class:"h1 mb-0"},Fi={class:"col-12"},Pi={class:"card"},Ai={class:"card-body"},Ri={class:"h1 mb-0"},Ii={class:"col-lg-9"},qi={class:"card mb-3"},Ni={class:"card-header"},Hi={class:"card-title"},ji={class:"card-actions"},Ui={class:"d-flex align-items-center gap-2"},Gi={class:"btn-group me-2"},zi=["disabled"],Ki={class:"text-muted"},Yi=["disabled"],Wi={class:"card-body"},be="food-app-sort",Ji=21,Zi={__name:"App",setup(t){const{loading:s,loadingMessage:n,dbStats:g,loadData:c,clearDatabase:o,updateStats:i,queryProducts:r,getUniqueBrands:v,getUniqueCategories:P,getUniqueStores:q,hasData:se}=Se(),K=L([]),l=L("grid"),p=L({search:"",brands:[],categories:[],stores:[],proteinMin:"",proteinMax:"",fatMin:"",fatMax:"",carbsMin:"",carbsMax:"",energyMin:"",energyMax:""});function y(){try{const M=localStorage.getItem(be);return M?JSON.parse(M):[]}catch(M){return console.error("Error loading saved sort:",M),[]}}const w=L(y()),_=L(1),f=L(0),B=L(0),k=L([]),T=L([]),U=L([]);async function A(){k.value=await v(),T.value=await P(),U.value=await q()}async function Y(M){M&&(p.value={...M}),_.value=1,await X()}async function ee(M){if(M){w.value=[...M];try{localStorage.setItem(be,JSON.stringify(M))}catch($){console.error("Error saving sort:",$)}}_.value=1,await X()}async function X(){const M=await r(p.value,_.value,Ji,w.value);K.value=M.products,B.value=M.totalCount,f.value=M.totalPages}function ne(){p.value={search:"",brands:[],categories:[],stores:[],proteinMin:"",proteinMax:"",fatMin:"",fatMax:"",carbsMin:"",carbsMax:"",energyMin:"",energyMax:""},w.value=[];try{localStorage.removeItem(be)}catch(M){console.error("Error clearing saved sort:",M)}Y()}async function ie(){_.value<f.value&&(_.value++,await X())}async function j(){_.value>1&&(_.value--,await X())}async function x(){try{await c(),await A(),await Y()}catch(M){alert("Error loading data: "+M.message)}}async function W(){await o()&&(K.value=[],B.value=0,f.value=1,k.value=[],T.value=[])}async function N(){if(await i(),await se())await A(),await X();else try{await c(),await A(),await Y()}catch{console.log("No cached database found, waiting for user to load")}}return Le(()=>{N()}),(M,$)=>(d(),u("div",hi,[I(s)?(d(),$e(Kt,{key:0,message:I(n)},null,8,["message"])):O("",!0),e("header",pi,[e("div",fi,[$[3]||($[3]=e("h1",{class:"navbar-brand navbar-brand-autodark d-none-navbar-horizontal pe-0 pe-md-3"},[e("a",{href:"#"},[e("span",{class:"navbar-brand-image"}),S(" OpenFoodFacts Germany ")])],-1)),e("div",gi,[e("div",mi,[e("div",bi,[e("div",vi,[e("button",{class:"btn btn-primary",onClick:x,disabled:I(s)},[I(s)?O("",!0):(d(),u("i",wi)),I(s)?(d(),u("span",_i)):O("",!0),S(" "+m(I(s)?I(n):"Load Database"),1)],8,yi),I(g).count>0?(d(),u("button",{key:0,class:"btn btn-outline-danger",onClick:W,disabled:I(s)},[...$[2]||($[2]=[e("i",{class:"ti ti-trash"},null,-1),S(" Clear Data ",-1)])],8,$i)):O("",!0)])])])])])]),e("div",Si,[e("div",Mi,[e("div",ki,[e("div",xi,[e("div",Li,[e("div",Oi,[e("div",{class:"card-header"},[$[5]||($[5]=e("h3",{class:"card-title"},[e("i",{class:"ti ti-filter me-2"}),S(" Filters ")],-1)),e("div",{class:"card-actions"},[e("button",{class:"btn btn-outline",onClick:ne},[...$[4]||($[4]=[e("i",{class:"ti ti-refresh"},null,-1),S(" Reset ",-1)])])])]),e("div",Ei,[ae(Ut,{filters:p.value,sort:w.value,"available-brands":k.value,"available-categories":T.value,"available-stores":U.value,"onUpdate:filters":Y,"onUpdate:sort":ee,onReset:ne},null,8,["filters","sort","available-brands","available-categories","available-stores"])])]),e("div",Ci,[e("div",Vi,[e("div",Bi,[e("div",Ti,[$[6]||($[6]=e("div",{class:"subheader"},"Total Products",-1)),e("div",Di,m(I(g).count.toLocaleString()),1)])])]),e("div",Fi,[e("div",Pi,[e("div",Ai,[$[7]||($[7]=e("div",{class:"subheader"},"Filtered Results",-1)),e("div",Ri,m(B.value.toLocaleString()),1)])])])])]),e("div",Ii,[e("div",qi,[e("div",Ni,[e("h3",Hi," Products ("+m(K.value.length)+" of "+m(B.value.toLocaleString())+") ",1),e("div",ji,[e("div",Ui,[e("div",Gi,[e("button",{class:D(["btn btn-sm",l.value==="grid"?"btn-primary":"btn-outline-secondary"]),onClick:$[0]||($[0]=ce=>l.value="grid"),title:"Grid View"},[...$[8]||($[8]=[e("i",{class:"ti ti-grid-dots"},null,-1)])],2),e("button",{class:D(["btn btn-sm",l.value==="list"?"btn-primary":"btn-outline-secondary"]),onClick:$[1]||($[1]=ce=>l.value="list"),title:"List View"},[...$[9]||($[9]=[e("i",{class:"ti ti-list"},null,-1)])],2)]),e("button",{class:"btn btn-outline-primary",onClick:j,disabled:_.value===1},[...$[10]||($[10]=[e("i",{class:"ti ti-chevron-left"},null,-1),S(" Previous ",-1)])],8,zi),e("span",Ki," Page "+m(_.value)+" of "+m(f.value),1),e("button",{class:"btn btn-outline-primary",onClick:ie,disabled:_.value>=f.value},[...$[11]||($[11]=[S(" Next ",-1),e("i",{class:"ti ti-chevron-right"},null,-1)])],8,Yi)])])]),e("div",Wi,[ae(ci,{products:K.value,"view-mode":l.value},null,8,["products","view-mode"])])])])])])]),$[12]||($[12]=Oe('<footer class="footer footer-transparent d-print-none"><div class="container-xl"><div class="row text-center align-items-center"><div class="col-12 col-lg-auto mt-3 mt-lg-0"><ul class="list-inline list-inline-dots mb-0"><li class="list-inline-item"> Powered by OpenFoodFacts data </li><li class="list-inline-item"><a href="https://github.com/mkoziy/food" target="_blank" rel="noopener noreferrer" class="link-muted align-items-center"><svg xmlns="http://www.w3.org/2000/svg" class="me-1" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 .5C5.7.5.9 5.3.9 11.6c0 4.7 3 8.7 7.2 10.1.5.1.7-.2.7-.5v-1.9c-2.9.6-3.5-1.4-3.5-1.4-.5-1.2-1.2-1.6-1.2-1.6-1-.7.1-.7.1-.7 1.1.1 1.7 1.1 1.7 1.1 1 .1 1.6.7 1.9 1.2.1-.8.4-1.4.8-1.8-2.3-.3-4.7-1.2-4.7-5.3 0-1.2.4-2.1 1.1-2.8-.1-.3-.5-1.5.1-3.1 0 0 .9-.3 3 .1.9-.3 1.8-.4 2.7-.4s1.8.1 2.7.4c2.1-.4 3-.1 3-.1.6 1.6.2 2.8.1 3.1.7.7 1.1 1.6 1.1 2.8 0 4.1-2.4 5-4.7 5.3.4.3.8 1.1.8 2.2v3.2c0 .3.2.6.7.5 4.2-1.4 7.2-5.4 7.2-10.1C23.1 5.3 18.3.5 12 .5z"></path></svg> Source on GitHub </a></li></ul></div></div></div></footer>',1))])]))}};Ee(Zi).mount("#app");
