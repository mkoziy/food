import{r as C,c,o as u,a as G,b as t,d as Ie,e as ue,f as V,w as Oe,g as F,v as ae,T as Ee,h as ne,i as P,n as ye,j as N,k as S,t as M,F as Q,l as ee,m as Re,p as ge,q as oe,u as U,s as Ne,x as qe,y as je,z as Ue,A as Ce,B as He}from"./vue-Ct7jX3QJ.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))b(f);new MutationObserver(f=>{for(const o of f)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&b(i)}).observe(document,{childList:!0,subtree:!0});function n(f){const o={};return f.integrity&&(o.integrity=f.integrity),f.referrerPolicy&&(o.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?o.credentials="include":f.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function b(f){if(f.ep)return;f.ep=!0;const o=n(f);fetch(f.href,o)}})();let I=null,Z=null;const Me=C(!1),re=C(""),pe=C({count:0}),ze="food-database-cache",Ge=1,we="database-data";function Fe(){async function e(){if(Z)return Z;try{return Z=await(await new Promise((g,y)=>{if(window.sqlite3InitModule){g(window.sqlite3InitModule);return}const p=document.createElement("script");p.type="module",p.textContent=`
                    import sqlite3InitModule from '/sqlite-wasm/sqlite3.mjs';
                    window.sqlite3InitModule = sqlite3InitModule;
                    window.dispatchEvent(new Event('sqlite3-loaded'));
                `,window.addEventListener("sqlite3-loaded",()=>{g(window.sqlite3InitModule)},{once:!0}),p.onerror=y,document.head.appendChild(p)}))({print:console.log,printErr:console.error,locateFile:g=>`/sqlite-wasm/${g}`}),console.log("SQLite wasm initialized:",Z.version.libVersion),Z}catch(a){throw console.error("Failed to initialize SQLite:",a),a}}async function s(){return new Promise((a,g)=>{const y=indexedDB.open(ze,Ge);y.onerror=()=>g(y.error),y.onsuccess=()=>a(y.result),y.onupgradeneeded=p=>{const k=p.target.result;k.objectStoreNames.contains("databases")||k.createObjectStore("databases")}})}async function n(){try{const a=await s();return new Promise((g,y)=>{const w=a.transaction(["databases"],"readonly").objectStore("databases").get(we);w.onerror=()=>y(w.error),w.onsuccess=()=>g(w.result)})}catch(a){return console.error("Error getting cached database:",a),null}}async function b(a){try{const g=await s();return new Promise((y,p)=>{const L=g.transaction(["databases"],"readwrite").objectStore("databases").put(a,we);L.onerror=()=>p(L.error),L.onsuccess=()=>y(!0)})}catch(g){return console.error("Error caching database:",g),!1}}async function f(){try{const a=await s();return new Promise((g,y)=>{const w=a.transaction(["databases"],"readwrite").objectStore("databases").delete(we);w.onerror=()=>y(w.error),w.onsuccess=()=>g(!0)})}catch(a){return console.error("Error clearing cache:",a),!1}}async function o(){Me.value=!0,re.value="Initializing database...";try{await e(),re.value="Checking cache...";const a=await n();let g;if(a)console.log("Loading database from cache"),re.value="Loading from cache...",g=new Uint8Array(a);else{console.log("Downloading database from server"),re.value="Downloading database...";const w=await fetch("/data.sqlite");if(!w.ok)throw new Error(`Failed to fetch database: ${w.statusText}`);const L=await w.arrayBuffer();g=new Uint8Array(L),re.value="Caching database...",await b(L),console.log("Database cached successfully")}re.value="Loading database...",I&&(I.close(),I=null),I=new Z.oo1.DB(":memory:");const y=Z.wasm.alloc(g.length),p=1024*1024;for(let w=0;w<g.length;w+=p){const L=Math.min(w+p,g.length),_=g.slice(w,L);Z.wasm.heap8().set(_,y+w)}const k=Z.capi.sqlite3_deserialize(I.pointer,"main",y,g.length,g.length,Z.capi.SQLITE_DESERIALIZE_FREEONCLOSE|Z.capi.SQLITE_DESERIALIZE_RESIZEABLE);if(k!==0)throw Z.wasm.dealloc(y),new Error(`Failed to deserialize database: ${Z.capi.sqlite3_errstr(k)}`);return console.log("Database loaded successfully"),await i(),!0}catch(a){throw console.error("Error loading database:",a),a}finally{Me.value=!1,re.value=""}}async function i(){if(!I){pe.value={count:0};return}try{const a=I.exec({sql:"SELECT COUNT(*) as count FROM food",returnValue:"resultRows",rowMode:"object"});a&&a.length>0&&(pe.value={count:a[0].count})}catch(a){console.error("Error updating stats:",a),pe.value={count:0}}}async function d(a,g=1,y=21,p=null){if(!I)return{products:[],totalCount:0,totalPages:0};try{const k=(g-1)*y,w={};let L="FROM food f";const _=[];if(a.search&&a.search.trim()&&(L=`
                    FROM food_fts fts
                    JOIN food f ON f.id = fts.rowid
                `,_.push("food_fts MATCH :search"),w[":search"]=a.search.trim()+"*"),a.brands&&a.brands.length>0){const J=a.brands.map(E=>typeof E=="object"?E.id:E).map((E,Y)=>{const W=`:brand${Y}`;return w[W]=E,W}).join(",");_.push(`f.id IN (
                    SELECT food_id FROM brand_food
                    WHERE brand_id IN (${J})
                )`)}if(a.categories&&a.categories.length>0){const J=a.categories.map(E=>typeof E=="object"?E.id:E).map((E,Y)=>{const W=`:category${Y}`;return w[W]=E,W}).join(",");_.push(`f.id IN (
                    SELECT food_id FROM category_food
                    WHERE category_id IN (${J})
                )`)}if(a.stores&&a.stores.length>0){const J=a.stores.map(E=>typeof E=="object"?E.id:E).map((E,Y)=>{const W=`:store${Y}`;return w[W]=E,W}).join(",");_.push(`f.id IN (
                    SELECT food_id FROM store_food
                    WHERE store_id IN (${J})
                )`)}a.proteinMin!==void 0&&a.proteinMin!==null&&a.proteinMin!==""&&(_.push("f.protein >= :proteinMin"),w[":proteinMin"]=Number(a.proteinMin)),a.proteinMax!==void 0&&a.proteinMax!==null&&a.proteinMax!==""&&(_.push("f.protein <= :proteinMax"),w[":proteinMax"]=Number(a.proteinMax)),a.fatMin!==void 0&&a.fatMin!==null&&a.fatMin!==""&&(_.push("f.fat >= :fatMin"),w[":fatMin"]=Number(a.fatMin)),a.fatMax!==void 0&&a.fatMax!==null&&a.fatMax!==""&&(_.push("f.fat <= :fatMax"),w[":fatMax"]=Number(a.fatMax)),a.carbsMin!==void 0&&a.carbsMin!==null&&a.carbsMin!==""&&(_.push("f.carbs >= :carbsMin"),w[":carbsMin"]=Number(a.carbsMin)),a.carbsMax!==void 0&&a.carbsMax!==null&&a.carbsMax!==""&&(_.push("f.carbs <= :carbsMax"),w[":carbsMax"]=Number(a.carbsMax)),a.energyMin!==void 0&&a.energyMin!==null&&a.energyMin!==""&&(_.push("f.energy >= :energyMin"),w[":energyMin"]=Number(a.energyMin)),a.energyMax!==void 0&&a.energyMax!==null&&a.energyMax!==""&&(_.push("f.energy <= :energyMax"),w[":energyMax"]=Number(a.energyMax));const B=_.length>0?`WHERE ${_.join(" AND ")}`:"",D=`
                SELECT COUNT(*) as count
                ${L}
                ${B}
            `,A=I.exec({sql:D,bind:w,returnValue:"resultRows",rowMode:"object"}),K=A&&A.length>0?A[0].count:0;let H;p&&Array.isArray(p)&&p.length>0?H=`ORDER BY ${p.map(J=>{const E=J.direction.toUpperCase();return`f.${J.field} ${E} NULLS LAST`}).join(", ")}`:a.search&&a.search.trim()?H="ORDER BY fts.rank":H="ORDER BY f.name";const j=`
                SELECT
                    f.id,
                    f.name,
                    f.url,
                    f.image_url,
                    f.brands,
                    f.categories,
                    f.stores,
                    f.fat,
                    f.protein,
                    f.carbs,
                    f.energy,
                    f.protein_fat_index
                ${L}
                ${B}
                ${H}
                LIMIT :limit OFFSET :offset
            `;return{products:I.exec({sql:j,bind:{...w,":limit":y,":offset":k},returnValue:"resultRows",rowMode:"object"})||[],totalCount:K,totalPages:Math.ceil(K/y)}}catch(k){return console.error("Error querying products:",k),{products:[],totalCount:0,totalPages:0}}}async function $(a=""){if(!I)return[];try{let g,y={};a&&a.trim()?(g=`
                    SELECT rowid as id, brand
                    FROM brands_fts
                    WHERE brand MATCH :search
                    ORDER BY rank
                    LIMIT 100
                `,y[":search"]=a.trim()+"*"):g=`
                    SELECT id, brand
                    FROM brands
                    ORDER BY brand ASC
                    LIMIT 100
                `;const p=I.exec({sql:g,bind:y,returnValue:"resultRows",rowMode:"object"});return p?p.filter(k=>k.brand):[]}catch(g){return console.error("Error getting unique brands:",g),[]}}async function R(a=""){if(!I)return[];try{let g,y={};a&&a.trim()?(g=`
                    SELECT rowid as id, category
                    FROM categories_fts
                    WHERE category MATCH :search
                    ORDER BY rank
                    LIMIT 100
                `,y[":search"]=a.trim()+"*"):g=`
                    SELECT id, category
                    FROM categories
                    ORDER BY category ASC
                    LIMIT 100
                `;const p=I.exec({sql:g,bind:y,returnValue:"resultRows",rowMode:"object"});return p?p.filter(k=>k.category):[]}catch(g){return console.error("Error getting unique categories:",g),[]}}async function q(a=""){if(!I)return[];try{let g,y={};a&&a.trim()?(g=`
                    SELECT rowid as id, store
                    FROM stores_fts
                    WHERE store MATCH :search
                    ORDER BY rank
                    LIMIT 100
                `,y[":search"]=a.trim()+"*"):g=`
                    SELECT id, store
                    FROM stores
                    ORDER BY store ASC
                `;const p=I.exec({sql:g,bind:y,returnValue:"resultRows",rowMode:"object"});return p?p.filter(k=>k.store):[]}catch(g){return console.error("Error getting unique stores:",g),[]}}async function ie(){return I!==null&&pe.value.count>0}async function X(){return I&&(I.close(),I=null,pe.value={count:0}),await f(),console.log("Database and cache cleared"),!0}return{loading:Me,loadingMessage:re,dbStats:pe,loadData:o,clearDatabase:X,clearDatabaseCache:f,updateStats:i,queryProducts:d,getUniqueBrands:$,getUniqueCategories:R,getUniqueStores:q,hasData:ie}}const v={search:"q",brands:"brands",categories:"categories",stores:"stores",proteinMin:"pmin",proteinMax:"pmax",fatMin:"fmin",fatMax:"fmax",carbsMin:"cmin",carbsMax:"cmax",energyMin:"emin",energyMax:"emax",sort:"sort",page:"page",pageSize:"size",viewMode:"view"};function Ke(){const e=new URLSearchParams(window.location.search);return Array.from(e.keys()).some(s=>Object.values(v).includes(s))}function Ae(){const e=new URLSearchParams(window.location.search),s={};if(e.has(v.search)&&(s.search=e.get(v.search)),e.has(v.brands)&&(s.brandIds=xe(e.get(v.brands))),e.has(v.categories)&&(s.categoryIds=xe(e.get(v.categories))),e.has(v.stores)&&(s.storeIds=xe(e.get(v.stores))),e.has(v.proteinMin)&&(s.proteinMin=de(e.get(v.proteinMin))),e.has(v.proteinMax)&&(s.proteinMax=de(e.get(v.proteinMax))),e.has(v.fatMin)&&(s.fatMin=de(e.get(v.fatMin))),e.has(v.fatMax)&&(s.fatMax=de(e.get(v.fatMax))),e.has(v.carbsMin)&&(s.carbsMin=de(e.get(v.carbsMin))),e.has(v.carbsMax)&&(s.carbsMax=de(e.get(v.carbsMax))),e.has(v.energyMin)&&(s.energyMin=de(e.get(v.energyMin))),e.has(v.energyMax)&&(s.energyMax=de(e.get(v.energyMax))),e.has(v.sort)&&(s.sort=Je(e.get(v.sort))),e.has(v.page)){const n=parseInt(e.get(v.page),10);!isNaN(n)&&n>=1&&(s.page=n)}if(e.has(v.pageSize)){const n=parseInt(e.get(v.pageSize),10);!isNaN(n)&&n>0&&(s.pageSize=n)}if(e.has(v.viewMode)){const n=e.get(v.viewMode);(n==="grid"||n==="list")&&(s.viewMode=n)}return s}function Ye(e){var n,b,f,o,i,d,$,R,q,ie,X,a,g,y,p,k,w,L,_,B,D,A,K,H;const s=new URLSearchParams;if((n=e.filters)!=null&&n.search&&s.set(v.search,e.filters.search),((f=(b=e.filters)==null?void 0:b.brands)==null?void 0:f.length)>0){const j=e.filters.brands.map(O=>typeof O=="object"?O.id:O);s.set(v.brands,j.join(","))}if(((i=(o=e.filters)==null?void 0:o.categories)==null?void 0:i.length)>0){const j=e.filters.categories.map(O=>typeof O=="object"?O.id:O);s.set(v.categories,j.join(","))}if((($=(d=e.filters)==null?void 0:d.stores)==null?void 0:$.length)>0){const j=e.filters.stores.map(O=>typeof O=="object"?O.id:O);s.set(v.stores,j.join(","))}if(((R=e.filters)==null?void 0:R.proteinMin)!==""&&((q=e.filters)==null?void 0:q.proteinMin)!=null&&s.set(v.proteinMin,e.filters.proteinMin),((ie=e.filters)==null?void 0:ie.proteinMax)!==""&&((X=e.filters)==null?void 0:X.proteinMax)!=null&&s.set(v.proteinMax,e.filters.proteinMax),((a=e.filters)==null?void 0:a.fatMin)!==""&&((g=e.filters)==null?void 0:g.fatMin)!=null&&s.set(v.fatMin,e.filters.fatMin),((y=e.filters)==null?void 0:y.fatMax)!==""&&((p=e.filters)==null?void 0:p.fatMax)!=null&&s.set(v.fatMax,e.filters.fatMax),((k=e.filters)==null?void 0:k.carbsMin)!==""&&((w=e.filters)==null?void 0:w.carbsMin)!=null&&s.set(v.carbsMin,e.filters.carbsMin),((L=e.filters)==null?void 0:L.carbsMax)!==""&&((_=e.filters)==null?void 0:_.carbsMax)!=null&&s.set(v.carbsMax,e.filters.carbsMax),((B=e.filters)==null?void 0:B.energyMin)!==""&&((D=e.filters)==null?void 0:D.energyMin)!=null&&s.set(v.energyMin,e.filters.energyMin),((A=e.filters)==null?void 0:A.energyMax)!==""&&((K=e.filters)==null?void 0:K.energyMax)!=null&&s.set(v.energyMax,e.filters.energyMax),((H=e.sort)==null?void 0:H.length)>0){const j=e.sort.map(O=>`${O.field}:${O.direction}`).join(",");s.set(v.sort,j)}return e.page&&e.page>1&&s.set(v.page,e.page),e.pageSize&&e.pageSize!==50&&s.set(v.pageSize,e.pageSize),e.viewMode&&e.viewMode!=="grid"&&s.set(v.viewMode,e.viewMode),s.toString()}function he(e,s=!0){const n=Ye(e),b=n?`${window.location.pathname}?${n}`:window.location.pathname;s?window.history.replaceState(null,"",b):window.history.pushState(null,"",b)}function We(e){const s=n=>{const b=Ae();e(b,n.state)};return window.addEventListener("popstate",s),()=>{window.removeEventListener("popstate",s)}}function $e(e,s,n="id"){return!e||!s?[]:e.map(b=>s.find(f=>f[n]===b)).filter(b=>b!=null)}function xe(e){return e?e.split(",").map(s=>parseInt(s.trim(),10)).filter(s=>!isNaN(s)):[]}function de(e){if(!e)return"";const s=parseFloat(e);return isNaN(s)?"":s}function Je(e){if(!e)return[];const s=["name","protein","fat","carbs","energy","protein_fat_index"],n=["asc","desc"];return e.split(",").map(b=>{const[f,o]=b.split(":");return s.includes(f)&&n.includes(o==null?void 0:o.toLowerCase())?{field:f,direction:o.toLowerCase()}:null}).filter(b=>b!=null)}function Ve(){window.history.replaceState({},"",window.location.pathname)}function _e(e){return e===0?!1:Array.isArray(e)&&e.length===0?!0:!e}function Ze(e){return(...s)=>!e(...s)}function Xe(e,s){return e===void 0&&(e="undefined"),e===null&&(e="null"),e===!1&&(e="false"),e.toString().toLowerCase().indexOf(s.trim())!==-1}function Qe(e){return e.filter(s=>!s.$isLabel)}function Se(e,s){return n=>n.reduce((b,f)=>f[e]&&f[e].length?(b.push({$groupLabel:f[s],$isLabel:!0}),b.concat(f[e])):b,[])}const Be=(...e)=>s=>e.reduce((n,b)=>b(n),s);var et={data(){return{search:"",isOpen:!1,preferredOpenDirection:"below",optimizedHeight:this.maxHeight}},props:{internalSearch:{type:Boolean,default:!0},options:{type:Array,required:!0},multiple:{type:Boolean,default:!1},trackBy:{type:String},label:{type:String},searchable:{type:Boolean,default:!0},clearOnSelect:{type:Boolean,default:!0},hideSelected:{type:Boolean,default:!1},placeholder:{type:String,default:"Select option"},allowEmpty:{type:Boolean,default:!0},resetAfter:{type:Boolean,default:!1},closeOnSelect:{type:Boolean,default:!0},customLabel:{type:Function,default(e,s){return _e(e)?"":s?e[s]:e}},taggable:{type:Boolean,default:!1},tagPlaceholder:{type:String,default:"Press enter to create a tag"},tagPosition:{type:String,default:"top"},max:{type:[Number,Boolean],default:!1},id:{default:null},optionsLimit:{type:Number,default:1e3},groupValues:{type:String},groupLabel:{type:String},groupSelect:{type:Boolean,default:!1},blockKeys:{type:Array,default(){return[]}},preserveSearch:{type:Boolean,default:!1},preselectFirst:{type:Boolean,default:!1},preventAutofocus:{type:Boolean,default:!1},filteringSortFunc:{type:Function,default:null}},mounted(){!this.multiple&&this.max&&console.warn("[Vue-Multiselect warn]: Max prop should not be used when prop Multiple equals false."),this.preselectFirst&&!this.internalValue.length&&this.options.length&&this.select(this.filteredOptions[0])},computed:{internalValue(){return this.modelValue||this.modelValue===0?Array.isArray(this.modelValue)?this.modelValue:[this.modelValue]:[]},filteredOptions(){const e=this.search||"",s=e.toLowerCase().trim();let n=this.options.concat();return this.internalSearch?n=this.groupValues?this.filterAndFlat(n,s,this.label):this.filterOptions(n,s,this.label,this.customLabel):n=this.groupValues?Se(this.groupValues,this.groupLabel)(n):n,n=this.hideSelected?n.filter(Ze(this.isSelected)):n,this.taggable&&s.length&&!this.isExistingOption(s)&&(this.tagPosition==="bottom"?n.push({isTag:!0,label:e}):n.unshift({isTag:!0,label:e})),n.slice(0,this.optionsLimit)},valueKeys(){return this.trackBy?this.internalValue.map(e=>e[this.trackBy]):this.internalValue},optionKeys(){return(this.groupValues?this.flatAndStrip(this.options):this.options).map(s=>this.customLabel(s,this.label).toString().toLowerCase())},currentOptionLabel(){return this.multiple?this.searchable?"":this.placeholder:this.internalValue.length?this.getOptionLabel(this.internalValue[0]):this.searchable?"":this.placeholder}},watch:{internalValue:{handler(){this.resetAfter&&this.internalValue.length&&(this.search="",this.$emit("update:modelValue",this.multiple?[]:null))},deep:!0},search(){this.$emit("search-change",this.search)}},emits:["open","search-change","close","select","update:modelValue","remove","tag"],methods:{getValue(){return this.multiple?this.internalValue:this.internalValue.length===0?null:this.internalValue[0]},filterAndFlat(e,s,n){return Be(this.filterGroups(s,n,this.groupValues,this.groupLabel,this.customLabel),Se(this.groupValues,this.groupLabel))(e)},flatAndStrip(e){return Be(Se(this.groupValues,this.groupLabel),Qe)(e)},updateSearch(e){this.search=e},isExistingOption(e){return this.options?this.optionKeys.indexOf(e)>-1:!1},isSelected(e){const s=this.trackBy?e[this.trackBy]:e;return this.valueKeys.indexOf(s)>-1},isOptionDisabled(e){return!!e.$isDisabled},getOptionLabel(e){if(_e(e))return"";if(e.isTag)return e.label;if(e.$isLabel)return e.$groupLabel;const s=this.customLabel(e,this.label);return _e(s)?"":s},select(e,s){if(e.$isLabel&&this.groupSelect){this.selectGroup(e);return}if(!(this.blockKeys.indexOf(s)!==-1||this.disabled||e.$isDisabled||e.$isLabel)&&!(this.max&&this.multiple&&this.internalValue.length===this.max)&&!(s==="Tab"&&!this.pointerDirty)){if(e.isTag)this.$emit("tag",e.label,this.id),this.search="",this.closeOnSelect&&!this.multiple&&this.deactivate();else{if(this.isSelected(e)){s!=="Tab"&&this.removeElement(e);return}this.multiple?this.$emit("update:modelValue",this.internalValue.concat([e])):this.$emit("update:modelValue",e),this.$emit("select",e,this.id),this.clearOnSelect&&(this.search="")}this.closeOnSelect&&this.deactivate()}},selectGroup(e){const s=this.options.find(n=>n[this.groupLabel]===e.$groupLabel);if(s){if(this.wholeGroupSelected(s)){this.$emit("remove",s[this.groupValues],this.id);const n=this.trackBy?s[this.groupValues].map(f=>f[this.trackBy]):s[this.groupValues],b=this.internalValue.filter(f=>n.indexOf(this.trackBy?f[this.trackBy]:f)===-1);this.$emit("update:modelValue",b)}else{const n=s[this.groupValues].filter(b=>!(this.isOptionDisabled(b)||this.isSelected(b)));this.max&&n.splice(this.max-this.internalValue.length),this.$emit("select",n,this.id),this.$emit("update:modelValue",this.internalValue.concat(n))}this.closeOnSelect&&this.deactivate()}},wholeGroupSelected(e){return e[this.groupValues].every(s=>this.isSelected(s)||this.isOptionDisabled(s))},wholeGroupDisabled(e){return e[this.groupValues].every(this.isOptionDisabled)},removeElement(e,s=!0){if(this.disabled||e.$isDisabled)return;if(!this.allowEmpty&&this.internalValue.length<=1){this.deactivate();return}const n=typeof e=="object"?this.valueKeys.indexOf(e[this.trackBy]):this.valueKeys.indexOf(e);if(this.multiple){const b=this.internalValue.slice(0,n).concat(this.internalValue.slice(n+1));this.$emit("update:modelValue",b)}else this.$emit("update:modelValue",null);this.$emit("remove",e,this.id),this.closeOnSelect&&s&&this.deactivate()},removeLastElement(){this.blockKeys.indexOf("Delete")===-1&&this.search.length===0&&Array.isArray(this.internalValue)&&this.internalValue.length&&this.removeElement(this.internalValue[this.internalValue.length-1],!1)},activate(){this.isOpen||this.disabled||(this.adjustPosition(),this.groupValues&&this.pointer===0&&this.filteredOptions.length&&(this.pointer=1),this.isOpen=!0,this.searchable?(this.preserveSearch||(this.search=""),this.preventAutofocus||this.$nextTick(()=>this.$refs.search&&this.$refs.search.focus())):this.preventAutofocus||typeof this.$el<"u"&&this.$el.focus(),this.$emit("open",this.id))},deactivate(){this.isOpen&&(this.isOpen=!1,this.searchable?this.$refs.search!==null&&typeof this.$refs.search<"u"&&this.$refs.search.blur():typeof this.$el<"u"&&this.$el.blur(),this.preserveSearch||(this.search=""),this.$emit("close",this.getValue(),this.id))},toggle(){this.isOpen?this.deactivate():this.activate()},adjustPosition(){if(typeof window>"u")return;const e=this.$el.getBoundingClientRect().top,s=window.innerHeight-this.$el.getBoundingClientRect().bottom;s>this.maxHeight||s>e||this.openDirection==="below"||this.openDirection==="bottom"?(this.preferredOpenDirection="below",this.optimizedHeight=Math.min(s-40,this.maxHeight)):(this.preferredOpenDirection="above",this.optimizedHeight=Math.min(e-40,this.maxHeight))},filterOptions(e,s,n,b){return s?e.filter(f=>Xe(b(f,n),s)).sort((f,o)=>typeof this.filteringSortFunc=="function"?this.filteringSortFunc(f,o):b(f,n).length-b(o,n).length):e},filterGroups(e,s,n,b,f){return o=>o.map(i=>{if(!i[n])return console.warn("Options passed to vue-multiselect do not contain groups, despite the config."),[];const d=this.filterOptions(i[n],e,s,f);return d.length?{[b]:i[b],[n]:d}:[]})}}},tt={data(){return{pointer:0,pointerDirty:!1}},props:{showPointer:{type:Boolean,default:!0},optionHeight:{type:Number,default:40}},computed:{pointerPosition(){return this.pointer*this.optionHeight},visibleElements(){return this.optimizedHeight/this.optionHeight}},watch:{filteredOptions(){this.pointerAdjust()},isOpen(){this.pointerDirty=!1},pointer(){this.$refs.search&&this.$refs.search.setAttribute("aria-activedescendant",this.id+"-"+this.pointer.toString())}},methods:{optionHighlight(e,s){return{"multiselect__option--highlight":e===this.pointer&&this.showPointer,"multiselect__option--selected":this.isSelected(s)}},groupHighlight(e,s){if(!this.groupSelect)return["multiselect__option--disabled",{"multiselect__option--group":s.$isLabel}];const n=this.options.find(b=>b[this.groupLabel]===s.$groupLabel);return n&&!this.wholeGroupDisabled(n)?["multiselect__option--group",{"multiselect__option--highlight":e===this.pointer&&this.showPointer},{"multiselect__option--group-selected":this.wholeGroupSelected(n)}]:"multiselect__option--disabled"},addPointerElement({key:e}="Enter"){this.filteredOptions.length>0&&this.select(this.filteredOptions[this.pointer],e),this.pointerReset()},pointerForward(){var e;this.pointer<this.filteredOptions.length-1&&(this.pointer++,((e=this.$refs.list)==null?void 0:e.scrollTop)<=this.pointerPosition-(this.visibleElements-1)*this.optionHeight&&(this.$refs.list.scrollTop=this.pointerPosition-(this.visibleElements-1)*this.optionHeight),this.filteredOptions[this.pointer]&&this.filteredOptions[this.pointer].$isLabel&&!this.groupSelect&&this.pointerForward()),this.pointerDirty=!0},pointerBackward(){var e;this.pointer>0?(this.pointer--,((e=this.$refs.list)==null?void 0:e.scrollTop)>=this.pointerPosition&&(this.$refs.list.scrollTop=this.pointerPosition),this.filteredOptions[this.pointer]&&this.filteredOptions[this.pointer].$isLabel&&!this.groupSelect&&this.pointerBackward()):this.filteredOptions[this.pointer]&&this.filteredOptions[0].$isLabel&&!this.groupSelect&&this.pointerForward(),this.pointerDirty=!0},pointerReset(){this.closeOnSelect&&(this.pointer=0,this.$refs.list&&(this.$refs.list.scrollTop=0))},pointerAdjust(){this.pointer>=this.filteredOptions.length-1&&(this.pointer=this.filteredOptions.length?this.filteredOptions.length-1:0),this.filteredOptions.length>0&&this.filteredOptions[this.pointer].$isLabel&&!this.groupSelect&&this.pointerForward()},pointerSet(e){this.pointer=e,this.pointerDirty=!0}}},me={name:"vue-multiselect",mixins:[et,tt],compatConfig:{MODE:3,ATTR_ENUMERATED_COERCION:!1},props:{name:{type:String,default:""},modelValue:{type:null,default(){return[]}},selectLabel:{type:String,default:"Press enter to select"},selectGroupLabel:{type:String,default:"Press enter to select group"},selectedLabel:{type:String,default:"Selected"},deselectLabel:{type:String,default:"Press enter to remove"},deselectGroupLabel:{type:String,default:"Press enter to deselect group"},showLabels:{type:Boolean,default:!0},limit:{type:Number,default:99999},maxHeight:{type:Number,default:300},limitText:{type:Function,default:e=>`and ${e} more`},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},spellcheck:{type:Boolean,default:!1},openDirection:{type:String,default:""},showNoOptions:{type:Boolean,default:!0},showNoResults:{type:Boolean,default:!0},tabindex:{type:Number,default:0},required:{type:Boolean,default:!1},useTeleport:{type:Boolean,default:!1},contentWrapperClass:{type:[String,Array,Object],default:""}},data(){return{dropdownStyles:{},ready:!1}},computed:{hasOptionGroup(){return this.groupValues&&this.groupLabel&&this.groupSelect},isSingleLabelVisible(){return(this.singleValue||this.singleValue===0)&&(!this.isOpen||!this.searchable)&&!this.visibleValues.length},isPlaceholderVisible(){return!this.internalValue.length&&(!this.searchable||!this.isOpen)},visibleValues(){return this.multiple?this.internalValue.slice(0,this.limit):[]},singleValue(){return this.internalValue[0]},deselectLabelText(){return this.showLabels?this.deselectLabel:""},deselectGroupLabelText(){return this.showLabels?this.deselectGroupLabel:""},selectLabelText(){return this.showLabels?this.selectLabel:""},selectGroupLabelText(){return this.showLabels?this.selectGroupLabel:""},selectedLabelText(){return this.showLabels?this.selectedLabel:""},inputStyle(){return this.searchable||this.multiple&&this.modelValue&&this.modelValue.length?this.isOpen?{width:"100%"}:{width:"0",position:"absolute",padding:"0"}:""},contentStyle(){return this.options.length?{display:"inline-block"}:{display:"block"}},isAbove(){return this.openDirection==="above"||this.openDirection==="top"?!0:this.openDirection==="below"||this.openDirection==="bottom"?!1:this.preferredOpenDirection==="above"},showSearchInput(){return this.searchable&&(this.hasSingleSelectedSlot&&(this.visibleSingleValue||this.visibleSingleValue===0)?this.isOpen:!0)},isRequired(){return this.required===!1?!1:this.internalValue.length<=0}},watch:{isOpen(e){e&&(this.useTeleport?(this.ready=!1,this.$nextTick(()=>{const s=this.$el.getBoundingClientRect();this.dropdownStyles={position:"absolute",top:`${s.bottom+window.scrollY}px`,left:`${s.left+window.scrollX}px`,width:`${s.width}px`,zIndex:9999},this.ready=!0})):this.ready=!0)}}};const st=["tabindex","aria-expanded","aria-owns","aria-activedescendant"],it={ref:"tags",class:"multiselect__tags"},nt={class:"multiselect__tags-wrap"},at=["textContent"],lt=["onKeydown","onMousedown"],ot=["textContent"],rt={class:"multiselect__spinner"},dt=["name","id","spellcheck","placeholder","required","value","disabled","tabindex","aria-label","aria-controls"],ut=["id","aria-multiselectable"],ct={key:0},ft={class:"multiselect__option"},pt=["aria-selected","id","role"],ht=["onClick","onMouseenter","data-select","data-selected","data-deselect"],gt=["data-select","data-deselect","onMouseenter","onMousedown"],mt={class:"multiselect__option"},bt={class:"multiselect__option"};function vt(e,s,n,b,f,o){return u(),c("div",{tabindex:e.searchable?-1:n.tabindex,class:N([{"multiselect--active":e.isOpen,"multiselect--disabled":n.disabled,"multiselect--above":o.isAbove,"multiselect--has-options-group":o.hasOptionGroup},"multiselect"]),onFocus:s[14]||(s[14]=i=>e.activate()),onBlur:s[15]||(s[15]=i=>e.searchable?!1:e.deactivate()),onKeydown:[s[16]||(s[16]=ne(P(i=>e.pointerForward(),["self","prevent"]),["down"])),s[17]||(s[17]=ne(P(i=>e.pointerBackward(),["self","prevent"]),["up"])),s[18]||(s[18]=ne(P(i=>e.addPointerElement(i),["stop","self"]),["enter","tab"]))],onKeyup:s[19]||(s[19]=ne(i=>e.deactivate(),["esc"])),role:"combobox","aria-expanded":e.isOpen,"aria-owns":"listbox-"+e.id,"aria-activedescendant":e.isOpen&&e.pointer!==null?e.id+"-"+e.pointer:null},[G(e.$slots,"caret",{toggle:e.toggle},()=>[t("div",{onMousedown:s[0]||(s[0]=P(i=>e.toggle(),["prevent","stop"])),class:"multiselect__select"},null,32)]),G(e.$slots,"clear",{search:e.search}),t("div",it,[G(e.$slots,"selection",{search:e.search,remove:e.removeElement,values:o.visibleValues,isOpen:e.isOpen},()=>[F(t("div",nt,[(u(!0),c(Q,null,ee(o.visibleValues,(i,d)=>G(e.$slots,"tag",{option:i,search:e.search,remove:e.removeElement},()=>[(u(),c("span",{class:"multiselect__tag",key:d,onMousedown:s[1]||(s[1]=P(()=>{},["prevent"]))},[t("span",{textContent:M(e.getOptionLabel(i))},null,8,at),t("i",{tabindex:"1",onKeydown:ne(P($=>e.removeElement(i),["prevent"]),["enter"]),onMousedown:P($=>e.removeElement(i),["prevent"]),class:"multiselect__tag-icon"},null,40,lt)],32))])),256))],512),[[ae,o.visibleValues.length>0]]),e.internalValue&&e.internalValue.length>n.limit?G(e.$slots,"limit",{key:0},()=>[t("strong",{class:"multiselect__strong",textContent:M(n.limitText(e.internalValue.length-n.limit))},null,8,ot)]):V("v-if",!0)]),ue(Ee,{name:"multiselect__loading"},{default:Oe(()=>[G(e.$slots,"loading",{},()=>[F(t("div",rt,null,512),[[ae,n.loading]])])]),_:3}),e.searchable?(u(),c("input",{key:0,ref:"search",name:n.name,id:e.id,type:"text",autocomplete:"off",spellcheck:n.spellcheck,placeholder:e.placeholder,required:o.isRequired,style:ye(o.inputStyle),value:e.search,disabled:n.disabled,tabindex:n.tabindex,"aria-label":n.name+"-searchbox",onInput:s[2]||(s[2]=i=>e.updateSearch(i.target.value)),onFocus:s[3]||(s[3]=P(i=>e.activate(),["prevent"])),onBlur:s[4]||(s[4]=P(i=>e.deactivate(),["prevent"])),onKeyup:s[5]||(s[5]=ne(i=>e.deactivate(),["esc"])),onKeydown:[s[6]||(s[6]=ne(P(i=>e.pointerForward(),["prevent"]),["down"])),s[7]||(s[7]=ne(P(i=>e.pointerBackward(),["prevent"]),["up"])),s[8]||(s[8]=ne(P(i=>e.addPointerElement(i),["prevent","stop","self"]),["enter"])),s[9]||(s[9]=ne(P(i=>e.removeLastElement(),["stop"]),["delete"]))],class:"multiselect__input","aria-controls":"listbox-"+e.id},null,44,dt)):V("v-if",!0),o.isSingleLabelVisible?(u(),c("span",{key:1,class:"multiselect__single",onMousedown:s[10]||(s[10]=P((...i)=>e.toggle&&e.toggle(...i),["prevent"]))},[G(e.$slots,"singleLabel",{option:o.singleValue},()=>[S(M(e.currentOptionLabel),1)])],32)):V("v-if",!0),o.isPlaceholderVisible?(u(),c("span",{key:2,class:"multiselect__placeholder",onMousedown:s[11]||(s[11]=P((...i)=>e.toggle&&e.toggle(...i),["prevent"]))},[G(e.$slots,"placeholder",{},()=>[S(M(e.placeholder),1)])],32)):V("v-if",!0)],512),(u(),Ie(Re,{to:"body",disabled:!n.useTeleport},[ue(Ee,{name:"multiselect"},{default:Oe(()=>[e.isOpen&&f.ready?(u(),c("div",{key:0,class:N(["multiselect__content-wrapper",n.contentWrapperClass]),onFocus:s[12]||(s[12]=(...i)=>e.activate&&e.activate(...i)),tabindex:"-1",onMousedown:s[13]||(s[13]=P(()=>{},["prevent"])),style:ye([f.dropdownStyles,{maxHeight:e.optimizedHeight+"px"}]),ref:"list"},[t("ul",{class:"multiselect__content",style:ye(o.contentStyle),role:"listbox",id:"listbox-"+e.id,"aria-multiselectable":e.multiple},[G(e.$slots,"beforeList"),e.multiple&&e.max===e.internalValue.length?(u(),c("li",ct,[t("span",ft,[G(e.$slots,"maxElements",{},()=>[S("Maximum of "+M(e.max)+" options selected. First remove a selected option to select another.",1)])])])):V("v-if",!0),!e.max||e.internalValue.length<e.max?(u(!0),c(Q,{key:1},ee(e.filteredOptions,(i,d)=>(u(),c("li",{class:"multiselect__element",key:d,"aria-selected":e.isSelected(i),id:e.id+"-"+d,role:i&&(i.$isLabel||i.$isDisabled)?null:"option"},[i&&(i.$isLabel||i.$isDisabled)?V("v-if",!0):(u(),c("span",{key:0,class:N([e.optionHighlight(d,i),"multiselect__option"]),onClick:P($=>e.select(i),["stop"]),onMouseenter:P($=>e.pointerSet(d),["self"]),"data-select":i&&i.isTag?e.tagPlaceholder:o.selectLabelText,"data-selected":o.selectedLabelText,"data-deselect":o.deselectLabelText},[G(e.$slots,"option",{option:i,search:e.search,index:d},()=>[t("span",null,M(e.getOptionLabel(i)),1)])],42,ht)),i&&(i.$isLabel||i.$isDisabled)?(u(),c("span",{key:1,"data-select":e.groupSelect&&o.selectGroupLabelText,"data-deselect":e.groupSelect&&o.deselectGroupLabelText,class:N([e.groupHighlight(d,i),"multiselect__option"]),onMouseenter:P($=>e.groupSelect&&e.pointerSet(d),["self"]),onMousedown:P($=>e.selectGroup(i),["prevent"])},[G(e.$slots,"option",{option:i,search:e.search,index:d},()=>[t("span",null,M(e.getOptionLabel(i)),1)])],42,gt)):V("v-if",!0)],8,pt))),128)):V("v-if",!0),F(t("li",null,[t("span",mt,[G(e.$slots,"noResult",{search:e.search},()=>[s[20]||(s[20]=S("No elements found. Consider changing the search query."))])])],512),[[ae,n.showNoResults&&e.filteredOptions.length===0&&e.search&&!n.loading]]),F(t("li",null,[t("span",bt,[G(e.$slots,"noOptions",{},()=>[s[21]||(s[21]=S("List is empty."))])])],512),[[ae,n.showNoOptions&&(e.options.length===0||o.hasOptionGroup===!0&&e.filteredOptions.length===0)&&!e.search&&!n.loading]]),G(e.$slots,"afterList")],12,ut)],38)):V("v-if",!0)]),_:3})],8,["disabled"]))],42,st)}me.render=vt;const yt=["Aldi","Edeka","Lidl","Rewe","Netto"],Le=(e,s)=>{const n=e.__vccOpts||e;for(const[b,f]of s)n[b]=f;return n},Mt={class:"filter-bar"},wt={class:"mb-3"},$t={class:"filter-section mb-3"},xt={class:"filter-section-body"},_t={class:"d-flex flex-wrap gap-2"},St=["onClick"],kt={class:"filter-section mb-3"},Lt={class:"filter-section-body"},Ot={class:"mb-3"},Et={class:"row g-2"},Ct={class:"col-6"},Vt={class:"col-6"},Bt={class:"mb-3"},Tt={class:"row g-2"},Pt={class:"col-6"},It={class:"col-6"},Ft={class:"mb-3"},At={class:"row g-2"},Dt={class:"col-6"},Rt={class:"col-6"},Nt={class:"mb-0"},qt={class:"row g-2"},jt={class:"col-6"},Ut={class:"col-6"},Ht={class:"filter-section mb-3"},zt={key:0,class:"badge bg-primary ms-1"},Gt={class:"filter-section-body"},Kt={class:"filter-section mb-3"},Yt={key:0,class:"badge bg-primary ms-1"},Wt={class:"filter-section-body"},Jt={class:"filter-section mb-3"},Zt={key:0,class:"badge bg-primary ms-1"},Xt={class:"filter-section-body"},Qt={class:"mt-2"},es={class:"d-flex flex-wrap gap-1"},ts=["onClick"],ss={class:"filter-section"},is={class:"filter-section-body"},ns={class:"d-flex gap-2"},as=["value"],ls=["disabled","title"],os={key:0,class:"text-muted mt-1 d-block"},rs={__name:"FilterBar",props:{filters:{type:Object,required:!0},availableBrands:{type:Array,default:()=>[]},availableCategories:{type:Array,default:()=>[]},availableStores:{type:Array,default:()=>[]},sort:{type:Array,default:()=>[]}},emits:["update:filters","update:sort","reset"],setup(e,{emit:s}){const n=e,b=s,{getUniqueBrands:f,getUniqueCategories:o,getUniqueStores:i}=Fe(),d=C({search:"",brands:[],categories:[],stores:[],proteinMin:"",proteinMax:"",fatMin:"",fatMax:"",carbsMin:"",carbsMax:"",energyMin:"",energyMax:"",...n.filters}),$=C({quickFilters:!1,nutrition:!1,brands:!0,categories:!0,stores:!0,sorting:!0}),R=C(""),q=C("desc");n.sort&&n.sort.length>0&&(R.value=n.sort[0].field,q.value=n.sort[0].direction);const ie=C([...n.availableBrands]),X=C([...n.availableCategories]),a=C([...n.availableStores]),g=C(!1),y=C(!1),p=C(!1),k=[{key:"protein",label:"Protein",icon:"ti ti-meat"},{key:"fat",label:"Fat",icon:"ti ti-droplet"},{key:"carbs",label:"Carbs",icon:"ti ti-grain"},{key:"energy",label:"Energy",icon:"ti ti-flame"},{key:"protein_fat_index",label:"P/F Index",icon:"ti ti-chart-line"}],w=[{label:"High Protein",icon:"ti ti-meat",filters:{proteinMin:20}},{label:"Low Fat",icon:"ti ti-droplet-off",filters:{fatMax:5}},{label:"Low Carb",icon:"ti ti-leaf",filters:{carbsMax:10}},{label:"Low Cal",icon:"ti ti-flame-off",filters:{energyMax:100}}],L=yt;let _=null;function B(){clearTimeout(_),_=setTimeout(()=>{A()},300)}ge(()=>n.filters,x=>{d.value={search:"",brands:[],categories:[],stores:[],proteinMin:"",proteinMax:"",fatMin:"",fatMax:"",carbsMin:"",carbsMax:"",energyMin:"",energyMax:"",...x}},{deep:!0}),ge(()=>n.sort,x=>{x&&x.length>0?(R.value=x[0].field,q.value=x[0].direction):(R.value="",q.value="desc")},{deep:!0}),ge(()=>n.availableBrands,x=>{ie.value=[...x]}),ge(()=>n.availableCategories,x=>{X.value=[...x]}),ge(()=>n.availableStores,x=>{a.value=[...x]});function D(x){$.value[x]=!$.value[x]}function A(){b("update:filters",{...d.value})}function K(){R.value?b("update:sort",[{field:R.value,direction:q.value}]):b("update:sort",[])}function H(){q.value=q.value==="asc"?"desc":"asc",K()}function j(x){const l=k.find(m=>m.key===x);return l?l.label:x}function O(x){for(const[l,m]of Object.entries(x.filters))if(d.value[l]!==m&&d.value[l]!==String(m))return!1;return!0}function le(x){if(O(x))for(const l of Object.keys(x.filters))d.value[l]="";else for(const[l,m]of Object.entries(x.filters))d.value[l]=m;A()}function J(x){return!d.value.stores||d.value.stores.length===0?!1:d.value.stores.some(l=>{const m=typeof l=="object"?l.store:l;return m&&m.toLowerCase().includes(x.toLowerCase())})}function E(x){const l=a.value.filter(T=>T.store&&T.store.toLowerCase().includes(x.toLowerCase()));if(l.length===0)return;if(d.value.stores.some(T=>{const se=typeof T=="object"?T.store:T;return se&&se.toLowerCase().includes(x.toLowerCase())}))d.value.stores=d.value.stores.filter(T=>{const se=typeof T=="object"?T.store:T;return!(se&&se.toLowerCase().includes(x.toLowerCase()))});else{const T=new Set(d.value.stores.map(ce=>typeof ce=="object"?ce.id:ce)),se=l.filter(ce=>!T.has(ce.id));d.value.stores=[...d.value.stores,...se]}A()}let Y=null,W=null,te=null;async function be(x){clearTimeout(Y),Y=setTimeout(async()=>{g.value=!0;try{ie.value=await f(x)}catch(l){console.error("Error searching brands:",l)}finally{g.value=!1}},300)}async function fe(x){clearTimeout(W),W=setTimeout(async()=>{y.value=!0;try{X.value=await o(x)}catch(l){console.error("Error searching categories:",l)}finally{y.value=!1}},300)}async function ve(x){clearTimeout(te),te=setTimeout(async()=>{p.value=!0;try{a.value=await i(x)}catch(l){console.error("Error searching stores:",l)}finally{p.value=!1}},300)}return(x,l)=>(u(),c("div",Mt,[t("div",wt,[l[19]||(l[19]=t("label",{class:"form-label"},[t("i",{class:"ti ti-search me-1"}),S(" Search ")],-1)),F(t("input",{"onUpdate:modelValue":l[0]||(l[0]=m=>d.value.search=m),type:"text",class:"form-control",placeholder:"Search by name...",onInput:B},null,544),[[oe,d.value.search]])]),t("div",$t,[t("div",{class:"filter-section-header",onClick:l[1]||(l[1]=m=>D("quickFilters"))},[l[20]||(l[20]=t("span",null,[t("i",{class:"ti ti-bolt me-1"}),S(" Quick Filters ")],-1)),t("i",{class:N($.value.quickFilters?"ti ti-chevron-down":"ti ti-chevron-up")},null,2)]),F(t("div",xt,[t("div",_t,[(u(),c(Q,null,ee(w,m=>t("button",{key:m.label,class:N(["btn btn-sm",O(m)?"btn-primary":"btn-outline-secondary"]),onClick:T=>le(m)},[t("i",{class:N([m.icon,"me-1"])},null,2),S(" "+M(m.label),1)],10,St)),64))])],512),[[ae,!$.value.quickFilters]])]),t("div",kt,[t("div",{class:"filter-section-header",onClick:l[2]||(l[2]=m=>D("nutrition"))},[l[21]||(l[21]=t("span",null,[t("i",{class:"ti ti-chart-bar me-1"}),S(" Nutrition Ranges ")],-1)),t("i",{class:N($.value.nutrition?"ti ti-chevron-down":"ti ti-chevron-up")},null,2)]),F(t("div",Lt,[t("div",Ot,[l[22]||(l[22]=t("label",{class:"form-label small text-muted mb-1"},[t("i",{class:"ti ti-meat me-1"}),S("Protein (g) ")],-1)),t("div",Et,[t("div",Ct,[F(t("input",{"onUpdate:modelValue":l[3]||(l[3]=m=>d.value.proteinMin=m),type:"number",class:"form-control form-control-sm",placeholder:"Min",min:"0",onInput:B},null,544),[[oe,d.value.proteinMin]])]),t("div",Vt,[F(t("input",{"onUpdate:modelValue":l[4]||(l[4]=m=>d.value.proteinMax=m),type:"number",class:"form-control form-control-sm",placeholder:"Max",min:"0",onInput:B},null,544),[[oe,d.value.proteinMax]])])])]),t("div",Bt,[l[23]||(l[23]=t("label",{class:"form-label small text-muted mb-1"},[t("i",{class:"ti ti-droplet me-1"}),S("Fat (g) ")],-1)),t("div",Tt,[t("div",Pt,[F(t("input",{"onUpdate:modelValue":l[5]||(l[5]=m=>d.value.fatMin=m),type:"number",class:"form-control form-control-sm",placeholder:"Min",min:"0",onInput:B},null,544),[[oe,d.value.fatMin]])]),t("div",It,[F(t("input",{"onUpdate:modelValue":l[6]||(l[6]=m=>d.value.fatMax=m),type:"number",class:"form-control form-control-sm",placeholder:"Max",min:"0",onInput:B},null,544),[[oe,d.value.fatMax]])])])]),t("div",Ft,[l[24]||(l[24]=t("label",{class:"form-label small text-muted mb-1"},[t("i",{class:"ti ti-grain me-1"}),S("Carbs (g) ")],-1)),t("div",At,[t("div",Dt,[F(t("input",{"onUpdate:modelValue":l[7]||(l[7]=m=>d.value.carbsMin=m),type:"number",class:"form-control form-control-sm",placeholder:"Min",min:"0",onInput:B},null,544),[[oe,d.value.carbsMin]])]),t("div",Rt,[F(t("input",{"onUpdate:modelValue":l[8]||(l[8]=m=>d.value.carbsMax=m),type:"number",class:"form-control form-control-sm",placeholder:"Max",min:"0",onInput:B},null,544),[[oe,d.value.carbsMax]])])])]),t("div",Nt,[l[25]||(l[25]=t("label",{class:"form-label small text-muted mb-1"},[t("i",{class:"ti ti-flame me-1"}),S("Energy (kcal) ")],-1)),t("div",qt,[t("div",jt,[F(t("input",{"onUpdate:modelValue":l[9]||(l[9]=m=>d.value.energyMin=m),type:"number",class:"form-control form-control-sm",placeholder:"Min",min:"0",onInput:B},null,544),[[oe,d.value.energyMin]])]),t("div",Ut,[F(t("input",{"onUpdate:modelValue":l[10]||(l[10]=m=>d.value.energyMax=m),type:"number",class:"form-control form-control-sm",placeholder:"Max",min:"0",onInput:B},null,544),[[oe,d.value.energyMax]])])])])],512),[[ae,!$.value.nutrition]])]),t("div",Ht,[t("div",{class:"filter-section-header",onClick:l[11]||(l[11]=m=>D("brands"))},[t("span",null,[l[26]||(l[26]=t("i",{class:"ti ti-tag me-1"},null,-1)),l[27]||(l[27]=S(" Brands ",-1)),d.value.brands.length?(u(),c("span",zt,M(d.value.brands.length),1)):V("",!0)]),t("i",{class:N($.value.brands?"ti ti-chevron-down":"ti ti-chevron-up")},null,2)]),F(t("div",Gt,[ue(U(me),{modelValue:d.value.brands,"onUpdate:modelValue":[l[12]||(l[12]=m=>d.value.brands=m),A],options:ie.value,multiple:!0,searchable:!0,loading:g.value,"close-on-select":!1,"clear-on-select":!1,"internal-search":!1,label:"brand","track-by":"id",placeholder:"Select brands...",onSearchChange:be},null,8,["modelValue","options","loading"])],512),[[ae,!$.value.brands]])]),t("div",Kt,[t("div",{class:"filter-section-header",onClick:l[13]||(l[13]=m=>D("categories"))},[t("span",null,[l[28]||(l[28]=t("i",{class:"ti ti-category me-1"},null,-1)),l[29]||(l[29]=S(" Categories ",-1)),d.value.categories.length?(u(),c("span",Yt,M(d.value.categories.length),1)):V("",!0)]),t("i",{class:N($.value.categories?"ti ti-chevron-down":"ti ti-chevron-up")},null,2)]),F(t("div",Wt,[ue(U(me),{modelValue:d.value.categories,"onUpdate:modelValue":[l[14]||(l[14]=m=>d.value.categories=m),A],options:X.value,multiple:!0,searchable:!0,loading:y.value,"close-on-select":!1,"clear-on-select":!1,"internal-search":!1,label:"category","track-by":"id",placeholder:"Select categories...",onSearchChange:fe},null,8,["modelValue","options","loading"])],512),[[ae,!$.value.categories]])]),t("div",Jt,[t("div",{class:"filter-section-header",onClick:l[15]||(l[15]=m=>D("stores"))},[t("span",null,[l[30]||(l[30]=t("i",{class:"ti ti-building-store me-1"},null,-1)),l[31]||(l[31]=S(" Stores ",-1)),d.value.stores.length?(u(),c("span",Zt,M(d.value.stores.length),1)):V("",!0)]),t("i",{class:N($.value.stores?"ti ti-chevron-down":"ti ti-chevron-up")},null,2)]),F(t("div",Xt,[ue(U(me),{modelValue:d.value.stores,"onUpdate:modelValue":[l[16]||(l[16]=m=>d.value.stores=m),A],options:a.value,multiple:!0,searchable:!0,loading:p.value,"close-on-select":!1,"clear-on-select":!1,"internal-search":!1,label:"store","track-by":"id",placeholder:"Select stores...",onSearchChange:ve},null,8,["modelValue","options","loading"]),t("div",Qt,[l[32]||(l[32]=t("small",{class:"text-muted d-block mb-1"},"Quick Select",-1)),t("div",es,[(u(!0),c(Q,null,ee(U(L),m=>(u(),c("button",{key:m,class:N(["btn btn-sm",J(m)?"btn-primary":"btn-outline-secondary"]),onClick:T=>E(m)},M(m),11,ts))),128))])])],512),[[ae,!$.value.stores]])]),t("div",ss,[t("div",{class:"filter-section-header",onClick:l[17]||(l[17]=m=>D("sorting"))},[l[33]||(l[33]=t("span",null,[t("i",{class:"ti ti-arrows-sort me-1"}),S(" Sort ")],-1)),t("i",{class:N($.value.sorting?"ti ti-chevron-down":"ti ti-chevron-up")},null,2)]),F(t("div",is,[t("div",ns,[F(t("select",{"onUpdate:modelValue":l[18]||(l[18]=m=>R.value=m),class:"form-select",onChange:K},[l[34]||(l[34]=t("option",{value:""},"Default (Name)",-1)),(u(),c(Q,null,ee(k,m=>t("option",{key:m.key,value:m.key},M(m.label),9,as)),64))],544),[[Ne,R.value]]),t("button",{class:"btn btn-outline-secondary",disabled:!R.value,onClick:H,title:q.value==="asc"?"Ascending":"Descending"},[t("i",{class:N(q.value==="asc"?"ti ti-sort-ascending":"ti ti-sort-descending")},null,2)],8,ls)]),R.value?(u(),c("small",os,M(j(R.value))+": "+M(q.value==="asc"?"Low to High":"High to Low"),1)):V("",!0)],512),[[ae,!$.value.sorting]])])]))}},Te=Le(rs,[["__scopeId","data-v-a0f27f76"]]),ds={class:"loading-overlay"},us={__name:"LoadingState",props:{message:{type:String,default:"Loading..."}},setup(e){return(s,n)=>(u(),c("div",ds,[n[0]||(n[0]=t("div",{class:"spinner"},null,-1)),t("p",null,M(e.message),1)]))}},cs=Le(us,[["__scopeId","data-v-f716d3f9"]]),fs={class:"product-cards-list"},ps={key:0,class:"empty"},hs={key:1,class:"table-responsive"},gs={class:"table table-hover table-vcenter"},ms={class:"list-image-container"},bs={key:0,class:"image-wrapper"},vs=["data-id"],ys=["src","alt","onLoad","onError"],Ms={key:1,class:"list-placeholder"},ws={class:"product-name-cell"},$s={class:"product-name"},xs={key:0,class:"product-badges mt-1"},_s={class:"text-end"},Ss={key:0,class:"text-body"},ks={key:1,class:"text-muted"},Ls={class:"text-end"},Os={key:0,class:"text-body"},Es={key:1,class:"text-muted"},Cs={class:"text-end"},Vs={key:0,class:"text-body"},Bs={key:1,class:"text-muted"},Ts={class:"text-end"},Ps={key:0,class:"text-body"},Is={key:1,class:"text-muted"},Fs={class:"text-end"},As={key:0,class:"text-body"},Ds={key:1,class:"text-muted"},Rs=["href"],Ns={key:2,class:"row row-cards"},qs={class:"card"},js={class:"card-img-top img-responsive img-responsive-21x9 card-img-top-custom"},Us={key:0,class:"image-wrapper-grid"},Hs=["data-id"],zs=["src","alt","onLoad","onError"],Gs={key:1,class:"placeholder-icon"},Ks={class:"card-body"},Ys={class:"d-flex align-items-center mb-3"},Ws={class:"flex-fill"},Js=["href"],Zs={class:"card-title mb-1"},Xs={class:"row g-2 mb-3"},Qs={class:"col-6"},ei={class:"d-flex flex-column"},ti={key:0,class:"text-body values"},si={key:1,class:"text-muted"},ii={class:"col-6"},ni={class:"d-flex flex-column"},ai={key:0,class:"text-body values"},li={key:1,class:"text-muted"},oi={class:"col-4"},ri={class:"d-flex flex-column"},di={key:0,class:"text-body values"},ui={key:1,class:"text-muted"},ci={class:"col-4"},fi={class:"d-flex flex-column"},pi={key:0,class:"text-body values"},hi={key:1,class:"text-muted"},gi={class:"col-4"},mi={class:"d-flex flex-column"},bi={key:0,class:"text-body values"},vi={key:1,class:"text-muted"},yi={class:"mb-0"},Mi={key:0,class:"mb-2"},wi={class:"d-flex flex-wrap gap-1"},$i={key:1,class:"mb-2"},xi={class:"d-flex flex-wrap gap-1"},_i={key:2},Si={class:"d-flex flex-wrap gap-1"},ki={key:0,class:"card-footer"},Li=["href"],Oi={__name:"ProductCardsList",props:{products:{type:Array,default:()=>[]},viewMode:{type:String,default:"grid",validator:e=>["grid","list"].includes(e)}},setup(e){function s(f,o){const i=document.querySelector(`[data-id="${o}"]`);i&&(i.style.display="none")}function n(f,o){const i=document.querySelector(`[data-id="${o}"]`);i&&(i.style.display="none"),f.target.style.display="none";const d=f.target.closest(".image-wrapper-grid")||f.target.closest(".image-wrapper");if(d){const $=document.createElement("div");$.className="placeholder-icon",$.innerHTML='<i class="ti ti-photo-off"></i>',d.appendChild($)}}function b(f){if(!f)return[];if(Array.isArray(f))return f.map(o=>String(o).trim()).filter(Boolean).slice(0,3);if(typeof f=="string"){try{const o=JSON.parse(f);if(Array.isArray(o))return o.map(i=>String(i).trim()).filter(Boolean).slice(0,3)}catch{}return f.split(",").map(o=>o.trim()).filter(Boolean).slice(0,3)}return[]}return(f,o)=>(u(),c("div",fs,[e.products.length===0?(u(),c("div",ps,[...o[0]||(o[0]=[t("div",{class:"empty-icon"},[t("i",{class:"ti ti-package-off",style:{"font-size":"4rem"}})],-1),t("p",{class:"empty-title"},"No products found",-1),t("p",{class:"empty-subtitle text-muted"},"Try adjusting your filters",-1)])])):e.viewMode==="list"?(u(),c("div",hs,[t("table",gs,[o[4]||(o[4]=t("thead",null,[t("tr",null,[t("th",{style:{width:"50px"}}),t("th",null,"Name"),t("th",{class:"text-end",style:{width:"90px"}},"Protein"),t("th",{class:"text-end",style:{width:"90px"}},"Fat"),t("th",{class:"text-end",style:{width:"90px"}},"Carbs"),t("th",{class:"text-end",style:{width:"90px"}},"Energy"),t("th",{class:"text-end",style:{width:"90px"}},"P/F Index"),t("th",{style:{width:"60px"}})])],-1)),t("tbody",null,[(u(!0),c(Q,null,ee(e.products,i=>(u(),c("tr",{key:i.id},[t("td",null,[t("div",ms,[i.image_url?(u(),c("div",bs,[t("div",{class:"image-spinner","data-id":"list-spinner-"+i.id},[...o[1]||(o[1]=[t("span",{class:"spinner-border spinner-border-sm"},null,-1)])],8,vs),t("img",{src:i.image_url,alt:i.name,loading:"lazy",crossorigin:"anonymous",class:"list-image",onLoad:d=>s(d,"list-spinner-"+i.id),onError:d=>n(d,"list-spinner-"+i.id)},null,40,ys)])):(u(),c("div",Ms,[...o[2]||(o[2]=[t("i",{class:"ti ti-photo-off"},null,-1)])]))])]),t("td",null,[t("div",ws,[t("span",$s,M(i.name||"Unknown Product"),1),i.brands?(u(),c("div",xs,[(u(!0),c(Q,null,ee(b(i.brands).slice(0,2),(d,$)=>(u(),c("span",{key:$,class:"badge bg-blue-lt me-1"},M(d),1))),128))])):V("",!0)])]),t("td",_s,[i.protein?(u(),c("strong",Ss,M(i.protein)+"g",1)):(u(),c("span",ks,"-"))]),t("td",Ls,[i.fat?(u(),c("strong",Os,M(i.fat)+"g",1)):(u(),c("span",Es,"-"))]),t("td",Cs,[i.carbs?(u(),c("strong",Vs,M(i.carbs)+"g",1)):(u(),c("span",Bs,"-"))]),t("td",Ts,[i.energy?(u(),c("strong",Ps,M(Math.round(i.energy)),1)):(u(),c("span",Is,"-"))]),t("td",Fs,[i.protein_fat_index?(u(),c("strong",As,M(Number(i.protein_fat_index).toFixed(2)),1)):(u(),c("span",Ds,"-"))]),t("td",null,[i.url?(u(),c("a",{key:0,href:i.url,target:"_blank",rel:"noopener noreferrer",class:"btn btn-sm btn-ghost-primary"},[...o[3]||(o[3]=[t("i",{class:"ti ti-external-link"},null,-1)])],8,Rs)):V("",!0)])]))),128))])])])):(u(),c("div",Ns,[(u(!0),c(Q,null,ee(e.products,i=>(u(),c("div",{key:i.id,class:"col-12 col-md-6 col-lg-4"},[t("div",qs,[t("div",js,[i.image_url?(u(),c("div",Us,[t("div",{class:"image-spinner-grid","data-id":"grid-spinner-"+i.id},[...o[5]||(o[5]=[t("span",{class:"spinner-border text-primary"},null,-1)])],8,Hs),t("img",{src:i.image_url,alt:i.name,loading:"lazy",crossorigin:"anonymous",class:"product-image",onLoad:d=>s(d,"grid-spinner-"+i.id),onError:d=>n(d,"grid-spinner-"+i.id)},null,40,zs)])):(u(),c("div",Gs,[...o[6]||(o[6]=[t("i",{class:"ti ti-photo-off"},null,-1)])]))]),t("div",Ks,[t("div",Ys,[t("div",Ws,[t("a",{href:i.url||"#",target:"_blank",rel:"noopener noreferrer",class:"text-reset text-decoration-none"},[t("h3",Zs,M(i.name||"Unknown Product"),1)],8,Js)])]),t("div",Xs,[t("div",Qs,[t("div",ei,[o[7]||(o[7]=t("small",{class:"text-muted mb-1"},[t("i",{class:"ti ti-flame me-1"}),S("Energy ")],-1)),i.energy?(u(),c("strong",ti,M(Math.round(i.energy))+" kcal ",1)):(u(),c("span",si,"-"))])]),t("div",ii,[t("div",ni,[o[8]||(o[8]=t("small",{class:"text-muted mb-1"},[t("i",{class:"ti ti-chart-line me-1"}),S("P/F Index ")],-1)),i.protein_fat_index?(u(),c("strong",ai,M(Number(i.protein_fat_index).toFixed(2)),1)):(u(),c("span",li,"-"))])]),t("div",oi,[t("div",ri,[o[9]||(o[9]=t("small",{class:"text-muted mb-1"},"Fat",-1)),i.fat?(u(),c("strong",di,M(i.fat)+" g",1)):(u(),c("span",ui,"-"))])]),t("div",ci,[t("div",fi,[o[10]||(o[10]=t("small",{class:"text-muted mb-1"},"Carbs",-1)),i.carbs?(u(),c("strong",pi,M(i.carbs)+" g",1)):(u(),c("span",hi,"-"))])]),t("div",gi,[t("div",mi,[o[11]||(o[11]=t("small",{class:"text-muted mb-1"},"Protein",-1)),i.protein?(u(),c("strong",bi,M(i.protein)+" g",1)):(u(),c("span",vi,"-"))])])]),t("div",yi,[i.brands?(u(),c("div",Mi,[o[12]||(o[12]=t("small",{class:"text-muted d-block mb-1"},[t("i",{class:"ti ti-tag me-1"}),S("Brands ")],-1)),t("div",wi,[(u(!0),c(Q,null,ee(b(i.brands),(d,$)=>(u(),c("span",{key:$,class:"badge bg-blue-lt"},M(d),1))),128))])])):V("",!0),i.categories?(u(),c("div",$i,[o[13]||(o[13]=t("small",{class:"text-muted d-block mb-1"},[t("i",{class:"ti ti-category me-1"}),S("Categories ")],-1)),t("div",xi,[(u(!0),c(Q,null,ee(b(i.categories),(d,$)=>(u(),c("span",{key:$,class:"badge bg-green-lt"},M(d),1))),128))])])):V("",!0),i.stores?(u(),c("div",_i,[o[14]||(o[14]=t("small",{class:"text-muted d-block mb-1"},[t("i",{class:"ti ti-building-store me-1"}),S("Stores ")],-1)),t("div",Si,[(u(!0),c(Q,null,ee(b(i.stores),(d,$)=>(u(),c("span",{key:$,class:"badge bg-orange-lt"},M(d),1))),128))])])):V("",!0)])]),i.url?(u(),c("div",ki,[t("a",{href:i.url,target:"_blank",rel:"noopener noreferrer",class:"btn btn-outline-primary w-100"},[...o[15]||(o[15]=[t("i",{class:"ti ti-external-link me-1"},null,-1),S(" View ",-1)])],8,Li)])):V("",!0)])]))),128))]))]))}},Ei=Le(Oi,[["__scopeId","data-v-95aa7a05"]]),Ci={id:"app"},Vi={class:"navbar navbar-expand-md navbar-light d-print-none"},Bi={class:"container-xl"},Ti={class:"navbar-nav flex-row order-md-last"},Pi={class:"d-flex align-items-center"},Ii={class:"col-auto ms-auto d-print-none"},Fi={class:"btn-list"},Ai=["disabled"],Di={key:0,class:"ti ti-download"},Ri={key:1,class:"spinner-border spinner-border-sm me-2"},Ni={class:"d-none d-sm-inline"},qi={class:"d-sm-none"},ji=["disabled"],Ui={class:"page-wrapper"},Hi={class:"page-body"},zi={class:"container-xl"},Gi={class:"row"},Ki={class:"col-12 d-lg-none mb-3"},Yi={class:"card"},Wi={class:"card-body py-2"},Ji={class:"d-flex align-items-center justify-content-between"},Zi={key:0,class:"badge bg-white text-primary ms-1"},Xi={class:"d-flex align-items-center gap-3"},Qi={class:"text-center"},en={class:"fw-bold"},tn={class:"text-center"},sn={class:"fw-bold"},nn={class:"offcanvas-header"},an={class:"offcanvas-body"},ln={class:"d-grid gap-2 mt-3"},on={class:"col-lg-3 mb-3 d-none d-lg-block"},rn={class:"card sticky-top",style:{top:"1rem"}},dn={class:"card-body"},un={class:"row row-cards mt-3"},cn={class:"col-12"},fn={class:"card"},pn={class:"card-body"},hn={class:"h1 mb-0"},gn={class:"col-12"},mn={class:"card"},bn={class:"card-body"},vn={class:"h1 mb-0"},yn={class:"col-lg-9"},Mn={class:"card mb-3"},wn={class:"card-header flex-column flex-sm-row"},$n={class:"card-title mb-2 mb-sm-0"},xn={class:"d-none d-sm-inline"},_n={class:"d-sm-none"},Sn={class:"card-actions w-100 w-sm-auto"},kn={class:"d-flex align-items-center justify-content-between justify-content-sm-end gap-2 flex-wrap"},Ln={class:"btn-group"},On={class:"d-flex align-items-center gap-1"},En=["value"],Cn=["value"],Vn={class:"d-flex align-items-center gap-1 gap-sm-2"},Bn=["disabled"],Tn={class:"text-muted small"},Pn=["disabled"],In={class:"card-body"},ke="food-app-sort",Pe="food-app-page-size",Fn={__name:"App",setup(e){const{loading:s,loadingMessage:n,dbStats:b,loadData:f,clearDatabase:o,updateStats:i,queryProducts:d,getUniqueBrands:$,getUniqueCategories:R,getUniqueStores:q,hasData:ie}=Fe(),X=[20,50,100,200],a=C([]),g=C("grid"),y=C(!1),p=C({search:"",brands:[],categories:[],stores:[],proteinMin:"",proteinMax:"",fatMin:"",fatMax:"",carbsMin:"",carbsMax:"",energyMin:"",energyMax:""});function k(){try{const r=localStorage.getItem(ke);return r?JSON.parse(r):[]}catch(r){return console.error("Error loading saved sort:",r),[]}}function w(){try{const r=localStorage.getItem(Pe);if(r){const h=parseInt(r,10);if(X.includes(h))return h}return 50}catch(r){return console.error("Error loading saved page size:",r),50}}const L=C(k()),_=C(1),B=C(0),D=C(0),A=C(w()),K=C([]),H=C([]),j=C([]);let O=null,le=null;const J=qe(()=>{let r=0;return p.value.search&&r++,p.value.brands.length&&r++,p.value.categories.length&&r++,p.value.stores.length&&r++,(p.value.proteinMin||p.value.proteinMax)&&r++,(p.value.fatMin||p.value.fatMax)&&r++,(p.value.carbsMin||p.value.carbsMax)&&r++,(p.value.energyMin||p.value.energyMax)&&r++,L.value.length&&r++,r});async function E(){K.value=await $(),H.value=await R(),j.value=await q()}async function Y(r,h=!1){r&&(p.value={...r}),_.value=1,await te(),h||he(T(),!0)}async function W(r,h=!1){if(r){L.value=[...r];try{localStorage.setItem(ke,JSON.stringify(r))}catch(z){console.error("Error saving sort:",z)}}_.value=1,await te(),h||he(T(),!0)}async function te(){const r=await d(p.value,_.value,A.value,L.value);a.value=r.products,D.value=r.totalCount,B.value=r.totalPages}async function be(r){A.value=r,_.value=1;try{localStorage.setItem(Pe,String(r))}catch(h){console.error("Error saving page size:",h)}await te(),he(T(),!0)}function fe(){p.value={search:"",brands:[],categories:[],stores:[],proteinMin:"",proteinMax:"",fatMin:"",fatMax:"",carbsMin:"",carbsMax:"",energyMin:"",energyMax:""},L.value=[];try{localStorage.removeItem(ke)}catch(r){console.error("Error clearing saved sort:",r)}Ve(),Y(null,!0)}async function ve(){_.value<B.value&&(_.value++,await te(),he(T(),!1))}async function x(){_.value>1&&(_.value--,await te(),he(T(),!1))}async function l(){try{await f(),await E(),await Y()}catch(r){alert("Error loading data: "+r.message)}}async function m(){await o()&&(a.value=[],D.value=0,B.value=1,K.value=[],H.value=[],Ve())}function T(){return{filters:p.value,sort:L.value,page:_.value,pageSize:A.value,viewMode:g.value}}function se(r){r.brandIds&&(p.value.brands=$e(r.brandIds,K.value)),r.categoryIds&&(p.value.categories=$e(r.categoryIds,H.value)),r.storeIds&&(p.value.stores=$e(r.storeIds,j.value)),r.search!==void 0&&(p.value.search=r.search),r.proteinMin!==void 0&&r.proteinMin!==""&&(p.value.proteinMin=r.proteinMin),r.proteinMax!==void 0&&r.proteinMax!==""&&(p.value.proteinMax=r.proteinMax),r.fatMin!==void 0&&r.fatMin!==""&&(p.value.fatMin=r.fatMin),r.fatMax!==void 0&&r.fatMax!==""&&(p.value.fatMax=r.fatMax),r.carbsMin!==void 0&&r.carbsMin!==""&&(p.value.carbsMin=r.carbsMin),r.carbsMax!==void 0&&r.carbsMax!==""&&(p.value.carbsMax=r.carbsMax),r.energyMin!==void 0&&r.energyMin!==""&&(p.value.energyMin=r.energyMin),r.energyMax!==void 0&&r.energyMax!==""&&(p.value.energyMax=r.energyMax),r.sort&&r.sort.length>0&&(L.value=r.sort),r.page&&(_.value=r.page),r.pageSize&&X.includes(r.pageSize)&&(A.value=r.pageSize),r.viewMode&&(g.value=r.viewMode)}async function ce(r){se(r),await te()}async function De(){if(Ke()&&(O=Ae()),await i(),await ie())await E(),O&&(se(O),O=null),await te();else try{await f(),await E(),O?(se(O),O=null,await te()):await Y(null,!0)}catch{console.log("No cached database found, waiting for user to load")}le=We(ce)}return ge(g,()=>{he(T(),!0)}),je(()=>{De()}),Ue(()=>{le&&le()}),(r,h)=>(u(),c("div",Ci,[U(s)?(u(),Ie(cs,{key:0,message:U(n)},null,8,["message"])):V("",!0),t("header",Vi,[t("div",Bi,[h[10]||(h[10]=Ce('<h1 class="navbar-brand navbar-brand-autodark d-none-navbar-horizontal pe-0 pe-md-3"><a href="#"><span class="navbar-brand-image"></span><span class="d-none d-sm-inline">OpenFoodFacts Germany</span><span class="d-sm-none">OpenFoodFacts Germany</span></a></h1>',1)),t("div",Ti,[t("div",Pi,[t("div",Ii,[t("div",Fi,[t("button",{class:"btn btn-primary",onClick:l,disabled:U(s)},[U(s)?V("",!0):(u(),c("i",Di)),U(s)?(u(),c("span",Ri)):V("",!0),t("span",Ni,M(U(s)?U(n):"Load Database"),1),t("span",qi,M(U(s)?"Loading...":"Load"),1)],8,Ai),U(b).count>0?(u(),c("button",{key:0,class:"btn btn-outline-danger",onClick:m,disabled:U(s)},[...h[9]||(h[9]=[t("i",{class:"ti ti-trash"},null,-1),t("span",{class:"d-none d-sm-inline"},"Clear Data",-1)])],8,ji)):V("",!0)])])])])])]),t("div",Ui,[t("div",Hi,[t("div",zi,[t("div",Gi,[t("div",Ki,[t("div",Yi,[t("div",Wi,[t("div",Ji,[t("button",{class:"btn btn-primary",onClick:h[0]||(h[0]=z=>y.value=!0)},[h[11]||(h[11]=t("i",{class:"ti ti-filter me-1"},null,-1)),h[12]||(h[12]=S(" Filters ",-1)),J.value>0?(u(),c("span",Zi,M(J.value),1)):V("",!0)]),t("div",Xi,[t("div",Qi,[h[13]||(h[13]=t("div",{class:"text-muted small"},"Total",-1)),t("div",en,M(U(b).count.toLocaleString()),1)]),t("div",tn,[h[14]||(h[14]=t("div",{class:"text-muted small"},"Filtered",-1)),t("div",sn,M(D.value.toLocaleString()),1)])])])])])]),t("div",{class:N(["offcanvas offcanvas-start",{show:y.value}]),tabindex:"-1",onClick:h[4]||(h[4]=P(z=>y.value=!1,["self"]))},[t("div",nn,[h[15]||(h[15]=t("h5",{class:"offcanvas-title"},[t("i",{class:"ti ti-filter me-2"}),S(" Filters ")],-1)),t("button",{type:"button",class:"btn-close",onClick:h[1]||(h[1]=z=>y.value=!1)})]),t("div",an,[ue(Te,{filters:p.value,sort:L.value,"available-brands":K.value,"available-categories":H.value,"available-stores":j.value,"onUpdate:filters":Y,"onUpdate:sort":W,onReset:fe},null,8,["filters","sort","available-brands","available-categories","available-stores"]),t("div",ln,[t("button",{class:"btn btn-primary",onClick:h[2]||(h[2]=z=>y.value=!1)},[...h[16]||(h[16]=[t("i",{class:"ti ti-check me-1"},null,-1),S(" Apply Filters ",-1)])]),t("button",{class:"btn btn-outline-secondary",onClick:h[3]||(h[3]=z=>{fe(),y.value=!1})},[...h[17]||(h[17]=[t("i",{class:"ti ti-refresh me-1"},null,-1),S(" Reset All ",-1)])])])])],2),y.value?(u(),c("div",{key:0,class:"offcanvas-backdrop fade show",onClick:h[5]||(h[5]=z=>y.value=!1)})):V("",!0),t("div",on,[t("div",rn,[t("div",{class:"card-header"},[h[19]||(h[19]=t("h3",{class:"card-title"},[t("i",{class:"ti ti-filter me-2"}),S(" Filters ")],-1)),t("div",{class:"card-actions"},[t("button",{class:"btn btn-outline",onClick:fe},[...h[18]||(h[18]=[t("i",{class:"ti ti-refresh"},null,-1),S(" Reset ",-1)])])])]),t("div",dn,[ue(Te,{filters:p.value,sort:L.value,"available-brands":K.value,"available-categories":H.value,"available-stores":j.value,"onUpdate:filters":Y,"onUpdate:sort":W,onReset:fe},null,8,["filters","sort","available-brands","available-categories","available-stores"])])]),t("div",un,[t("div",cn,[t("div",fn,[t("div",pn,[h[20]||(h[20]=t("div",{class:"subheader"},"Total Products",-1)),t("div",hn,M(U(b).count.toLocaleString()),1)])])]),t("div",gn,[t("div",mn,[t("div",bn,[h[21]||(h[21]=t("div",{class:"subheader"},"Filtered Results",-1)),t("div",vn,M(D.value.toLocaleString()),1)])])])])]),t("div",yn,[t("div",Mn,[t("div",wn,[t("h3",$n,[t("span",xn,"Products ("+M(a.value.length)+" of "+M(D.value.toLocaleString())+")",1),t("span",_n,M(D.value.toLocaleString())+" Products",1)]),t("div",Sn,[t("div",kn,[t("div",Ln,[t("button",{class:N(["btn btn-sm",g.value==="grid"?"btn-primary":"btn-outline-secondary"]),onClick:h[6]||(h[6]=z=>g.value="grid"),title:"Grid View"},[...h[22]||(h[22]=[t("i",{class:"ti ti-grid-dots"},null,-1)])],2),t("button",{class:N(["btn btn-sm",g.value==="list"?"btn-primary":"btn-outline-secondary"]),onClick:h[7]||(h[7]=z=>g.value="list"),title:"List View"},[...h[23]||(h[23]=[t("i",{class:"ti ti-list"},null,-1)])],2)]),t("div",On,[t("select",{class:"form-select form-select-sm",value:A.value,onChange:h[8]||(h[8]=z=>be(Number(z.target.value))),style:{width:"auto"}},[(u(),c(Q,null,ee(X,z=>t("option",{key:z,value:z},M(z),9,Cn)),64))],40,En),h[24]||(h[24]=t("span",{class:"text-muted small d-none d-sm-inline"},"per page",-1))]),t("div",Vn,[t("button",{class:"btn btn-sm btn-outline-primary",onClick:x,disabled:_.value===1},[...h[25]||(h[25]=[t("i",{class:"ti ti-chevron-left"},null,-1),t("span",{class:"d-none d-md-inline"},"Previous",-1)])],8,Bn),t("span",Tn,M(_.value)+"/"+M(B.value),1),t("button",{class:"btn btn-sm btn-outline-primary",onClick:ve,disabled:_.value>=B.value},[...h[26]||(h[26]=[t("span",{class:"d-none d-md-inline"},"Next",-1),t("i",{class:"ti ti-chevron-right"},null,-1)])],8,Pn)])])])]),t("div",In,[ue(Ei,{products:a.value,"view-mode":g.value},null,8,["products","view-mode"])])])])])])]),h[27]||(h[27]=Ce('<footer class="footer footer-transparent d-print-none"><div class="container-xl"><div class="row text-center align-items-center"><div class="col-12 col-lg-auto mt-3 mt-lg-0"><ul class="list-inline list-inline-dots mb-0"><li class="list-inline-item"> Powered by OpenFoodFacts data </li><li class="list-inline-item"><a href="https://github.com/mkoziy/food" target="_blank" rel="noopener noreferrer" class="link-muted align-items-center"><svg xmlns="http://www.w3.org/2000/svg" class="me-1" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 .5C5.7.5.9 5.3.9 11.6c0 4.7 3 8.7 7.2 10.1.5.1.7-.2.7-.5v-1.9c-2.9.6-3.5-1.4-3.5-1.4-.5-1.2-1.2-1.6-1.2-1.6-1-.7.1-.7.1-.7 1.1.1 1.7 1.1 1.7 1.1 1 .1 1.6.7 1.9 1.2.1-.8.4-1.4.8-1.8-2.3-.3-4.7-1.2-4.7-5.3 0-1.2.4-2.1 1.1-2.8-.1-.3-.5-1.5.1-3.1 0 0 .9-.3 3 .1.9-.3 1.8-.4 2.7-.4s1.8.1 2.7.4c2.1-.4 3-.1 3-.1.6 1.6.2 2.8.1 3.1.7.7 1.1 1.6 1.1 2.8 0 4.1-2.4 5-4.7 5.3.4.3.8 1.1.8 2.2v3.2c0 .3.2.6.7.5 4.2-1.4 7.2-5.4 7.2-10.1C23.1 5.3 18.3.5 12 .5z"></path></svg> Source on GitHub </a></li></ul></div></div></div></footer>',1))])]))}};He(Fn).mount("#app");
