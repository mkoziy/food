import{r as C,c,o as u,a as D,b as t,d as ge,e as W,f as V,w as ce,g as ee,v as se,T as he,h as I,i as E,n as ie,j as Y,k as O,t as _,F as H,l as j,m as be,p as Q,q as ve,u as P,s as ye,x as we,y as Se}from"./vue-BTWk32xT.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))f(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&f(a)}).observe(document,{childList:!0,subtree:!0});function i(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function f(l){if(l.ep)return;l.ep=!0;const r=i(l);fetch(l.href,r)}})();const $e="modulepreload",_e=function(e){return"/"+e},pe={},Oe=function(s,i,f){let l=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),d=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));l=Promise.allSettled(i.map(S=>{if(S=_e(S),S in pe)return;pe[S]=!0;const x=S.endsWith(".css"),q=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${S}"]${q}`))return;const B=document.createElement("link");if(B.rel=x?"stylesheet":$e,x||(B.as="script"),B.crossOrigin="",B.href=S,d&&B.setAttribute("nonce",d),document.head.appendChild(B),x)return new Promise((M,n)=>{B.addEventListener("load",M),B.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${S}`)))})}))}function r(a){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=a,window.dispatchEvent(d),!d.defaultPrevented)throw a}return l.then(a=>{for(const d of a||[])d.status==="rejected"&&r(d.reason);return s().catch(r)})};let k=null,A=null;const ae=C(!1),N=C(""),Z=C({count:0}),Le="food-database-cache",Ee=1,re="database-data";function me(){async function e(){if(A)return A;try{return A=await(await Oe(()=>import("/sqlite-wasm/sqlite3.mjs"),[]).then(p=>p.default))({print:console.log,printErr:console.error,locateFile:p=>`/sqlite-wasm/${p}`}),console.log("SQLite wasm initialized:",A.version.libVersion),A}catch(n){throw console.error("Failed to initialize SQLite:",n),n}}async function s(){return new Promise((n,p)=>{const b=indexedDB.open(Le,Ee);b.onerror=()=>p(b.error),b.onsuccess=()=>n(b.result),b.onupgradeneeded=v=>{const $=v.target.result;$.objectStoreNames.contains("databases")||$.createObjectStore("databases")}})}async function i(){try{const n=await s();return new Promise((p,b)=>{const y=n.transaction(["databases"],"readonly").objectStore("databases").get(re);y.onerror=()=>b(y.error),y.onsuccess=()=>p(y.result)})}catch(n){return console.error("Error getting cached database:",n),null}}async function f(n){try{const p=await s();return new Promise((b,v)=>{const L=p.transaction(["databases"],"readwrite").objectStore("databases").put(n,re);L.onerror=()=>v(L.error),L.onsuccess=()=>b(!0)})}catch(p){return console.error("Error caching database:",p),!1}}async function l(){try{const n=await s();return new Promise((p,b)=>{const y=n.transaction(["databases"],"readwrite").objectStore("databases").delete(re);y.onerror=()=>b(y.error),y.onsuccess=()=>p(!0)})}catch(n){return console.error("Error clearing cache:",n),!1}}async function r(){ae.value=!0,N.value="Initializing database...";try{await e(),N.value="Checking cache...";const n=await i();let p;if(n)console.log("Loading database from cache"),N.value="Loading from cache...",p=new Uint8Array(n);else{console.log("Downloading database from server"),N.value="Downloading database...";const y=await fetch("/data.sqlite");if(!y.ok)throw new Error(`Failed to fetch database: ${y.statusText}`);const L=await y.arrayBuffer();p=new Uint8Array(L),N.value="Caching database...",await f(L),console.log("Database cached successfully")}N.value="Loading database...",k&&(k.close(),k=null),k=new A.oo1.DB(":memory:");const b=A.wasm.alloc(p.length),v=1024*1024;for(let y=0;y<p.length;y+=v){const L=Math.min(y+v,p.length),T=p.slice(y,L);A.wasm.heap8().set(T,b+y)}const $=A.capi.sqlite3_deserialize(k.pointer,"main",b,p.length,p.length,A.capi.SQLITE_DESERIALIZE_FREEONCLOSE|A.capi.SQLITE_DESERIALIZE_RESIZEABLE);if($!==0)throw A.wasm.dealloc(b),new Error(`Failed to deserialize database: ${A.capi.sqlite3_errstr($)}`);return console.log("Database loaded successfully"),await a(),!0}catch(n){throw console.error("Error loading database:",n),n}finally{ae.value=!1,N.value=""}}async function a(){if(!k){Z.value={count:0};return}try{const n=k.exec({sql:"SELECT COUNT(*) as count FROM food",returnValue:"resultRows",rowMode:"object"});n&&n.length>0&&(Z.value={count:n[0].count})}catch(n){console.error("Error updating stats:",n),Z.value={count:0}}}async function d(n,p=1,b=21,v=null){if(!k)return{products:[],totalCount:0,totalPages:0};try{const $=(p-1)*b,y={};let L="FROM food f";const T=[];if(n.search&&n.search.trim()&&(L=`
                    FROM food_fts fts
                    JOIN food f ON f.id = fts.rowid
                `,T.push("food_fts MATCH :search"),y[":search"]=n.search.trim()+"*"),n.brands&&n.brands.length>0){const g=n.brands.map(o=>typeof o=="object"?o.id:o).map((o,m)=>{const h=`:brand${m}`;return y[h]=o,h}).join(",");T.push(`f.id IN (
                    SELECT food_id FROM brand_food
                    WHERE brand_id IN (${g})
                )`)}if(n.categories&&n.categories.length>0){const g=n.categories.map(o=>typeof o=="object"?o.id:o).map((o,m)=>{const h=`:category${m}`;return y[h]=o,h}).join(",");T.push(`f.id IN (
                    SELECT food_id FROM category_food
                    WHERE category_id IN (${g})
                )`)}if(n.stores&&n.stores.length>0){const g=n.stores.map(o=>typeof o=="object"?o.id:o).map((o,m)=>{const h=`:store${m}`;return y[h]=o,h}).join(",");T.push(`f.id IN (
                    SELECT food_id FROM store_food
                    WHERE store_id IN (${g})
                )`)}const U=T.length>0?`WHERE ${T.join(" AND ")}`:"",G=`
                SELECT COUNT(*) as count
                ${L}
                ${U}
            `,F=k.exec({sql:G,bind:y,returnValue:"resultRows",rowMode:"object"}),z=F&&F.length>0?F[0].count:0;let R;v&&Array.isArray(v)&&v.length>0?R=`ORDER BY ${v.map(g=>{const o=g.direction.toUpperCase();return`f.${g.field} ${o} NULLS LAST`}).join(", ")}`:n.search&&n.search.trim()?R="ORDER BY fts.rank":R="ORDER BY f.name";const J=`
                SELECT
                    f.id,
                    f.name,
                    f.url,
                    f.image_url,
                    f.brands,
                    f.categories,
                    f.stores,
                    f.fat,
                    f.protein,
                    f.carbs,
                    f.energy,
                    f.protein_fat_index
                ${L}
                ${U}
                ${R}
                LIMIT :limit OFFSET :offset
            `;return{products:k.exec({sql:J,bind:{...y,":limit":b,":offset":$},returnValue:"resultRows",rowMode:"object"})||[],totalCount:z,totalPages:Math.ceil(z/b)}}catch($){return console.error("Error querying products:",$),{products:[],totalCount:0,totalPages:0}}}async function S(n=""){if(!k)return[];try{let p,b={};n&&n.trim()?(p=`
                    SELECT rowid as id, brand
                    FROM brands_fts
                    WHERE brand MATCH :search
                    ORDER BY rank
                    LIMIT 100
                `,b[":search"]=n.trim()+"*"):p=`
                    SELECT id, brand
                    FROM brands
                    ORDER BY brand ASC
                    LIMIT 100
                `;const v=k.exec({sql:p,bind:b,returnValue:"resultRows",rowMode:"object"});return v?v.filter($=>$.brand):[]}catch(p){return console.error("Error getting unique brands:",p),[]}}async function x(n=""){if(!k)return[];try{let p,b={};n&&n.trim()?(p=`
                    SELECT rowid as id, category
                    FROM categories_fts
                    WHERE category MATCH :search
                    ORDER BY rank
                    LIMIT 100
                `,b[":search"]=n.trim()+"*"):p=`
                    SELECT id, category
                    FROM categories
                    ORDER BY category ASC
                    LIMIT 100
                `;const v=k.exec({sql:p,bind:b,returnValue:"resultRows",rowMode:"object"});return v?v.filter($=>$.category):[]}catch(p){return console.error("Error getting unique categories:",p),[]}}async function q(n=""){if(!k)return[];try{let p,b={};n&&n.trim()?(p=`
                    SELECT rowid as id, store
                    FROM stores_fts
                    WHERE store MATCH :search
                    ORDER BY rank
                    LIMIT 100
                `,b[":search"]=n.trim()+"*"):p=`
                    SELECT id, store
                    FROM stores
                    ORDER BY store ASC
                `;const v=k.exec({sql:p,bind:b,returnValue:"resultRows",rowMode:"object"});return v?v.filter($=>$.store):[]}catch(p){return console.error("Error getting unique stores:",p),[]}}async function B(){return k!==null&&Z.value.count>0}async function M(){return k&&(k.close(),k=null,Z.value={count:0}),await l(),console.log("Database and cache cleared"),!0}return{loading:ae,loadingMessage:N,dbStats:Z,loadData:r,clearDatabase:M,clearDatabaseCache:l,updateStats:a,queryProducts:d,getUniqueBrands:S,getUniqueCategories:x,getUniqueStores:q,hasData:B}}function oe(e){return e===0?!1:Array.isArray(e)&&e.length===0?!0:!e}function ke(e){return(...s)=>!e(...s)}function Ce(e,s){return e===void 0&&(e="undefined"),e===null&&(e="null"),e===!1&&(e="false"),e.toString().toLowerCase().indexOf(s.trim())!==-1}function Ve(e){return e.filter(s=>!s.$isLabel)}function ne(e,s){return i=>i.reduce((f,l)=>l[e]&&l[e].length?(f.push({$groupLabel:l[s],$isLabel:!0}),f.concat(l[e])):f,[])}const fe=(...e)=>s=>e.reduce((i,f)=>f(i),s);var Be={data(){return{search:"",isOpen:!1,preferredOpenDirection:"below",optimizedHeight:this.maxHeight}},props:{internalSearch:{type:Boolean,default:!0},options:{type:Array,required:!0},multiple:{type:Boolean,default:!1},trackBy:{type:String},label:{type:String},searchable:{type:Boolean,default:!0},clearOnSelect:{type:Boolean,default:!0},hideSelected:{type:Boolean,default:!1},placeholder:{type:String,default:"Select option"},allowEmpty:{type:Boolean,default:!0},resetAfter:{type:Boolean,default:!1},closeOnSelect:{type:Boolean,default:!0},customLabel:{type:Function,default(e,s){return oe(e)?"":s?e[s]:e}},taggable:{type:Boolean,default:!1},tagPlaceholder:{type:String,default:"Press enter to create a tag"},tagPosition:{type:String,default:"top"},max:{type:[Number,Boolean],default:!1},id:{default:null},optionsLimit:{type:Number,default:1e3},groupValues:{type:String},groupLabel:{type:String},groupSelect:{type:Boolean,default:!1},blockKeys:{type:Array,default(){return[]}},preserveSearch:{type:Boolean,default:!1},preselectFirst:{type:Boolean,default:!1},preventAutofocus:{type:Boolean,default:!1},filteringSortFunc:{type:Function,default:null}},mounted(){!this.multiple&&this.max&&console.warn("[Vue-Multiselect warn]: Max prop should not be used when prop Multiple equals false."),this.preselectFirst&&!this.internalValue.length&&this.options.length&&this.select(this.filteredOptions[0])},computed:{internalValue(){return this.modelValue||this.modelValue===0?Array.isArray(this.modelValue)?this.modelValue:[this.modelValue]:[]},filteredOptions(){const e=this.search||"",s=e.toLowerCase().trim();let i=this.options.concat();return this.internalSearch?i=this.groupValues?this.filterAndFlat(i,s,this.label):this.filterOptions(i,s,this.label,this.customLabel):i=this.groupValues?ne(this.groupValues,this.groupLabel)(i):i,i=this.hideSelected?i.filter(ke(this.isSelected)):i,this.taggable&&s.length&&!this.isExistingOption(s)&&(this.tagPosition==="bottom"?i.push({isTag:!0,label:e}):i.unshift({isTag:!0,label:e})),i.slice(0,this.optionsLimit)},valueKeys(){return this.trackBy?this.internalValue.map(e=>e[this.trackBy]):this.internalValue},optionKeys(){return(this.groupValues?this.flatAndStrip(this.options):this.options).map(s=>this.customLabel(s,this.label).toString().toLowerCase())},currentOptionLabel(){return this.multiple?this.searchable?"":this.placeholder:this.internalValue.length?this.getOptionLabel(this.internalValue[0]):this.searchable?"":this.placeholder}},watch:{internalValue:{handler(){this.resetAfter&&this.internalValue.length&&(this.search="",this.$emit("update:modelValue",this.multiple?[]:null))},deep:!0},search(){this.$emit("search-change",this.search)}},emits:["open","search-change","close","select","update:modelValue","remove","tag"],methods:{getValue(){return this.multiple?this.internalValue:this.internalValue.length===0?null:this.internalValue[0]},filterAndFlat(e,s,i){return fe(this.filterGroups(s,i,this.groupValues,this.groupLabel,this.customLabel),ne(this.groupValues,this.groupLabel))(e)},flatAndStrip(e){return fe(ne(this.groupValues,this.groupLabel),Ve)(e)},updateSearch(e){this.search=e},isExistingOption(e){return this.options?this.optionKeys.indexOf(e)>-1:!1},isSelected(e){const s=this.trackBy?e[this.trackBy]:e;return this.valueKeys.indexOf(s)>-1},isOptionDisabled(e){return!!e.$isDisabled},getOptionLabel(e){if(oe(e))return"";if(e.isTag)return e.label;if(e.$isLabel)return e.$groupLabel;const s=this.customLabel(e,this.label);return oe(s)?"":s},select(e,s){if(e.$isLabel&&this.groupSelect){this.selectGroup(e);return}if(!(this.blockKeys.indexOf(s)!==-1||this.disabled||e.$isDisabled||e.$isLabel)&&!(this.max&&this.multiple&&this.internalValue.length===this.max)&&!(s==="Tab"&&!this.pointerDirty)){if(e.isTag)this.$emit("tag",e.label,this.id),this.search="",this.closeOnSelect&&!this.multiple&&this.deactivate();else{if(this.isSelected(e)){s!=="Tab"&&this.removeElement(e);return}this.multiple?this.$emit("update:modelValue",this.internalValue.concat([e])):this.$emit("update:modelValue",e),this.$emit("select",e,this.id),this.clearOnSelect&&(this.search="")}this.closeOnSelect&&this.deactivate()}},selectGroup(e){const s=this.options.find(i=>i[this.groupLabel]===e.$groupLabel);if(s){if(this.wholeGroupSelected(s)){this.$emit("remove",s[this.groupValues],this.id);const i=this.trackBy?s[this.groupValues].map(l=>l[this.trackBy]):s[this.groupValues],f=this.internalValue.filter(l=>i.indexOf(this.trackBy?l[this.trackBy]:l)===-1);this.$emit("update:modelValue",f)}else{const i=s[this.groupValues].filter(f=>!(this.isOptionDisabled(f)||this.isSelected(f)));this.max&&i.splice(this.max-this.internalValue.length),this.$emit("select",i,this.id),this.$emit("update:modelValue",this.internalValue.concat(i))}this.closeOnSelect&&this.deactivate()}},wholeGroupSelected(e){return e[this.groupValues].every(s=>this.isSelected(s)||this.isOptionDisabled(s))},wholeGroupDisabled(e){return e[this.groupValues].every(this.isOptionDisabled)},removeElement(e,s=!0){if(this.disabled||e.$isDisabled)return;if(!this.allowEmpty&&this.internalValue.length<=1){this.deactivate();return}const i=typeof e=="object"?this.valueKeys.indexOf(e[this.trackBy]):this.valueKeys.indexOf(e);if(this.multiple){const f=this.internalValue.slice(0,i).concat(this.internalValue.slice(i+1));this.$emit("update:modelValue",f)}else this.$emit("update:modelValue",null);this.$emit("remove",e,this.id),this.closeOnSelect&&s&&this.deactivate()},removeLastElement(){this.blockKeys.indexOf("Delete")===-1&&this.search.length===0&&Array.isArray(this.internalValue)&&this.internalValue.length&&this.removeElement(this.internalValue[this.internalValue.length-1],!1)},activate(){this.isOpen||this.disabled||(this.adjustPosition(),this.groupValues&&this.pointer===0&&this.filteredOptions.length&&(this.pointer=1),this.isOpen=!0,this.searchable?(this.preserveSearch||(this.search=""),this.preventAutofocus||this.$nextTick(()=>this.$refs.search&&this.$refs.search.focus())):this.preventAutofocus||typeof this.$el<"u"&&this.$el.focus(),this.$emit("open",this.id))},deactivate(){this.isOpen&&(this.isOpen=!1,this.searchable?this.$refs.search!==null&&typeof this.$refs.search<"u"&&this.$refs.search.blur():typeof this.$el<"u"&&this.$el.blur(),this.preserveSearch||(this.search=""),this.$emit("close",this.getValue(),this.id))},toggle(){this.isOpen?this.deactivate():this.activate()},adjustPosition(){if(typeof window>"u")return;const e=this.$el.getBoundingClientRect().top,s=window.innerHeight-this.$el.getBoundingClientRect().bottom;s>this.maxHeight||s>e||this.openDirection==="below"||this.openDirection==="bottom"?(this.preferredOpenDirection="below",this.optimizedHeight=Math.min(s-40,this.maxHeight)):(this.preferredOpenDirection="above",this.optimizedHeight=Math.min(e-40,this.maxHeight))},filterOptions(e,s,i,f){return s?e.filter(l=>Ce(f(l,i),s)).sort((l,r)=>typeof this.filteringSortFunc=="function"?this.filteringSortFunc(l,r):f(l,i).length-f(r,i).length):e},filterGroups(e,s,i,f,l){return r=>r.map(a=>{if(!a[i])return console.warn("Options passed to vue-multiselect do not contain groups, despite the config."),[];const d=this.filterOptions(a[i],e,s,l);return d.length?{[f]:a[f],[i]:d}:[]})}}},Te={data(){return{pointer:0,pointerDirty:!1}},props:{showPointer:{type:Boolean,default:!0},optionHeight:{type:Number,default:40}},computed:{pointerPosition(){return this.pointer*this.optionHeight},visibleElements(){return this.optimizedHeight/this.optionHeight}},watch:{filteredOptions(){this.pointerAdjust()},isOpen(){this.pointerDirty=!1},pointer(){this.$refs.search&&this.$refs.search.setAttribute("aria-activedescendant",this.id+"-"+this.pointer.toString())}},methods:{optionHighlight(e,s){return{"multiselect__option--highlight":e===this.pointer&&this.showPointer,"multiselect__option--selected":this.isSelected(s)}},groupHighlight(e,s){if(!this.groupSelect)return["multiselect__option--disabled",{"multiselect__option--group":s.$isLabel}];const i=this.options.find(f=>f[this.groupLabel]===s.$groupLabel);return i&&!this.wholeGroupDisabled(i)?["multiselect__option--group",{"multiselect__option--highlight":e===this.pointer&&this.showPointer},{"multiselect__option--group-selected":this.wholeGroupSelected(i)}]:"multiselect__option--disabled"},addPointerElement({key:e}="Enter"){this.filteredOptions.length>0&&this.select(this.filteredOptions[this.pointer],e),this.pointerReset()},pointerForward(){var e;this.pointer<this.filteredOptions.length-1&&(this.pointer++,((e=this.$refs.list)==null?void 0:e.scrollTop)<=this.pointerPosition-(this.visibleElements-1)*this.optionHeight&&(this.$refs.list.scrollTop=this.pointerPosition-(this.visibleElements-1)*this.optionHeight),this.filteredOptions[this.pointer]&&this.filteredOptions[this.pointer].$isLabel&&!this.groupSelect&&this.pointerForward()),this.pointerDirty=!0},pointerBackward(){var e;this.pointer>0?(this.pointer--,((e=this.$refs.list)==null?void 0:e.scrollTop)>=this.pointerPosition&&(this.$refs.list.scrollTop=this.pointerPosition),this.filteredOptions[this.pointer]&&this.filteredOptions[this.pointer].$isLabel&&!this.groupSelect&&this.pointerBackward()):this.filteredOptions[this.pointer]&&this.filteredOptions[0].$isLabel&&!this.groupSelect&&this.pointerForward(),this.pointerDirty=!0},pointerReset(){this.closeOnSelect&&(this.pointer=0,this.$refs.list&&(this.$refs.list.scrollTop=0))},pointerAdjust(){this.pointer>=this.filteredOptions.length-1&&(this.pointer=this.filteredOptions.length?this.filteredOptions.length-1:0),this.filteredOptions.length>0&&this.filteredOptions[this.pointer].$isLabel&&!this.groupSelect&&this.pointerForward()},pointerSet(e){this.pointer=e,this.pointerDirty=!0}}},le={name:"vue-multiselect",mixins:[Be,Te],compatConfig:{MODE:3,ATTR_ENUMERATED_COERCION:!1},props:{name:{type:String,default:""},modelValue:{type:null,default(){return[]}},selectLabel:{type:String,default:"Press enter to select"},selectGroupLabel:{type:String,default:"Press enter to select group"},selectedLabel:{type:String,default:"Selected"},deselectLabel:{type:String,default:"Press enter to remove"},deselectGroupLabel:{type:String,default:"Press enter to deselect group"},showLabels:{type:Boolean,default:!0},limit:{type:Number,default:99999},maxHeight:{type:Number,default:300},limitText:{type:Function,default:e=>`and ${e} more`},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},spellcheck:{type:Boolean,default:!1},openDirection:{type:String,default:""},showNoOptions:{type:Boolean,default:!0},showNoResults:{type:Boolean,default:!0},tabindex:{type:Number,default:0},required:{type:Boolean,default:!1},useTeleport:{type:Boolean,default:!1},contentWrapperClass:{type:[String,Array,Object],default:""}},data(){return{dropdownStyles:{},ready:!1}},computed:{hasOptionGroup(){return this.groupValues&&this.groupLabel&&this.groupSelect},isSingleLabelVisible(){return(this.singleValue||this.singleValue===0)&&(!this.isOpen||!this.searchable)&&!this.visibleValues.length},isPlaceholderVisible(){return!this.internalValue.length&&(!this.searchable||!this.isOpen)},visibleValues(){return this.multiple?this.internalValue.slice(0,this.limit):[]},singleValue(){return this.internalValue[0]},deselectLabelText(){return this.showLabels?this.deselectLabel:""},deselectGroupLabelText(){return this.showLabels?this.deselectGroupLabel:""},selectLabelText(){return this.showLabels?this.selectLabel:""},selectGroupLabelText(){return this.showLabels?this.selectGroupLabel:""},selectedLabelText(){return this.showLabels?this.selectedLabel:""},inputStyle(){return this.searchable||this.multiple&&this.modelValue&&this.modelValue.length?this.isOpen?{width:"100%"}:{width:"0",position:"absolute",padding:"0"}:""},contentStyle(){return this.options.length?{display:"inline-block"}:{display:"block"}},isAbove(){return this.openDirection==="above"||this.openDirection==="top"?!0:this.openDirection==="below"||this.openDirection==="bottom"?!1:this.preferredOpenDirection==="above"},showSearchInput(){return this.searchable&&(this.hasSingleSelectedSlot&&(this.visibleSingleValue||this.visibleSingleValue===0)?this.isOpen:!0)},isRequired(){return this.required===!1?!1:this.internalValue.length<=0}},watch:{isOpen(e){e&&(this.useTeleport?(this.ready=!1,this.$nextTick(()=>{const s=this.$el.getBoundingClientRect();this.dropdownStyles={position:"absolute",top:`${s.bottom+window.scrollY}px`,left:`${s.left+window.scrollX}px`,width:`${s.width}px`,zIndex:9999},this.ready=!0})):this.ready=!0)}}};const De=["tabindex","aria-expanded","aria-owns","aria-activedescendant"],Pe={ref:"tags",class:"multiselect__tags"},Re={class:"multiselect__tags-wrap"},Ae=["textContent"],xe=["onKeydown","onMousedown"],Me=["textContent"],Fe={class:"multiselect__spinner"},Ie=["name","id","spellcheck","placeholder","required","value","disabled","tabindex","aria-label","aria-controls"],qe=["id","aria-multiselectable"],Ne={key:0},He={class:"multiselect__option"},je=["aria-selected","id","role"],Ue=["onClick","onMouseenter","data-select","data-selected","data-deselect"],Ge=["data-select","data-deselect","onMouseenter","onMousedown"],ze={class:"multiselect__option"},Ke={class:"multiselect__option"};function Ye(e,s,i,f,l,r){return u(),c("div",{tabindex:e.searchable?-1:i.tabindex,class:Y([{"multiselect--active":e.isOpen,"multiselect--disabled":i.disabled,"multiselect--above":r.isAbove,"multiselect--has-options-group":r.hasOptionGroup},"multiselect"]),onFocus:s[14]||(s[14]=a=>e.activate()),onBlur:s[15]||(s[15]=a=>e.searchable?!1:e.deactivate()),onKeydown:[s[16]||(s[16]=I(E(a=>e.pointerForward(),["self","prevent"]),["down"])),s[17]||(s[17]=I(E(a=>e.pointerBackward(),["self","prevent"]),["up"])),s[18]||(s[18]=I(E(a=>e.addPointerElement(a),["stop","self"]),["enter","tab"]))],onKeyup:s[19]||(s[19]=I(a=>e.deactivate(),["esc"])),role:"combobox","aria-expanded":e.isOpen,"aria-owns":"listbox-"+e.id,"aria-activedescendant":e.isOpen&&e.pointer!==null?e.id+"-"+e.pointer:null},[D(e.$slots,"caret",{toggle:e.toggle},()=>[t("div",{onMousedown:s[0]||(s[0]=E(a=>e.toggle(),["prevent","stop"])),class:"multiselect__select"},null,32)]),D(e.$slots,"clear",{search:e.search}),t("div",Pe,[D(e.$slots,"selection",{search:e.search,remove:e.removeElement,values:r.visibleValues,isOpen:e.isOpen},()=>[ee(t("div",Re,[(u(!0),c(H,null,j(r.visibleValues,(a,d)=>D(e.$slots,"tag",{option:a,search:e.search,remove:e.removeElement},()=>[(u(),c("span",{class:"multiselect__tag",key:d,onMousedown:s[1]||(s[1]=E(()=>{},["prevent"]))},[t("span",{textContent:_(e.getOptionLabel(a))},null,8,Ae),t("i",{tabindex:"1",onKeydown:I(E(S=>e.removeElement(a),["prevent"]),["enter"]),onMousedown:E(S=>e.removeElement(a),["prevent"]),class:"multiselect__tag-icon"},null,40,xe)],32))])),256))],512),[[se,r.visibleValues.length>0]]),e.internalValue&&e.internalValue.length>i.limit?D(e.$slots,"limit",{key:0},()=>[t("strong",{class:"multiselect__strong",textContent:_(i.limitText(e.internalValue.length-i.limit))},null,8,Me)]):V("v-if",!0)]),W(he,{name:"multiselect__loading"},{default:ce(()=>[D(e.$slots,"loading",{},()=>[ee(t("div",Fe,null,512),[[se,i.loading]])])]),_:3}),e.searchable?(u(),c("input",{key:0,ref:"search",name:i.name,id:e.id,type:"text",autocomplete:"off",spellcheck:i.spellcheck,placeholder:e.placeholder,required:r.isRequired,style:ie(r.inputStyle),value:e.search,disabled:i.disabled,tabindex:i.tabindex,"aria-label":i.name+"-searchbox",onInput:s[2]||(s[2]=a=>e.updateSearch(a.target.value)),onFocus:s[3]||(s[3]=E(a=>e.activate(),["prevent"])),onBlur:s[4]||(s[4]=E(a=>e.deactivate(),["prevent"])),onKeyup:s[5]||(s[5]=I(a=>e.deactivate(),["esc"])),onKeydown:[s[6]||(s[6]=I(E(a=>e.pointerForward(),["prevent"]),["down"])),s[7]||(s[7]=I(E(a=>e.pointerBackward(),["prevent"]),["up"])),s[8]||(s[8]=I(E(a=>e.addPointerElement(a),["prevent","stop","self"]),["enter"])),s[9]||(s[9]=I(E(a=>e.removeLastElement(),["stop"]),["delete"]))],class:"multiselect__input","aria-controls":"listbox-"+e.id},null,44,Ie)):V("v-if",!0),r.isSingleLabelVisible?(u(),c("span",{key:1,class:"multiselect__single",onMousedown:s[10]||(s[10]=E((...a)=>e.toggle&&e.toggle(...a),["prevent"]))},[D(e.$slots,"singleLabel",{option:r.singleValue},()=>[O(_(e.currentOptionLabel),1)])],32)):V("v-if",!0),r.isPlaceholderVisible?(u(),c("span",{key:2,class:"multiselect__placeholder",onMousedown:s[11]||(s[11]=E((...a)=>e.toggle&&e.toggle(...a),["prevent"]))},[D(e.$slots,"placeholder",{},()=>[O(_(e.placeholder),1)])],32)):V("v-if",!0)],512),(u(),ge(be,{to:"body",disabled:!i.useTeleport},[W(he,{name:"multiselect"},{default:ce(()=>[e.isOpen&&l.ready?(u(),c("div",{key:0,class:Y(["multiselect__content-wrapper",i.contentWrapperClass]),onFocus:s[12]||(s[12]=(...a)=>e.activate&&e.activate(...a)),tabindex:"-1",onMousedown:s[13]||(s[13]=E(()=>{},["prevent"])),style:ie([l.dropdownStyles,{maxHeight:e.optimizedHeight+"px"}]),ref:"list"},[t("ul",{class:"multiselect__content",style:ie(r.contentStyle),role:"listbox",id:"listbox-"+e.id,"aria-multiselectable":e.multiple},[D(e.$slots,"beforeList"),e.multiple&&e.max===e.internalValue.length?(u(),c("li",Ne,[t("span",He,[D(e.$slots,"maxElements",{},()=>[O("Maximum of "+_(e.max)+" options selected. First remove a selected option to select another.",1)])])])):V("v-if",!0),!e.max||e.internalValue.length<e.max?(u(!0),c(H,{key:1},j(e.filteredOptions,(a,d)=>(u(),c("li",{class:"multiselect__element",key:d,"aria-selected":e.isSelected(a),id:e.id+"-"+d,role:a&&(a.$isLabel||a.$isDisabled)?null:"option"},[a&&(a.$isLabel||a.$isDisabled)?V("v-if",!0):(u(),c("span",{key:0,class:Y([e.optionHighlight(d,a),"multiselect__option"]),onClick:E(S=>e.select(a),["stop"]),onMouseenter:E(S=>e.pointerSet(d),["self"]),"data-select":a&&a.isTag?e.tagPlaceholder:r.selectLabelText,"data-selected":r.selectedLabelText,"data-deselect":r.deselectLabelText},[D(e.$slots,"option",{option:a,search:e.search,index:d},()=>[t("span",null,_(e.getOptionLabel(a)),1)])],42,Ue)),a&&(a.$isLabel||a.$isDisabled)?(u(),c("span",{key:1,"data-select":e.groupSelect&&r.selectGroupLabelText,"data-deselect":e.groupSelect&&r.deselectGroupLabelText,class:Y([e.groupHighlight(d,a),"multiselect__option"]),onMouseenter:E(S=>e.groupSelect&&e.pointerSet(d),["self"]),onMousedown:E(S=>e.selectGroup(a),["prevent"])},[D(e.$slots,"option",{option:a,search:e.search,index:d},()=>[t("span",null,_(e.getOptionLabel(a)),1)])],42,Ge)):V("v-if",!0)],8,je))),128)):V("v-if",!0),ee(t("li",null,[t("span",ze,[D(e.$slots,"noResult",{search:e.search},()=>[s[20]||(s[20]=O("No elements found. Consider changing the search query."))])])],512),[[se,i.showNoResults&&e.filteredOptions.length===0&&e.search&&!i.loading]]),ee(t("li",null,[t("span",Ke,[D(e.$slots,"noOptions",{},()=>[s[21]||(s[21]=O("List is empty."))])])],512),[[se,i.showNoOptions&&(e.options.length===0||r.hasOptionGroup===!0&&e.filteredOptions.length===0)&&!e.search&&!i.loading]]),D(e.$slots,"afterList")],12,qe)],38)):V("v-if",!0)]),_:3})],8,["disabled"]))],42,De)}le.render=Ye;const We=["Aldi","Edeka","Lidl","Rewe","Netto"],ue=(e,s)=>{const i=e.__vccOpts||e;for(const[f,l]of s)i[f]=l;return i},Je={class:"row g-3"},Ze={class:"col-md-12"},Xe={class:"col-md-12"},Qe={class:"col-md-12"},et={class:"col-md-12"},tt={class:"mt-2"},st={class:"d-flex flex-wrap gap-1"},it=["onClick"],lt={class:"col-md-12 mt-5"},at={class:"d-flex flex-column gap-2"},rt=["onClick"],ot={class:"d-flex align-items-center gap-1"},nt={key:0,class:"badge"},dt={key:1,class:"ti ti-arrow-up"},ut={key:2,class:"ti ti-arrow-down"},ct={__name:"FilterBar",props:{filters:{type:Object,required:!0},availableBrands:{type:Array,default:()=>[]},availableCategories:{type:Array,default:()=>[]},availableStores:{type:Array,default:()=>[]},sort:{type:Array,default:()=>[]}},emits:["update:filters","update:sort","reset"],setup(e,{emit:s}){const i=e,f=s,{getUniqueBrands:l,getUniqueCategories:r,getUniqueStores:a}=me(),d=C({...i.filters}),S=C([...i.sort]),x=C([...i.availableBrands]),q=C([...i.availableCategories]),B=C([...i.availableStores]),M=C(!1),n=C(!1),p=C(!1),b=[{key:"fat",label:"Fat",icon:"ti ti-droplet"},{key:"carbs",label:"Carbs",icon:"ti ti-grain"},{key:"protein",label:"Protein",icon:"ti ti-barbell"},{key:"protein_fat_index",label:"Protein/Fat Index",icon:"ti ti-chart-line"}],v=We;Q(()=>i.filters,g=>{d.value={...g}},{deep:!0}),Q(()=>i.sort,g=>{S.value=[...g]},{deep:!0}),Q(()=>i.availableBrands,g=>{x.value=[...g]}),Q(()=>i.availableCategories,g=>{q.value=[...g]}),Q(()=>i.availableStores,g=>{B.value=[...g]});function $(){f("update:filters",{...d.value})}function y(g){const o=S.value.findIndex(m=>m.field===g);o===-1?S.value=[...S.value,{field:g,direction:"asc"}]:S.value[o].direction==="asc"?S.value=S.value.map((h,w)=>w===o?{field:g,direction:"desc"}:h):S.value=S.value.filter((h,w)=>w!==o),f("update:sort",[...S.value])}function L(g){const o=S.value.find(m=>m.field===g);return o?o.direction:null}function T(g){const o=S.value.findIndex(m=>m.field===g);return o!==-1?o+1:null}function U(g){return!d.value.stores||d.value.stores.length===0?!1:d.value.stores.some(o=>{const m=typeof o=="object"?o.store:o;return m&&m.toLowerCase().includes(g.toLowerCase())})}function G(g){const o=B.value.filter(h=>h.store&&h.store.toLowerCase().includes(g.toLowerCase()));if(o.length===0)return;if(d.value.stores.some(h=>{const w=typeof h=="object"?h.store:h;return w&&w.toLowerCase().includes(g.toLowerCase())}))d.value.stores=d.value.stores.filter(h=>{const w=typeof h=="object"?h.store:h;return!(w&&w.toLowerCase().includes(g.toLowerCase()))});else{const h=new Set(d.value.stores.map(X=>typeof X=="object"?X.id:X)),w=o.filter(X=>!h.has(X.id));d.value.stores=[...d.value.stores,...w]}$()}let F=null,z=null,R=null;async function J(g){clearTimeout(F),F=setTimeout(async()=>{M.value=!0;try{x.value=await l(g)}catch(o){console.error("Error searching brands:",o)}finally{M.value=!1}},300)}async function te(g){clearTimeout(z),z=setTimeout(async()=>{n.value=!0;try{q.value=await r(g)}catch(o){console.error("Error searching categories:",o)}finally{n.value=!1}},300)}async function K(g){clearTimeout(R),R=setTimeout(async()=>{p.value=!0;try{B.value=await a(g)}catch(o){console.error("Error searching stores:",o)}finally{p.value=!1}},300)}return(g,o)=>(u(),c("div",Je,[t("div",Ze,[o[4]||(o[4]=t("label",{class:"form-label"},[t("i",{class:"ti ti-search me-1"}),O(" Search ")],-1)),ee(t("input",{"onUpdate:modelValue":o[0]||(o[0]=m=>d.value.search=m),type:"text",class:"form-control",placeholder:"Search by name...",onInput:$},null,544),[[ve,d.value.search]])]),t("div",Xe,[o[5]||(o[5]=t("label",{class:"form-label"},[t("i",{class:"ti ti-tag me-1"}),O(" Brands ")],-1)),W(P(le),{modelValue:d.value.brands,"onUpdate:modelValue":[o[1]||(o[1]=m=>d.value.brands=m),$],options:x.value,multiple:!0,searchable:!0,loading:M.value,"close-on-select":!1,"clear-on-select":!1,"internal-search":!1,label:"brand","track-by":"id",placeholder:"Select brands...",onSearchChange:J},null,8,["modelValue","options","loading"])]),t("div",Qe,[o[6]||(o[6]=t("label",{class:"form-label"},[t("i",{class:"ti ti-category me-1"}),O(" Categories ")],-1)),W(P(le),{modelValue:d.value.categories,"onUpdate:modelValue":[o[2]||(o[2]=m=>d.value.categories=m),$],options:q.value,multiple:!0,searchable:!0,loading:n.value,"close-on-select":!1,"clear-on-select":!1,"internal-search":!1,label:"category","track-by":"id",placeholder:"Select categories...",onSearchChange:te},null,8,["modelValue","options","loading"])]),t("div",et,[o[8]||(o[8]=t("label",{class:"form-label"},[t("i",{class:"ti ti-building-store me-1"}),O(" Stores ")],-1)),W(P(le),{modelValue:d.value.stores,"onUpdate:modelValue":[o[3]||(o[3]=m=>d.value.stores=m),$],options:B.value,multiple:!0,searchable:!0,loading:p.value,"close-on-select":!1,"clear-on-select":!1,"internal-search":!1,label:"store","track-by":"id",placeholder:"Select stores...",onSearchChange:K},null,8,["modelValue","options","loading"]),t("div",tt,[o[7]||(o[7]=t("small",{class:"text-muted d-block mb-1"},"Quick Select",-1)),t("div",st,[(u(!0),c(H,null,j(P(v),m=>(u(),c("button",{key:m,class:Y(["btn btn-sm",U(m)?"btn-primary":"btn-outline-secondary"]),onClick:h=>G(m)},_(m),11,it))),128))])])]),t("div",lt,[o[9]||(o[9]=t("label",{class:"form-label"},[t("i",{class:"ti ti-sort-ascending me-1"}),O(" Sort By (order matters) ")],-1)),t("div",at,[(u(),c(H,null,j(b,m=>t("button",{key:m.key,class:Y(["btn btn-outline w-100 d-flex justify-content-between align-items-center",{active:L(m.key)!==null}]),onClick:h=>y(m.key)},[t("span",null,[t("i",{class:Y([m.icon,"me-1"])},null,2),O(" "+_(m.label),1)]),t("span",ot,[T(m.key)!==null?(u(),c("span",nt,_(T(m.key)),1)):V("",!0),L(m.key)==="asc"?(u(),c("i",dt)):L(m.key)==="desc"?(u(),c("i",ut)):V("",!0)])],10,rt)),64))])])]))}},ht=ue(ct,[["__scopeId","data-v-1cada2fc"]]),pt={class:"loading-overlay"},ft={__name:"LoadingState",props:{message:{type:String,default:"Loading..."}},setup(e){return(s,i)=>(u(),c("div",pt,[i[0]||(i[0]=t("div",{class:"spinner"},null,-1)),t("p",null,_(e.message),1)]))}},gt=ue(ft,[["__scopeId","data-v-f716d3f9"]]),mt={class:"product-cards-list"},bt={key:0,class:"empty"},vt={key:1,class:"row row-cards"},yt={class:"card"},wt={class:"card-img-top img-responsive img-responsive-21x9 card-img-top-custom"},St=["src","alt"],$t={class:"card-body"},_t={class:"d-flex align-items-center mb-3"},Ot={class:"flex-fill"},Lt=["href"],Et={class:"card-title mb-1"},kt={class:"row g-2 mb-3"},Ct={class:"col-6"},Vt={class:"d-flex flex-column"},Bt={key:0,class:"text-body values"},Tt={key:1,class:"text-muted"},Dt={class:"col-6"},Pt={class:"d-flex flex-column"},Rt={key:0,class:"text-body values"},At={key:1,class:"text-muted"},xt={class:"col-4"},Mt={class:"d-flex flex-column"},Ft={key:0,class:"text-body values"},It={key:1,class:"text-muted"},qt={class:"col-4"},Nt={class:"d-flex flex-column"},Ht={key:0,class:"text-body values"},jt={key:1,class:"text-muted"},Ut={class:"col-4"},Gt={class:"d-flex flex-column"},zt={key:0,class:"text-body values"},Kt={key:1,class:"text-muted"},Yt={class:"mb-0"},Wt={key:0,class:"mb-2"},Jt={class:"d-flex flex-wrap gap-1"},Zt={key:1,class:"mb-2"},Xt={class:"d-flex flex-wrap gap-1"},Qt={key:2},es={class:"d-flex flex-wrap gap-1"},ts={key:0,class:"card-footer"},ss=["href"],is={__name:"ProductCardsList",props:{products:{type:Array,default:()=>[]}},setup(e){function s(f){f.target.style.display="none";const l=f.target.nextElementSibling;l&&(l.style.display="flex")}function i(f){if(!f)return[];if(Array.isArray(f))return f.map(l=>String(l).trim()).filter(Boolean).slice(0,3);if(typeof f=="string"){try{const l=JSON.parse(f);if(Array.isArray(l))return l.map(r=>String(r).trim()).filter(Boolean).slice(0,3)}catch{}return f.split(",").map(l=>l.trim()).filter(Boolean).slice(0,3)}return[]}return(f,l)=>(u(),c("div",mt,[e.products.length===0?(u(),c("div",bt,[...l[0]||(l[0]=[t("div",{class:"empty-icon"},[t("i",{class:"ti ti-package-off",style:{"font-size":"4rem"}})],-1),t("p",{class:"empty-title"},"No products found",-1),t("p",{class:"empty-subtitle text-muted"},"Try adjusting your filters",-1)])])):(u(),c("div",vt,[(u(!0),c(H,null,j(e.products,r=>(u(),c("div",{key:r.id,class:"col-12 col-md-6 col-lg-4"},[t("div",yt,[t("div",wt,[r.image_url?(u(),c("img",{key:0,loading:"lazy",src:r.image_url,alt:r.name,crossorigin:"anonymous",class:"product-image",onError:s},null,40,St)):V("",!0),t("div",{class:"placeholder-icon",style:ie({display:r.image_url?"none":"flex"})},[...l[1]||(l[1]=[t("i",{class:"ti ti-photo-off"},null,-1)])],4)]),t("div",$t,[t("div",_t,[t("div",Ot,[t("a",{href:r.url||"#",target:"_blank",rel:"noopener noreferrer",class:"text-reset text-decoration-none"},[t("h3",Et,_(r.name||"Unknown Product"),1)],8,Lt)])]),t("div",kt,[t("div",Ct,[t("div",Vt,[l[2]||(l[2]=t("small",{class:"text-muted mb-1"},[t("i",{class:"ti ti-flame me-1"}),O("Energy ")],-1)),r.energy?(u(),c("strong",Bt,_(Math.round(r.energy))+" kcal ",1)):(u(),c("span",Tt,"-"))])]),t("div",Dt,[t("div",Pt,[l[3]||(l[3]=t("small",{class:"text-muted mb-1"},[t("i",{class:"ti ti-chart-line me-1"}),O("P/F Index ")],-1)),r.protein_fat_index?(u(),c("strong",Rt,_(Number(r.protein_fat_index).toFixed(2)),1)):(u(),c("span",At,"-"))])]),t("div",xt,[t("div",Mt,[l[4]||(l[4]=t("small",{class:"text-muted mb-1"},"Fat",-1)),r.fat?(u(),c("strong",Ft,_(r.fat)+" g",1)):(u(),c("span",It,"-"))])]),t("div",qt,[t("div",Nt,[l[5]||(l[5]=t("small",{class:"text-muted mb-1"},"Carbs",-1)),r.carbs?(u(),c("strong",Ht,_(r.carbs)+" g",1)):(u(),c("span",jt,"-"))])]),t("div",Ut,[t("div",Gt,[l[6]||(l[6]=t("small",{class:"text-muted mb-1"},"Protein",-1)),r.protein?(u(),c("strong",zt,_(r.protein)+" g",1)):(u(),c("span",Kt,"-"))])])]),t("div",Yt,[r.brands?(u(),c("div",Wt,[l[7]||(l[7]=t("small",{class:"text-muted d-block mb-1"},[t("i",{class:"ti ti-tag me-1"}),O("Brands ")],-1)),t("div",Jt,[(u(!0),c(H,null,j(i(r.brands),(a,d)=>(u(),c("span",{key:d,class:"badge bg-blue-lt"},_(a),1))),128))])])):V("",!0),r.categories?(u(),c("div",Zt,[l[8]||(l[8]=t("small",{class:"text-muted d-block mb-1"},[t("i",{class:"ti ti-category me-1"}),O("Categories ")],-1)),t("div",Xt,[(u(!0),c(H,null,j(i(r.categories),(a,d)=>(u(),c("span",{key:d,class:"badge bg-green-lt"},_(a),1))),128))])])):V("",!0),r.stores?(u(),c("div",Qt,[l[9]||(l[9]=t("small",{class:"text-muted d-block mb-1"},[t("i",{class:"ti ti-building-store me-1"}),O("Stores ")],-1)),t("div",es,[(u(!0),c(H,null,j(i(r.stores),(a,d)=>(u(),c("span",{key:d,class:"badge bg-orange-lt"},_(a),1))),128))])])):V("",!0)])]),r.url?(u(),c("div",ts,[t("a",{href:r.url,target:"_blank",rel:"noopener noreferrer",class:"btn btn-outline-primary w-100"},[...l[10]||(l[10]=[t("i",{class:"ti ti-external-link me-1"},null,-1),O(" View ",-1)])],8,ss)])):V("",!0)])]))),128))]))]))}},ls=ue(is,[["__scopeId","data-v-ebd8716f"]]),as={id:"app"},rs={class:"navbar navbar-expand-md navbar-light d-print-none"},os={class:"container-xl"},ns={class:"navbar-nav flex-row order-md-last"},ds={class:"d-flex align-items-center"},us={class:"col-auto ms-auto d-print-none"},cs={class:"btn-list"},hs=["disabled"],ps={key:0,class:"ti ti-download"},fs={key:1,class:"spinner-border spinner-border-sm me-2"},gs=["disabled"],ms={class:"page-wrapper"},bs={class:"page-body"},vs={class:"container-xl"},ys={class:"row"},ws={class:"col-lg-3 mb-3"},Ss={class:"card sticky-top",style:{top:"1rem"}},$s={class:"card-body"},_s={class:"row row-cards mt-3"},Os={class:"col-12"},Ls={class:"card"},Es={class:"card-body"},ks={class:"h1 mb-0"},Cs={class:"col-12"},Vs={class:"card"},Bs={class:"card-body"},Ts={class:"h1 mb-0"},Ds={class:"col-lg-9"},Ps={class:"card mb-3"},Rs={class:"card-header"},As={class:"card-title"},xs={class:"card-actions"},Ms={class:"d-flex align-items-center gap-2"},Fs=["disabled"],Is={class:"text-muted"},qs=["disabled"],Ns={class:"card-body"},de="food-app-sort",Hs=21,js={__name:"App",setup(e){const{loading:s,loadingMessage:i,dbStats:f,loadData:l,clearDatabase:r,updateStats:a,queryProducts:d,getUniqueBrands:S,getUniqueCategories:x,getUniqueStores:q,hasData:B}=me(),M=C([]),n=C({search:"",brands:[],categories:[],stores:[]});function p(){try{const h=localStorage.getItem(de);return h?JSON.parse(h):[]}catch(h){return console.error("Error loading saved sort:",h),[]}}const b=C(p()),v=C(1),$=C(0),y=C(0),L=C([]),T=C([]),U=C([]);async function G(){L.value=await S(),T.value=await x(),U.value=await q()}async function F(h){h&&(n.value={...h}),v.value=1,await R()}async function z(h){if(h){b.value=[...h];try{localStorage.setItem(de,JSON.stringify(h))}catch(w){console.error("Error saving sort:",w)}}v.value=1,await R()}async function R(){const h=await d(n.value,v.value,Hs,b.value);M.value=h.products,y.value=h.totalCount,$.value=h.totalPages}function J(){n.value={search:"",brands:[],categories:[],stores:[]},b.value=[];try{localStorage.removeItem(de)}catch(h){console.error("Error clearing saved sort:",h)}F()}async function te(){v.value<$.value&&(v.value++,await R())}async function K(){v.value>1&&(v.value--,await R())}async function g(){try{await l(),await G(),await F()}catch(h){alert("Error loading data: "+h.message)}}async function o(){await r()&&(M.value=[],y.value=0,$.value=1,L.value=[],T.value=[])}async function m(){if(await a(),await B())await G(),await R();else try{await l(),await G(),await F()}catch{console.log("No cached database found, waiting for user to load")}}return ye(()=>{m()}),(h,w)=>(u(),c("div",as,[P(s)?(u(),ge(gt,{key:0,message:P(i)},null,8,["message"])):V("",!0),t("header",rs,[t("div",os,[w[1]||(w[1]=t("h1",{class:"navbar-brand navbar-brand-autodark d-none-navbar-horizontal pe-0 pe-md-3"},[t("a",{href:"#"},[t("span",{class:"navbar-brand-image"}),O(" OpenFoodFacts Germany ")])],-1)),t("div",ns,[t("div",ds,[t("div",us,[t("div",cs,[t("button",{class:"btn btn-primary",onClick:g,disabled:P(s)},[P(s)?V("",!0):(u(),c("i",ps)),P(s)?(u(),c("span",fs)):V("",!0),O(" "+_(P(s)?P(i):"Load Database"),1)],8,hs),P(f).count>0?(u(),c("button",{key:0,class:"btn btn-outline-danger",onClick:o,disabled:P(s)},[...w[0]||(w[0]=[t("i",{class:"ti ti-trash"},null,-1),O(" Clear Data ",-1)])],8,gs)):V("",!0)])])])])])]),t("div",ms,[t("div",bs,[t("div",vs,[t("div",ys,[t("div",ws,[t("div",Ss,[t("div",{class:"card-header"},[w[3]||(w[3]=t("h3",{class:"card-title"},[t("i",{class:"ti ti-filter me-2"}),O(" Filters ")],-1)),t("div",{class:"card-actions"},[t("button",{class:"btn btn-outline",onClick:J},[...w[2]||(w[2]=[t("i",{class:"ti ti-refresh"},null,-1),O(" Reset ",-1)])])])]),t("div",$s,[W(ht,{filters:n.value,sort:b.value,"available-brands":L.value,"available-categories":T.value,"available-stores":U.value,"onUpdate:filters":F,"onUpdate:sort":z,onReset:J},null,8,["filters","sort","available-brands","available-categories","available-stores"])])]),t("div",_s,[t("div",Os,[t("div",Ls,[t("div",Es,[w[4]||(w[4]=t("div",{class:"subheader"},"Total Products",-1)),t("div",ks,_(P(f).count.toLocaleString()),1)])])]),t("div",Cs,[t("div",Vs,[t("div",Bs,[w[5]||(w[5]=t("div",{class:"subheader"},"Filtered Results",-1)),t("div",Ts,_(y.value.toLocaleString()),1)])])])])]),t("div",Ds,[t("div",Ps,[t("div",Rs,[t("h3",As," Products ("+_(M.value.length)+" of "+_(y.value.toLocaleString())+") ",1),t("div",xs,[t("div",Ms,[t("button",{class:"btn btn-outline-primary",onClick:K,disabled:v.value===1},[...w[6]||(w[6]=[t("i",{class:"ti ti-chevron-left"},null,-1),O(" Previous ",-1)])],8,Fs),t("span",Is," Page "+_(v.value)+" of "+_($.value),1),t("button",{class:"btn btn-outline-primary",onClick:te,disabled:v.value>=$.value},[...w[7]||(w[7]=[O(" Next ",-1),t("i",{class:"ti ti-chevron-right"},null,-1)])],8,qs)])])]),t("div",Ns,[W(ls,{products:M.value},null,8,["products"])])])])])])]),w[8]||(w[8]=we('<footer class="footer footer-transparent d-print-none"><div class="container-xl"><div class="row text-center align-items-center"><div class="col-12 col-lg-auto mt-3 mt-lg-0"><ul class="list-inline list-inline-dots mb-0"><li class="list-inline-item"> Powered by OpenFoodFacts data </li><li class="list-inline-item"><a href="https://github.com/mkoziy/food" target="_blank" rel="noopener noreferrer" class="link-muted align-items-center"><svg xmlns="http://www.w3.org/2000/svg" class="me-1" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 .5C5.7.5.9 5.3.9 11.6c0 4.7 3 8.7 7.2 10.1.5.1.7-.2.7-.5v-1.9c-2.9.6-3.5-1.4-3.5-1.4-.5-1.2-1.2-1.6-1.2-1.6-1-.7.1-.7.1-.7 1.1.1 1.7 1.1 1.7 1.1 1 .1 1.6.7 1.9 1.2.1-.8.4-1.4.8-1.8-2.3-.3-4.7-1.2-4.7-5.3 0-1.2.4-2.1 1.1-2.8-.1-.3-.5-1.5.1-3.1 0 0 .9-.3 3 .1.9-.3 1.8-.4 2.7-.4s1.8.1 2.7.4c2.1-.4 3-.1 3-.1.6 1.6.2 2.8.1 3.1.7.7 1.1 1.6 1.1 2.8 0 4.1-2.4 5-4.7 5.3.4.3.8 1.1.8 2.2v3.2c0 .3.2.6.7.5 4.2-1.4 7.2-5.4 7.2-10.1C23.1 5.3 18.3.5 12 .5z"></path></svg> Source on GitHub </a></li></ul></div></div></div></footer>',1))])]))}};Se(js).mount("#app");
